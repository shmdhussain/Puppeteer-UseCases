
(function(){function n(n){function t(t,r,e,u,i,o){for(;i>=0&&o>i;i+=n){var a=u?u[i]:i;e=r(e,t[a],a,t)}return e}return function(r,e,u,i){e=b(e,i,4);var o=!k(r)&&m.keys(r),a=(o||r).length,c=n>0?0:a-1;return arguments.length<3&&(u=r[o?o[c]:c],c+=n),t(r,e,u,o,c,a)}}function t(n){return function(t,r,e){r=x(r,e);for(var u=O(t),i=n>0?0:u-1;i>=0&&u>i;i+=n)if(r(t[i],i,t))return i;return-1}}function r(n,t,r){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(r&&i&&a)return i=r(e,u),e[i]===u?i:-1;if(u!==u)return i=t(l.call(e,o,a),m.isNaN),i>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&a>i;i+=n)if(e[i]===u)return i;return-1}}function e(n,t){var r=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(t,i)&&t.push(i);r--;)i=I[r],i in n&&n[i]!==u[i]&&!m.contains(t,i)&&t.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,g=c.bind,y=Object.create,d=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}},x=function(n,t,r){return null==n?m.identity:m.isFunction(n)?b(n,t,r):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,t){return x(n,t,1/0)};var _=function(n,t){return function(r){var e=arguments.length;if(2>e||null==r)return r;for(var u=1;e>u;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;a>c;c++){var f=o[c];t&&r[f]!==void 0||(r[f]=i[f])}return r}},j=function(n){if(!m.isObject(n))return{};if(y)return y(n);d.prototype=n;var t=new d;return d.prototype=null,t},w=function(n){return function(t){return null==t?void 0:t[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var t=O(n);return"number"==typeof t&&t>=0&&A>=t};m.each=m.forEach=function(n,t,r){t=b(t,r);var e,u;if(k(n))for(e=0,u=n.length;u>e;e++)t(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;u>o;o++){var a=e?e[o]:o;i[o]=t(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,t,r){var e;return e=k(n)?m.findIndex(n,t,r):m.findKey(n,t,r),e!==void 0&&e!==-1?n[e]:void 0},m.filter=m.select=function(n,t,r){var e=[];return t=x(t,r),m.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e},m.reject=function(n,t,r){return m.filter(n,m.negate(x(t)),r)},m.every=m.all=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(!t(n[o],o,n))return!1}return!0},m.some=m.any=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(t(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,t,r,e){return k(n)||(n=m.values(n)),("number"!=typeof r||e)&&(r=0),m.indexOf(n,t,r)>=0},m.invoke=function(n,t){var r=l.call(arguments,2),e=m.isFunction(t);return m.map(n,function(n){var u=e?t:n[t];return null==u?u:u.apply(n,r)})},m.pluck=function(n,t){return m.map(n,m.property(t))},m.where=function(n,t){return m.filter(n,m.matcher(t))},m.findWhere=function(n,t){return m.find(n,m.matcher(t))},m.max=function(n,t,r){var e,u,i=-1/0,o=-1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],e>i&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(u>o||u===-1/0&&i===-1/0)&&(i=n,o=u)});return i},m.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],i>e&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(o>u||1/0===u&&1/0===i)&&(i=n,o=u)});return i},m.shuffle=function(n){for(var t,r=k(n)?n:m.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=m.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},m.sample=function(n,t,r){return null==t||r?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,t))},m.sortBy=function(n,t,r){return t=x(t,r),m.pluck(m.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=x(r,e),m.each(t,function(e,i){var o=r(e,i,t);n(u,e,o)}),u}};m.groupBy=F(function(n,t,r){m.has(n,r)?n[r].push(t):n[r]=[t]}),m.indexBy=F(function(n,t,r){n[r]=t}),m.countBy=F(function(n,t,r){m.has(n,r)?n[r]++:n[r]=1}),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,t,r){t=x(t,r);var e=[],u=[];return m.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},m.first=m.head=m.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:m.initial(n,n.length-t)},m.initial=function(n,t,r){return l.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},m.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:m.rest(n,Math.max(0,n.length-t))},m.rest=m.tail=m.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,t,r,e){for(var u=[],i=0,o=e||0,a=O(n);a>o;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){t||(c=S(c,t,r));var f=0,l=c.length;for(u.length+=l;l>f;)u[i++]=c[f++]}else r||(u[i++]=c)}return u};m.flatten=function(n,t){return S(n,t,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,t,r,e){m.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=x(r,e));for(var u=[],i=[],o=0,a=O(n);a>o;o++){var c=n[o],f=r?r(c,o,n):c;t?(o&&i===f||u.push(c),i=f):r?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var t=[],r=arguments.length,e=0,u=O(n);u>e;e++){var i=n[e];if(!m.contains(t,i)){for(var o=1;r>o&&m.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},m.difference=function(n){var t=S(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(t,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var t=n&&m.max(n,O).length||0,r=Array(t),e=0;t>e;e++)r[e]=m.pluck(n,e);return r},m.object=function(n,t){for(var r={},e=0,u=O(n);u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},m.findIndex=t(1),m.findLastIndex=t(-1),m.sortedIndex=function(n,t,r,e){r=x(r,e,1);for(var u=r(t),i=0,o=O(n);o>i;){var a=Math.floor((i+o)/2);r(n[a])<u?i=a+1:o=a}return i},m.indexOf=r(1,m.findIndex,m.sortedIndex),m.lastIndexOf=r(-1,m.findLastIndex),m.range=function(n,t,r){null==t&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var E=function(n,t,r,e,u){if(!(e instanceof t))return n.apply(r,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,t){if(g&&n.bind===g)return g.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),e=function(){return E(n,e,t,this,r.concat(l.call(arguments)))};return e},m.partial=function(n){var t=l.call(arguments,1),r=function(){for(var e=0,u=t.length,i=Array(u),o=0;u>o;o++)i[o]=t[o]===m?arguments[e++]:t[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,r,this,this,i)};return r},m.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=m.bind(n[r],n);return n},m.memoize=function(n,t){var r=function(e){var u=r.cache,i=""+(t?t.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},m.delay=function(n,t){var r=l.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var c=function(){a=r.leading===!1?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||r.leading!==!1||(a=f);var l=t-(f-a);return e=this,u=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||r.trailing===!1||(o=setTimeout(c,l)),i}},m.debounce=function(n,t,r){var e,u,i,o,a,c=function(){var f=m.now()-o;t>f&&f>=0?e=setTimeout(c,t-f):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=r&&!e;return e||(e=setTimeout(c,t)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,t){return m.partial(t,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},m.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},m.before=function(n,t){var r;return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var t=[];for(var r in n)m.has(n,r)&&t.push(r);return M&&e(n,t),t},m.allKeys=function(n){if(!m.isObject(n))return[];var t=[];for(var r in n)t.push(r);return M&&e(n,t),t},m.values=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},m.mapObject=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=u.length,o={},a=0;i>a;a++)e=u[a],o[e]=t(n[e],e,n);return o},m.pairs=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},m.invert=function(n){for(var t={},r=m.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},m.functions=m.methods=function(n){var t=[];for(var r in n)m.isFunction(n[r])&&t.push(r);return t.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=0,o=u.length;o>i;i++)if(e=u[i],t(n[e],e,n))return e},m.pick=function(n,t,r){var e,u,i={},o=n;if(null==o)return i;m.isFunction(t)?(u=m.allKeys(o),e=b(t,r)):(u=S(arguments,!1,!1,1),e=function(n,t,r){return t in r},o=Object(o));for(var a=0,c=u.length;c>a;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,t,r){if(m.isFunction(t))t=m.negate(t);else{var e=m.map(S(arguments,!1,!1,1),String);t=function(n,t){return!m.contains(e,t)}}return m.pick(n,t,r)},m.defaults=_(m.allKeys,!0),m.create=function(n,t){var r=j(n);return t&&m.extendOwn(r,t),r},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,t){return t(n),n},m.isMatch=function(n,t){var r=m.keys(t),e=r.length;if(null==n)return!e;for(var u=Object(n),i=0;e>i;i++){var o=r[i];if(t[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof m&&(n=n._wrapped),t instanceof m&&(t=t._wrapped);var u=s.call(n);if(u!==s.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof t)return!1;var o=n.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}r=r||[],e=e||[];for(var c=r.length;c--;)if(r[c]===n)return e[c]===t;if(r.push(n),e.push(t),i){if(c=n.length,c!==t.length)return!1;for(;c--;)if(!N(n[c],t[c],r,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(t).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(t,f)||!N(n[f],t[f],r,e))return!1}return r.pop(),e.pop(),!0};m.isEqual=function(n,t){return N(n,t)},m.isEmpty=function(n){return null==n?!0:k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(t){return s.call(t)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return n===void 0},m.has=function(n,t){return null!=n&&p.call(n,t)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(t){return n[t]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(t){return m.isMatch(t,n)}},m.times=function(n,t,r){var e=Array(Math.max(0,n));t=b(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},m.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var t=function(t){return n[t]},r="(?:"+m.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,t,r){var e=null==n?void 0:n[t];return e===void 0&&(e=r),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var t=++q+"";return n?n+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,t,r){!t&&r&&(t=r),t=m.defaults({},t,m.templateSettings);var e=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(a){throw a.source=i,a}var c=function(n){return o.call(this,n,m)},f=t.variable||"obj";return c.source="function("+f+"){\n"+i+"}",c},m.chain=function(n){var t=m(n);return t._chain=!0,t};var P=function(n,t){return n._chain?m(t).chain():t};m.mixin=function(n){m.each(m.functions(n),function(t){var r=m[t]=n[t];m.prototype[t]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,r.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=o[n];m.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],P(this,r)}}),m.each(["concat","join","slice"],function(n){var t=o[n];m.prototype[n]=function(){return P(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.ScrollMagic=t()}(this,function(){"use strict";var e=function(){};e.version="2.0.5",window.addEventListener("mousewheel",function(){});var t="data-scrollmagic-pin-spacer";e.Controller=function(r){var o,s,a="ScrollMagic.Controller",l="FORWARD",c="REVERSE",u="PAUSED",f=n.defaults,d=this,h=i.extend({},f,r),g=[],p=!1,v=0,m=u,w=!0,y=0,S=!0,b=function(){for(var e in h)f.hasOwnProperty(e)||delete h[e];if(h.container=i.get.elements(h.container)[0],!h.container)throw a+" init failed.";w=h.container===window||h.container===document.body||!document.body.contains(h.container),w&&(h.container=window),y=z(),h.container.addEventListener("resize",T),h.container.addEventListener("scroll",T),h.refreshInterval=parseInt(h.refreshInterval)||f.refreshInterval,E()},E=function(){h.refreshInterval>0&&(s=window.setTimeout(A,h.refreshInterval))},x=function(){return h.vertical?i.get.scrollTop(h.container):i.get.scrollLeft(h.container)},z=function(){return h.vertical?i.get.height(h.container):i.get.width(h.container)},C=this._setScrollPos=function(e){h.vertical?w?window.scrollTo(i.get.scrollLeft(),e):h.container.scrollTop=e:w?window.scrollTo(e,i.get.scrollTop()):h.container.scrollLeft=e},F=function(){if(S&&p){var e=i.type.Array(p)?p:g.slice(0);p=!1;var t=v;v=d.scrollPos();var n=v-t;0!==n&&(m=n>0?l:c),m===c&&e.reverse(),e.forEach(function(e){e.update(!0)})}},L=function(){o=i.rAF(F)},T=function(e){"resize"==e.type&&(y=z(),m=u),p!==!0&&(p=!0,L())},A=function(){if(!w&&y!=z()){var e;try{e=new Event("resize",{bubbles:!1,cancelable:!1})}catch(t){e=document.createEvent("Event"),e.initEvent("resize",!1,!1)}h.container.dispatchEvent(e)}g.forEach(function(e){e.refresh()}),E()};this._options=h;var O=function(e){if(e.length<=1)return e;var t=e.slice(0);return t.sort(function(e,t){return e.scrollOffset()>t.scrollOffset()?1:-1}),t};return this.addScene=function(t){if(i.type.Array(t))t.forEach(function(e){d.addScene(e)});else if(t instanceof e.Scene)if(t.controller()!==d)t.addTo(d);else if(g.indexOf(t)<0){g.push(t),g=O(g),t.on("shift.controller_sort",function(){g=O(g)});for(var n in h.globalSceneOptions)t[n]&&t[n].call(t,h.globalSceneOptions[n])}return d},this.removeScene=function(e){if(i.type.Array(e))e.forEach(function(e){d.removeScene(e)});else{var t=g.indexOf(e);t>-1&&(e.off("shift.controller_sort"),g.splice(t,1),e.remove())}return d},this.updateScene=function(t,n){return i.type.Array(t)?t.forEach(function(e){d.updateScene(e,n)}):n?t.update(!0):p!==!0&&t instanceof e.Scene&&(p=p||[],-1==p.indexOf(t)&&p.push(t),p=O(p),L()),d},this.update=function(e){return T({type:"resize"}),e&&F(),d},this.scrollTo=function(n,r){if(i.type.Number(n))C.call(h.container,n,r);else if(n instanceof e.Scene)n.controller()===d&&d.scrollTo(n.scrollOffset(),r);else if(i.type.Function(n))C=n;else{var o=i.get.elements(n)[0];if(o){for(;o.parentNode.hasAttribute(t);)o=o.parentNode;var s=h.vertical?"top":"left",a=i.get.offset(h.container),l=i.get.offset(o);w||(a[s]-=d.scrollPos()),d.scrollTo(l[s]-a[s],r)}}return d},this.scrollPos=function(e){return arguments.length?(i.type.Function(e)&&(x=e),d):x.call(d)},this.info=function(e){var t={size:y,vertical:h.vertical,scrollPos:v,scrollDirection:m,container:h.container,isDocument:w};return arguments.length?void 0!==t[e]?t[e]:void 0:t},this.loglevel=function(){return d},this.enabled=function(e){return arguments.length?(S!=e&&(S=!!e,d.updateScene(g,!0)),d):S},this.destroy=function(e){window.clearTimeout(s);for(var t=g.length;t--;)g[t].destroy(e);return h.container.removeEventListener("resize",T),h.container.removeEventListener("scroll",T),i.cAF(o),null},b(),d};var n={defaults:{container:window,vertical:!0,globalSceneOptions:{},loglevel:2,refreshInterval:100}};e.Controller.addOption=function(e,t){n.defaults[e]=t},e.Controller.extend=function(t){var n=this;e.Controller=function(){return n.apply(this,arguments),this.$super=i.extend({},this),t.apply(this,arguments)||this},i.extend(e.Controller,n),e.Controller.prototype=n.prototype,e.Controller.prototype.constructor=e.Controller},e.Scene=function(n){var o,s,a="BEFORE",l="DURING",c="AFTER",u=r.defaults,f=this,d=i.extend({},u,n),h=a,g=0,p={start:0,end:0},v=0,m=!0,w=function(){for(var e in d)u.hasOwnProperty(e)||delete d[e];for(var t in u)L(t);C()},y={};this.on=function(e,t){return i.type.Function(t)&&(e=e.trim().split(" "),e.forEach(function(e){var n=e.split("."),r=n[0],i=n[1];"*"!=r&&(y[r]||(y[r]=[]),y[r].push({namespace:i||"",callback:t}))})),f},this.off=function(e,t){return e?(e=e.trim().split(" "),e.forEach(function(e){var n=e.split("."),r=n[0],i=n[1]||"",o="*"===r?Object.keys(y):[r];o.forEach(function(e){for(var n=y[e]||[],r=n.length;r--;){var o=n[r];!o||i!==o.namespace&&"*"!==i||t&&t!=o.callback||n.splice(r,1)}n.length||delete y[e]})}),f):f},this.trigger=function(t,n){if(t){var r=t.trim().split("."),i=r[0],o=r[1],s=y[i];s&&s.forEach(function(t){o&&o!==t.namespace||t.callback.call(f,new e.Event(i,t.namespace,f,n))})}return f},f.on("change.internal",function(e){"loglevel"!==e.what&&"tweenChanges"!==e.what&&("triggerElement"===e.what?E():"reverse"===e.what&&f.update())}).on("shift.internal",function(){S(),f.update()}),this.addTo=function(t){return t instanceof e.Controller&&s!=t&&(s&&s.removeScene(f),s=t,C(),b(!0),E(!0),S(),s.info("container").addEventListener("resize",x),t.addScene(f),f.trigger("add",{controller:s}),f.update()),f},this.enabled=function(e){return arguments.length?(m!=e&&(m=!!e,f.update(!0)),f):m},this.remove=function(){if(s){s.info("container").removeEventListener("resize",x);var e=s;s=void 0,e.removeScene(f),f.trigger("remove")}return f},this.destroy=function(e){return f.trigger("destroy",{reset:e}),f.remove(),f.off("*.*"),null},this.update=function(e){if(s)if(e)if(s.enabled()&&m){var t,n=s.info("scrollPos");t=d.duration>0?(n-p.start)/(p.end-p.start):n>=p.start?1:0,f.trigger("update",{startPos:p.start,endPos:p.end,scrollPos:n}),f.progress(t)}else T&&h===l&&O(!0);else s.updateScene(f,!1);return f},this.refresh=function(){return b(),E(),f},this.progress=function(e){if(arguments.length){var t=!1,n=h,r=s?s.info("scrollDirection"):"PAUSED",i=d.reverse||e>=g;if(0===d.duration?(t=g!=e,g=1>e&&i?0:1,h=0===g?a:l):0>e&&h!==a&&i?(g=0,h=a,t=!0):e>=0&&1>e&&i?(g=e,h=l,t=!0):e>=1&&h!==c?(g=1,h=c,t=!0):h!==l||i||O(),t){var o={progress:g,state:h,scrollDirection:r},u=h!=n,p=function(e){f.trigger(e,o)};u&&n!==l&&(p("enter"),p(n===a?"start":"end")),p("progress"),u&&h!==l&&(p(h===a?"start":"end"),p("leave"))}return f}return g};var S=function(){p={start:v+d.offset},s&&d.triggerElement&&(p.start-=s.info("size")*d.triggerHook),p.end=p.start+d.duration},b=function(e){if(o){var t="duration";F(t,o.call(f))&&!e&&(f.trigger("change",{what:t,newval:d[t]}),f.trigger("shift",{reason:t}))}},E=function(e){var n=0,r=d.triggerElement;if(s&&r){for(var o=s.info(),a=i.get.offset(o.container),l=o.vertical?"top":"left";r.parentNode.hasAttribute(t);)r=r.parentNode;var c=i.get.offset(r);o.isDocument||(a[l]-=s.scrollPos()),n=c[l]-a[l]}var u=n!=v;v=n,u&&!e&&f.trigger("shift",{reason:"triggerElementPosition"})},x=function(){d.triggerHook>0&&f.trigger("shift",{reason:"containerResize"})},z=i.extend(r.validate,{duration:function(e){if(i.type.String(e)&&e.match(/^(\.|\d)*\d+%$/)){var t=parseFloat(e)/100;e=function(){return s?s.info("size")*t:0}}if(i.type.Function(e)){o=e;try{e=parseFloat(o())}catch(n){e=-1}}if(e=parseFloat(e),!i.type.Number(e)||0>e)throw o?(o=void 0,0):0;return e}}),C=function(e){e=arguments.length?[e]:Object.keys(z),e.forEach(function(e){var t;if(z[e])try{t=z[e](d[e])}catch(n){t=u[e]}finally{d[e]=t}})},F=function(e,t){var n=!1,r=d[e];return d[e]!=t&&(d[e]=t,C(e),n=r!=d[e]),n},L=function(e){f[e]||(f[e]=function(t){return arguments.length?("duration"===e&&(o=void 0),F(e,t)&&(f.trigger("change",{what:e,newval:d[e]}),r.shifts.indexOf(e)>-1&&f.trigger("shift",{reason:e})),f):d[e]})};this.controller=function(){return s},this.state=function(){return h},this.scrollOffset=function(){return p.start},this.triggerPosition=function(){var e=d.offset;return s&&(e+=d.triggerElement?v:s.info("size")*f.triggerHook()),e};var T,A;f.on("shift.internal",function(e){var t="duration"===e.reason;(h===c&&t||h===l&&0===d.duration)&&O(),t&&_()}).on("progress.internal",function(){O()}).on("add.internal",function(){_()}).on("destroy.internal",function(e){f.removePin(e.reset)});var O=function(e){if(T&&s){var t=s.info(),n=A.spacer.firstChild;if(e||h!==l){var r={position:A.inFlow?"relative":"absolute",top:0,left:0},o=i.css(n,"position")!=r.position;A.pushFollowers?d.duration>0&&(h===c&&0===parseFloat(i.css(A.spacer,"padding-top"))?o=!0:h===a&&0===parseFloat(i.css(A.spacer,"padding-bottom"))&&(o=!0)):r[t.vertical?"top":"left"]=d.duration*g,i.css(n,r),o&&_()}else{"fixed"!=i.css(n,"position")&&(i.css(n,{position:"fixed"}),_());var u=i.get.offset(A.spacer,!0),f=d.reverse||0===d.duration?t.scrollPos-p.start:Math.round(g*d.duration*10)/10;u[t.vertical?"top":"left"]+=f,i.css(A.spacer.firstChild,{top:u.top,left:u.left})}}},_=function(){if(T&&s&&A.inFlow){var e=h===l,t=s.info("vertical"),n=A.spacer.firstChild,r=i.isMarginCollapseType(i.css(A.spacer,"display")),o={};A.relSize.width||A.relSize.autoFullWidth?e?i.css(T,{width:i.get.width(A.spacer)}):i.css(T,{width:"100%"}):(o["min-width"]=i.get.width(t?T:n,!0,!0),o.width=e?o["min-width"]:"auto"),A.relSize.height?e?i.css(T,{height:i.get.height(A.spacer)-(A.pushFollowers?d.duration:0)}):i.css(T,{height:"100%"}):(o["min-height"]=i.get.height(t?n:T,!0,!r),o.height=e?o["min-height"]:"auto"),A.pushFollowers&&(o["padding"+(t?"Top":"Left")]=d.duration*g,o["padding"+(t?"Bottom":"Right")]=d.duration*(1-g)),i.css(A.spacer,o)}},N=function(){s&&T&&h===l&&!s.info("isDocument")&&O()},P=function(){s&&T&&h===l&&((A.relSize.width||A.relSize.autoFullWidth)&&i.get.width(window)!=i.get.width(A.spacer.parentNode)||A.relSize.height&&i.get.height(window)!=i.get.height(A.spacer.parentNode))&&_()},D=function(e){s&&T&&h===l&&!s.info("isDocument")&&(e.preventDefault(),s._setScrollPos(s.info("scrollPos")-((e.wheelDelta||e[s.info("vertical")?"wheelDeltaY":"wheelDeltaX"])/3||30*-e.detail)))};this.setPin=function(e,n){var r={pushFollowers:!0,spacerClass:"scrollmagic-pin-spacer"};if(n=i.extend({},r,n),e=i.get.elements(e)[0],!e)return f;if("fixed"===i.css(e,"position"))return f;if(T){if(T===e)return f;f.removePin()}T=e;var o=T.parentNode.style.display,s=["top","left","bottom","right","margin","marginLeft","marginRight","marginTop","marginBottom"];T.parentNode.style.display="none";var a="absolute"!=i.css(T,"position"),l=i.css(T,s.concat(["display"])),c=i.css(T,["width","height"]);T.parentNode.style.display=o,!a&&n.pushFollowers&&(n.pushFollowers=!1);var u=T.parentNode.insertBefore(document.createElement("div"),T),d=i.extend(l,{position:a?"relative":"absolute",boxSizing:"content-box",mozBoxSizing:"content-box",webkitBoxSizing:"content-box"});if(a||i.extend(d,i.css(T,["width","height"])),i.css(u,d),u.setAttribute(t,""),i.addClass(u,n.spacerClass),A={spacer:u,relSize:{width:"%"===c.width.slice(-1),height:"%"===c.height.slice(-1),autoFullWidth:"auto"===c.width&&a&&i.isMarginCollapseType(l.display)},pushFollowers:n.pushFollowers,inFlow:a},!T.___origStyle){T.___origStyle={};var h=T.style,g=s.concat(["width","height","position","boxSizing","mozBoxSizing","webkitBoxSizing"]);g.forEach(function(e){T.___origStyle[e]=h[e]||""})}return A.relSize.width&&i.css(u,{width:c.width}),A.relSize.height&&i.css(u,{height:c.height}),u.appendChild(T),i.css(T,{position:a?"relative":"absolute",margin:"auto",top:"auto",left:"auto",bottom:"auto",right:"auto"}),(A.relSize.width||A.relSize.autoFullWidth)&&i.css(T,{boxSizing:"border-box",mozBoxSizing:"border-box",webkitBoxSizing:"border-box"}),window.addEventListener("scroll",N),window.addEventListener("resize",N),window.addEventListener("resize",P),T.addEventListener("mousewheel",D),T.addEventListener("DOMMouseScroll",D),O(),f},this.removePin=function(e){if(T){if(h===l&&O(!0),e||!s){var n=A.spacer.firstChild;if(n.hasAttribute(t)){var r=A.spacer.style,o=["margin","marginLeft","marginRight","marginTop","marginBottom"];margins={},o.forEach(function(e){margins[e]=r[e]||""}),i.css(n,margins)}A.spacer.parentNode.insertBefore(n,A.spacer),A.spacer.parentNode.removeChild(A.spacer),T.parentNode.hasAttribute(t)||(i.css(T,T.___origStyle),delete T.___origStyle)}window.removeEventListener("scroll",N),window.removeEventListener("resize",N),window.removeEventListener("resize",P),T.removeEventListener("mousewheel",D),T.removeEventListener("DOMMouseScroll",D),T=void 0}return f};var R,k=[];return f.on("destroy.internal",function(e){f.removeClassToggle(e.reset)}),this.setClassToggle=function(e,t){var n=i.get.elements(e);return 0!==n.length&&i.type.String(t)?(k.length>0&&f.removeClassToggle(),R=t,k=n,f.on("enter.internal_class leave.internal_class",function(e){var t="enter"===e.type?i.addClass:i.removeClass;k.forEach(function(e){t(e,R)})}),f):f},this.removeClassToggle=function(e){return e&&k.forEach(function(e){i.removeClass(e,R)}),f.off("start.internal_class end.internal_class"),R=void 0,k=[],f},w(),f};var r={defaults:{duration:0,offset:0,triggerElement:void 0,triggerHook:.5,reverse:!0,loglevel:2},validate:{offset:function(e){if(e=parseFloat(e),!i.type.Number(e))throw 0;return e},triggerElement:function(e){if(e=e||void 0){var t=i.get.elements(e)[0];if(!t)throw 0;e=t}return e},triggerHook:function(e){var t={onCenter:.5,onEnter:1,onLeave:0};if(i.type.Number(e))e=Math.max(0,Math.min(parseFloat(e),1));else{if(!(e in t))throw 0;e=t[e]}return e},reverse:function(e){return!!e}},shifts:["duration","offset","triggerHook"]};e.Scene.addOption=function(e,t,n,i){e in r.defaults||(r.defaults[e]=t,r.validate[e]=n,i&&r.shifts.push(e))},e.Scene.extend=function(t){var n=this;e.Scene=function(){return n.apply(this,arguments),this.$super=i.extend({},this),t.apply(this,arguments)||this},i.extend(e.Scene,n),e.Scene.prototype=n.prototype,e.Scene.prototype.constructor=e.Scene},e.Event=function(e,t,n,r){r=r||{};for(var i in r)this[i]=r[i];return this.type=e,this.target=this.currentTarget=n,this.namespace=t||"",this.timeStamp=this.timestamp=Date.now(),this};var i=e._util=function(e){var t,n={},r=function(e){return parseFloat(e)||0},i=function(t){return t.currentStyle?t.currentStyle:e.getComputedStyle(t)},o=function(t,n,o,s){if(n=n===document?e:n,n===e)s=!1;else if(!f.DomElement(n))return 0;t=t.charAt(0).toUpperCase()+t.substr(1).toLowerCase();var a=(o?n["offset"+t]||n["outer"+t]:n["client"+t]||n["inner"+t])||0;if(o&&s){var l=i(n);a+="Height"===t?r(l.marginTop)+r(l.marginBottom):r(l.marginLeft)+r(l.marginRight)}return a},s=function(e){return e.replace(/^[^a-z]+([a-z])/g,"$1").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})};n.extend=function(e){for(e=e||{},t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e},n.isMarginCollapseType=function(e){return["block","flex","list-item","table","-webkit-box"].indexOf(e)>-1};var a=0,l=["ms","moz","webkit","o"],c=e.requestAnimationFrame,u=e.cancelAnimationFrame;for(t=0;!c&&t<l.length;++t)c=e[l[t]+"RequestAnimationFrame"],u=e[l[t]+"CancelAnimationFrame"]||e[l[t]+"CancelRequestAnimationFrame"];c||(c=function(t){var n=(new Date).getTime(),r=Math.max(0,16-(n-a)),i=e.setTimeout(function(){t(n+r)},r);return a=n+r,i}),u||(u=function(t){e.clearTimeout(t)}),n.rAF=c.bind(e),n.cAF=u.bind(e);var f=n.type=function(e){return Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase()};f.String=function(e){return"string"===f(e)},f.Function=function(e){return"function"===f(e)},f.Array=function(e){return Array.isArray(e)},f.Number=function(e){return!f.Array(e)&&e-parseFloat(e)+1>=0},f.DomElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName};var d=n.get={};return d.elements=function(t){var n=[];if(f.String(t))try{t=document.querySelectorAll(t)}catch(r){return n}if("nodelist"===f(t)||f.Array(t))for(var i=0,o=n.length=t.length;o>i;i++){var s=t[i];n[i]=f.DomElement(s)?s:d.elements(s)}else(f.DomElement(t)||t===document||t===e)&&(n=[t]);return n},d.scrollTop=function(t){return t&&"number"==typeof t.scrollTop?t.scrollTop:e.pageYOffset||0},d.scrollLeft=function(t){return t&&"number"==typeof t.scrollLeft?t.scrollLeft:e.pageXOffset||0},d.width=function(e,t,n){return o("width",e,t,n)},d.height=function(e,t,n){return o("height",e,t,n)},d.offset=function(e,t){var n={top:0,left:0};if(e&&e.getBoundingClientRect){var r=e.getBoundingClientRect();n.top=r.top,n.left=r.left,t||(n.top+=d.scrollTop(),n.left+=d.scrollLeft())}return n},n.addClass=function(e,t){t&&(e.classList?e.classList.add(t):e.className+=" "+t)},n.removeClass=function(e,t){t&&(e.classList?e.classList.remove(t):e.className=e.className.replace(RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," "))},n.css=function(e,t){if(f.String(t))return i(e)[s(t)];if(f.Array(t)){var n={},r=i(e);return t.forEach(function(e){n[e]=r[s(e)]}),n}for(var o in t){var a=t[o];a==parseFloat(a)&&(a+="px"),e.style[s(o)]=a}},n}(window||{});return e});!function(e,r){"function"==typeof define&&define.amd?define(["ScrollMagic"],r):r("object"==typeof exports?require("scrollmagic"):e.ScrollMagic||e.jQuery&&e.jQuery.ScrollMagic)}(this,function(e){"use strict";var r="0.85em",t="9999",i=15,o=e._util,n=0;e.Scene.extend(function(){var e,r=this;r.addIndicators=function(t){if(!e){var i={name:"",indent:0,parent:void 0,colorStart:"green",colorEnd:"red",colorTrigger:"blue"};t=o.extend({},i,t),n++,e=new s(r,t),r.on("add.plugin_addIndicators",e.add),r.on("remove.plugin_addIndicators",e.remove),r.on("destroy.plugin_addIndicators",r.removeIndicators),r.controller()&&e.add()}return r},r.removeIndicators=function(){return e&&(e.remove(),this.off("*.plugin_addIndicators"),e=void 0),r}}),e.Controller.addOption("addIndicators",!1),e.Controller.extend(function(){var r=this,t=r.info(),n=t.container,s=t.isDocument,d=t.vertical,a={groups:[]};this._indicators=a;var g=function(){a.updateBoundsPositions()},p=function(){a.updateTriggerGroupPositions()};return n.addEventListener("resize",p),s||(window.addEventListener("resize",p),window.addEventListener("scroll",p)),n.addEventListener("resize",g),n.addEventListener("scroll",g),this._indicators.updateBoundsPositions=function(e){for(var r,t,s,g=e?[o.extend({},e.triggerGroup,{members:[e]})]:a.groups,p=g.length,u={},c=d?"left":"top",l=d?"width":"height",f=d?o.get.scrollLeft(n)+o.get.width(n)-i:o.get.scrollTop(n)+o.get.height(n)-i;p--;)for(s=g[p],r=s.members.length,t=o.get[l](s.element.firstChild);r--;)u[c]=f-t,o.css(s.members[r].bounds,u)},this._indicators.updateTriggerGroupPositions=function(e){for(var t,g,p,u,c,l=e?[e]:a.groups,f=l.length,m=s?document.body:n,h=s?{top:0,left:0}:o.get.offset(m,!0),v=d?o.get.width(n)-i:o.get.height(n)-i,b=d?"width":"height",G=d?"Y":"X";f--;)t=l[f],g=t.element,p=t.triggerHook*r.info("size"),u=o.get[b](g.firstChild.firstChild),c=p>u?"translate"+G+"(-100%)":"",o.css(g,{top:h.top+(d?p:v-t.members[0].options.indent),left:h.left+(d?v-t.members[0].options.indent:p)}),o.css(g.firstChild.firstChild,{"-ms-transform":c,"-webkit-transform":c,transform:c})},this._indicators.updateTriggerGroupLabel=function(e){var r="trigger"+(e.members.length>1?"":" "+e.members[0].options.name),t=e.element.firstChild.firstChild,i=t.textContent!==r;i&&(t.textContent=r,d&&a.updateBoundsPositions())},this.addScene=function(t){this._options.addIndicators&&t instanceof e.Scene&&t.controller()===r&&t.addIndicators(),this.$super.addScene.apply(this,arguments)},this.destroy=function(){n.removeEventListener("resize",p),s||(window.removeEventListener("resize",p),window.removeEventListener("scroll",p)),n.removeEventListener("resize",g),n.removeEventListener("scroll",g),this.$super.destroy.apply(this,arguments)},r});var s=function(e,r){var t,i,s=this,a=d.bounds(),g=d.start(r.colorStart),p=d.end(r.colorEnd),u=r.parent&&o.get.elements(r.parent)[0];r.name=r.name||n,g.firstChild.textContent+=" "+r.name,p.textContent+=" "+r.name,a.appendChild(g),a.appendChild(p),s.options=r,s.bounds=a,s.triggerGroup=void 0,this.add=function(){i=e.controller(),t=i.info("vertical");var r=i.info("isDocument");u||(u=r?document.body:i.info("container")),r||"static"!==o.css(u,"position")||o.css(u,{position:"relative"}),e.on("change.plugin_addIndicators",l),e.on("shift.plugin_addIndicators",c),G(),h(),setTimeout(function(){i._indicators.updateBoundsPositions(s)},0)},this.remove=function(){if(s.triggerGroup){if(e.off("change.plugin_addIndicators",l),e.off("shift.plugin_addIndicators",c),s.triggerGroup.members.length>1){var r=s.triggerGroup;r.members.splice(r.members.indexOf(s),1),i._indicators.updateTriggerGroupLabel(r),i._indicators.updateTriggerGroupPositions(r),s.triggerGroup=void 0}else b();m()}};var c=function(){h()},l=function(e){"triggerHook"===e.what&&G()},f=function(){var e=i.info("vertical");o.css(g.firstChild,{"border-bottom-width":e?1:0,"border-right-width":e?0:1,bottom:e?-1:r.indent,right:e?r.indent:-1,padding:e?"0 8px":"2px 4px"}),o.css(p,{"border-top-width":e?1:0,"border-left-width":e?0:1,top:e?"100%":"",right:e?r.indent:"",bottom:e?"":r.indent,left:e?"":"100%",padding:e?"0 8px":"2px 4px"}),u.appendChild(a)},m=function(){a.parentNode.removeChild(a)},h=function(){a.parentNode!==u&&f();var r={};r[t?"top":"left"]=e.triggerPosition(),r[t?"height":"width"]=e.duration(),o.css(a,r),o.css(p,{display:e.duration()>0?"":"none"})},v=function(){var n=d.trigger(r.colorTrigger),a={};a[t?"right":"bottom"]=0,a[t?"border-top-width":"border-left-width"]=1,o.css(n.firstChild,a),o.css(n.firstChild.firstChild,{padding:t?"0 8px 3px 8px":"3px 4px"}),document.body.appendChild(n);var g={triggerHook:e.triggerHook(),element:n,members:[s]};i._indicators.groups.push(g),s.triggerGroup=g,i._indicators.updateTriggerGroupLabel(g),i._indicators.updateTriggerGroupPositions(g)},b=function(){i._indicators.groups.splice(i._indicators.groups.indexOf(s.triggerGroup),1),s.triggerGroup.element.parentNode.removeChild(s.triggerGroup.element),s.triggerGroup=void 0},G=function(){var r=e.triggerHook(),t=1e-4;if(!(s.triggerGroup&&Math.abs(s.triggerGroup.triggerHook-r)<t)){for(var o,n=i._indicators.groups,d=n.length;d--;)if(o=n[d],Math.abs(o.triggerHook-r)<t)return s.triggerGroup&&(1===s.triggerGroup.members.length?b():(s.triggerGroup.members.splice(s.triggerGroup.members.indexOf(s),1),i._indicators.updateTriggerGroupLabel(s.triggerGroup),i._indicators.updateTriggerGroupPositions(s.triggerGroup))),o.members.push(s),s.triggerGroup=o,void i._indicators.updateTriggerGroupLabel(o);if(s.triggerGroup){if(1===s.triggerGroup.members.length)return s.triggerGroup.triggerHook=r,void i._indicators.updateTriggerGroupPositions(s.triggerGroup);s.triggerGroup.members.splice(s.triggerGroup.members.indexOf(s),1),i._indicators.updateTriggerGroupLabel(s.triggerGroup),i._indicators.updateTriggerGroupPositions(s.triggerGroup),s.triggerGroup=void 0}v()}}},d={start:function(e){var r=document.createElement("div");r.textContent="start",o.css(r,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:e,"border-color":e});var t=document.createElement("div");return o.css(t,{position:"absolute",overflow:"visible",width:0,height:0}),t.appendChild(r),t},end:function(e){var r=document.createElement("div");return r.textContent="end",o.css(r,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:e,"border-color":e}),r},bounds:function(){var e=document.createElement("div");return o.css(e,{position:"absolute",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":r}),e.style.zIndex=t,e},trigger:function(e){var i=document.createElement("div");i.textContent="trigger",o.css(i,{position:"relative"});var n=document.createElement("div");o.css(n,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:e,"border-color":e}),n.appendChild(i);var s=document.createElement("div");return o.css(s,{position:"fixed",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":r}),s.style.zIndex=t,s.appendChild(n),s}}});(function(root,factory){if(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.PhotoSwipe=factory();}})(this,function(){'use strict';var PhotoSwipe=function(template,UiClass,items,options){var framework={features:null,bind:function(target,type,listener,unbind){var methodName=(unbind?'remove':'add')+'EventListener';type=type.split(' ');for(var i=0;i<type.length;i++){if(type[i]){target[methodName](type[i],listener,false);}}},isArray:function(obj){return(obj instanceof Array);},createEl:function(classes,tag){var el=document.createElement(tag||'div');if(classes){el.className=classes;}
return el;},getScrollY:function(){var yOffset=window.pageYOffset;return yOffset!==undefined?yOffset:document.documentElement.scrollTop;},unbind:function(target,type,listener){framework.bind(target,type,listener,true);},removeClass:function(el,className){var reg=new RegExp('(\\s|^)'+className+'(\\s|$)');el.className=el.className.replace(reg,' ').replace(/^\s\s*/,'').replace(/\s\s*$/,'');},addClass:function(el,className){if(!framework.hasClass(el,className)){el.className+=(el.className?' ':'')+className;}},hasClass:function(el,className){return el.className&&new RegExp('(^|\\s)'+className+'(\\s|$)').test(el.className);},getChildByClass:function(parentEl,childClassName){var node=parentEl.firstChild;while(node){if(framework.hasClass(node,childClassName)){return node;}
node=node.nextSibling;}},arraySearch:function(array,value,key){var i=array.length;while(i--){if(array[i][key]===value){return i;}}
return-1;},extend:function(o1,o2,preventOverwrite){for(var prop in o2){if(o2.hasOwnProperty(prop)){if(preventOverwrite&&o1.hasOwnProperty(prop)){continue;}
o1[prop]=o2[prop];}}},easing:{sine:{out:function(k){return Math.sin(k*(Math.PI/2));},inOut:function(k){return-(Math.cos(Math.PI*k)-1)/2;}},cubic:{out:function(k){return--k*k*k+1;}}},detectFeatures:function(){if(framework.features){return framework.features;}
var helperEl=framework.createEl(),helperStyle=helperEl.style,vendor='',features={};features.oldIE=document.all&&!document.addEventListener;features.touch='ontouchstart'in window;if(window.requestAnimationFrame){features.raf=window.requestAnimationFrame;features.caf=window.cancelAnimationFrame;}
features.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled;if(!features.pointerEvent){var ua=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var v=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);if(v&&v.length>0){v=parseInt(v[1],10);if(v>=1&&v<8){features.isOldIOSPhone=true;}}}
var match=ua.match(/Android\s([0-9\.]*)/);var androidversion=match?match[1]:0;androidversion=parseFloat(androidversion);if(androidversion>=1){if(androidversion<4.4){features.isOldAndroid=true;}
features.androidVersion=androidversion;}
features.isMobileOpera=/opera mini|opera mobi/i.test(ua);}
var styleChecks=['transform','perspective','animationName'],vendors=['','webkit','Moz','ms','O'],styleCheckItem,styleName;for(var i=0;i<4;i++){vendor=vendors[i];for(var a=0;a<3;a++){styleCheckItem=styleChecks[a];styleName=vendor+(vendor?styleCheckItem.charAt(0).toUpperCase()+styleCheckItem.slice(1):styleCheckItem);if(!features[styleCheckItem]&&styleName in helperStyle){features[styleCheckItem]=styleName;}}
if(vendor&&!features.raf){vendor=vendor.toLowerCase();features.raf=window[vendor+'RequestAnimationFrame'];if(features.raf){features.caf=window[vendor+'CancelAnimationFrame']||window[vendor+'CancelRequestAnimationFrame'];}}}
if(!features.raf){var lastTime=0;features.raf=function(fn){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){fn(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};features.caf=function(id){clearTimeout(id);};}
features.svg=!!document.createElementNS&&!!document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect;framework.features=features;return features;}};framework.detectFeatures();if(framework.features.oldIE){framework.bind=function(target,type,listener,unbind){type=type.split(' ');var methodName=(unbind?'detach':'attach')+'Event',evName,_handleEv=function(){listener.handleEvent.call(listener);};for(var i=0;i<type.length;i++){evName=type[i];if(evName){if(typeof listener==='object'&&listener.handleEvent){if(!unbind){listener['oldIE'+evName]=_handleEv;}else{if(!listener['oldIE'+evName]){return false;}}
target[methodName]('on'+evName,listener['oldIE'+evName]);}else{target[methodName]('on'+evName,listener);}}}};}
var self=this;var DOUBLE_TAP_RADIUS=25,NUM_HOLDERS=3;var _options={allowPanToNext:true,spacing:0.12,bgOpacity:1,mouseUsed:false,loop:true,pinchToClose:true,closeOnScroll:true,closeOnVerticalDrag:true,verticalDragRange:0.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:false,focus:true,escKey:true,arrowKeys:true,mainScrollEndFriction:0.35,panEndFriction:0.35,isClickableElement:function(el){return el.tagName==='A';},getDoubleTapZoom:function(isMouseClick,item){if(isMouseClick){return 1;}else{return item.initialZoomLevel<0.7?1:1.33;}},maxSpreadZoom:1.33,modal:true,scaleMode:'fit'};framework.extend(_options,options);var _getEmptyPoint=function(){return{x:0,y:0};};var _isOpen,_isDestroying,_closedByScroll,_currentItemIndex,_containerStyle,_containerShiftIndex,_currPanDist=_getEmptyPoint(),_startPanOffset=_getEmptyPoint(),_panOffset=_getEmptyPoint(),_upMoveEvents,_downEvents,_globalEventHandlers,_viewportSize={},_currZoomLevel,_startZoomLevel,_translatePrefix,_translateSufix,_updateSizeInterval,_itemsNeedUpdate,_currPositionIndex=0,_offset={},_slideSize=_getEmptyPoint(),_itemHolders,_prevItemIndex,_indexDiff=0,_dragStartEvent,_dragMoveEvent,_dragEndEvent,_dragCancelEvent,_transformKey,_pointerEventEnabled,_isFixedPosition=true,_likelyTouchDevice,_modules=[],_requestAF,_cancelAF,_initalClassName,_initalWindowScrollY,_oldIE,_currentWindowScrollY,_features,_windowVisibleSize={},_renderMaxResolution=false,_orientationChangeTimeout,_registerModule=function(name,module){framework.extend(self,module.publicMethods);_modules.push(name);},_getLoopedId=function(index){var numSlides=_getNumItems();if(index>numSlides-1){return index-numSlides;}else if(index<0){return numSlides+index;}
return index;},_listeners={},_listen=function(name,fn){if(!_listeners[name]){_listeners[name]=[];}
return _listeners[name].push(fn);},_shout=function(name){var listeners=_listeners[name];if(listeners){var args=Array.prototype.slice.call(arguments);args.shift();for(var i=0;i<listeners.length;i++){listeners[i].apply(self,args);}}},_getCurrentTime=function(){return new Date().getTime();},_applyBgOpacity=function(opacity){_bgOpacity=opacity;self.bg.style.opacity=opacity*_options.bgOpacity;},_applyZoomTransform=function(styleObj,x,y,zoom,item){if(!_renderMaxResolution||(item&&item!==self.currItem)){zoom=zoom/(item?item.fitRatio:self.currItem.fitRatio);}
styleObj[_transformKey]=_translatePrefix+x+'px, '+y+'px'+_translateSufix+' scale('+zoom+')';},_applyCurrentZoomPan=function(allowRenderResolution){if(_currZoomElementStyle){if(allowRenderResolution){if(_currZoomLevel>self.currItem.fitRatio){if(!_renderMaxResolution){_setImageSize(self.currItem,false,true);_renderMaxResolution=true;}}else{if(_renderMaxResolution){_setImageSize(self.currItem);_renderMaxResolution=false;}}}
_applyZoomTransform(_currZoomElementStyle,_panOffset.x,_panOffset.y,_currZoomLevel);}},_applyZoomPanToItem=function(item){if(item.container){_applyZoomTransform(item.container.style,item.initialPosition.x,item.initialPosition.y,item.initialZoomLevel,item);}},_setTranslateX=function(x,elStyle){elStyle[_transformKey]=_translatePrefix+x+'px, 0px'+_translateSufix;},_moveMainScroll=function(x,dragging){if(!_options.loop&&dragging){var newSlideIndexOffset=_currentItemIndex+(_slideSize.x*_currPositionIndex-x)/_slideSize.x,delta=Math.round(x-_mainScrollPos.x);if((newSlideIndexOffset<0&&delta>0)||(newSlideIndexOffset>=_getNumItems()-1&&delta<0)){x=_mainScrollPos.x+delta*_options.mainScrollEndFriction;}}
_mainScrollPos.x=x;_setTranslateX(x,_containerStyle);},_calculatePanOffset=function(axis,zoomLevel){var m=_midZoomPoint[axis]-_offset[axis];return _startPanOffset[axis]+_currPanDist[axis]+m-m*(zoomLevel/_startZoomLevel);},_equalizePoints=function(p1,p2){p1.x=p2.x;p1.y=p2.y;if(p2.id){p1.id=p2.id;}},_roundPoint=function(p){p.x=Math.round(p.x);p.y=Math.round(p.y);},_mouseMoveTimeout=null,_onFirstMouseMove=function(){if(_mouseMoveTimeout){framework.unbind(document,'mousemove',_onFirstMouseMove);framework.addClass(template,'pswp--has_mouse');_options.mouseUsed=true;_shout('mouseUsed');}
_mouseMoveTimeout=setTimeout(function(){_mouseMoveTimeout=null;},100);},_bindEvents=function(){framework.bind(document,'keydown',self);if(_features.transform){framework.bind(self.scrollWrap,'click',self);}
if(!_options.mouseUsed){framework.bind(document,'mousemove',_onFirstMouseMove);}
framework.bind(window,'resize scroll orientationchange',self);_shout('bindEvents');},_unbindEvents=function(){framework.unbind(window,'resize scroll orientationchange',self);framework.unbind(window,'scroll',_globalEventHandlers.scroll);framework.unbind(document,'keydown',self);framework.unbind(document,'mousemove',_onFirstMouseMove);if(_features.transform){framework.unbind(self.scrollWrap,'click',self);}
if(_isDragging){framework.unbind(window,_upMoveEvents,self);}
clearTimeout(_orientationChangeTimeout);_shout('unbindEvents');},_calculatePanBounds=function(zoomLevel,update){var bounds=_calculateItemSize(self.currItem,_viewportSize,zoomLevel);if(update){_currPanBounds=bounds;}
return bounds;},_getMinZoomLevel=function(item){if(!item){item=self.currItem;}
return item.initialZoomLevel;},_getMaxZoomLevel=function(item){if(!item){item=self.currItem;}
return item.w>0?_options.maxSpreadZoom:1;},_modifyDestPanOffset=function(axis,destPanBounds,destPanOffset,destZoomLevel){if(destZoomLevel===self.currItem.initialZoomLevel){destPanOffset[axis]=self.currItem.initialPosition[axis];return true;}else{destPanOffset[axis]=_calculatePanOffset(axis,destZoomLevel);if(destPanOffset[axis]>destPanBounds.min[axis]){destPanOffset[axis]=destPanBounds.min[axis];return true;}else if(destPanOffset[axis]<destPanBounds.max[axis]){destPanOffset[axis]=destPanBounds.max[axis];return true;}}
return false;},_setupTransforms=function(){if(_transformKey){var allow3dTransform=_features.perspective&&!_likelyTouchDevice;_translatePrefix='translate'+(allow3dTransform?'3d(':'(');_translateSufix=_features.perspective?', 0px)':')';return;}
_transformKey='left';framework.addClass(template,'pswp--ie');_setTranslateX=function(x,elStyle){elStyle.left=x+'px';};_applyZoomPanToItem=function(item){var zoomRatio=item.fitRatio>1?1:item.fitRatio,s=item.container.style,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+'px';s.height=h+'px';s.left=item.initialPosition.x+'px';s.top=item.initialPosition.y+'px';};_applyCurrentZoomPan=function(){if(_currZoomElementStyle){var s=_currZoomElementStyle,item=self.currItem,zoomRatio=item.fitRatio>1?1:item.fitRatio,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+'px';s.height=h+'px';s.left=_panOffset.x+'px';s.top=_panOffset.y+'px';}};},_onKeyDown=function(e){var keydownAction='';if(_options.escKey&&e.keyCode===27){keydownAction='close';}else if(_options.arrowKeys){if(e.keyCode===37){keydownAction='prev';}else if(e.keyCode===39){keydownAction='next';}}
if(keydownAction){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}
self[keydownAction]();}}},_onGlobalClick=function(e){if(!e){return;}
if(_moved||_zoomStarted||_mainScrollAnimating||_verticalDragInitiated){e.preventDefault();e.stopPropagation();}},_updatePageScrollOffset=function(){self.setScrollOffset(0,framework.getScrollY());};var _animations={},_numAnimations=0,_stopAnimation=function(name){if(_animations[name]){if(_animations[name].raf){_cancelAF(_animations[name].raf);}
_numAnimations--;delete _animations[name];}},_registerStartAnimation=function(name){if(_animations[name]){_stopAnimation(name);}
if(!_animations[name]){_numAnimations++;_animations[name]={};}},_stopAllAnimations=function(){for(var prop in _animations){if(_animations.hasOwnProperty(prop)){_stopAnimation(prop);}}},_animateProp=function(name,b,endProp,d,easingFn,onUpdate,onComplete){var startAnimTime=_getCurrentTime(),t;_registerStartAnimation(name);var animloop=function(){if(_animations[name]){t=_getCurrentTime()-startAnimTime;if(t>=d){_stopAnimation(name);onUpdate(endProp);if(onComplete){onComplete();}
return;}
onUpdate((endProp-b)*easingFn(t/d)+b);_animations[name].raf=_requestAF(animloop);}};animloop();};var publicMethods={shout:_shout,listen:_listen,viewportSize:_viewportSize,options:_options,isMainScrollAnimating:function(){return _mainScrollAnimating;},getZoomLevel:function(){return _currZoomLevel;},getCurrentIndex:function(){return _currentItemIndex;},isDragging:function(){return _isDragging;},isZooming:function(){return _isZooming;},setScrollOffset:function(x,y){_offset.x=x;_currentWindowScrollY=_offset.y=y;_shout('updateScrollOffset',_offset);},applyZoomPan:function(zoomLevel,panX,panY,allowRenderResolution){_panOffset.x=panX;_panOffset.y=panY;_currZoomLevel=zoomLevel;_applyCurrentZoomPan(allowRenderResolution);},init:function(){if(_isOpen||_isDestroying){return;}
var i;self.framework=framework;self.template=template;self.bg=framework.getChildByClass(template,'pswp__bg');_initalClassName=template.className;_isOpen=true;_features=framework.detectFeatures();_requestAF=_features.raf;_cancelAF=_features.caf;_transformKey=_features.transform;_oldIE=_features.oldIE;self.scrollWrap=framework.getChildByClass(template,'pswp__scroll-wrap');self.container=framework.getChildByClass(self.scrollWrap,'pswp__container');_containerStyle=self.container.style;self.itemHolders=_itemHolders=[{el:self.container.children[0],wrap:0,index:-1},{el:self.container.children[1],wrap:0,index:-1},{el:self.container.children[2],wrap:0,index:-1}];_itemHolders[0].el.style.display=_itemHolders[2].el.style.display='none';_setupTransforms();_globalEventHandlers={resize:self.updateSize,orientationchange:function(){clearTimeout(_orientationChangeTimeout);_orientationChangeTimeout=setTimeout(function(){if(_viewportSize.x!==self.scrollWrap.clientWidth){self.updateSize();}},500);},scroll:_updatePageScrollOffset,keydown:_onKeyDown,click:_onGlobalClick};var oldPhone=_features.isOldIOSPhone||_features.isOldAndroid||_features.isMobileOpera;if(!_features.animationName||!_features.transform||oldPhone){_options.showAnimationDuration=_options.hideAnimationDuration=0;}
for(i=0;i<_modules.length;i++){self['init'+_modules[i]]();}
if(UiClass){var ui=self.ui=new UiClass(self,framework);ui.init();}
_shout('firstUpdate');_currentItemIndex=_currentItemIndex||_options.index||0;if(isNaN(_currentItemIndex)||_currentItemIndex<0||_currentItemIndex>=_getNumItems()){_currentItemIndex=0;}
self.currItem=_getItemAt(_currentItemIndex);if(_features.isOldIOSPhone||_features.isOldAndroid){_isFixedPosition=false;}
template.setAttribute('aria-hidden','false');if(_options.modal){if(!_isFixedPosition){template.style.position='absolute';template.style.top=framework.getScrollY()+'px';}else{template.style.position='fixed';}}
if(_currentWindowScrollY===undefined){_shout('initialLayout');_currentWindowScrollY=_initalWindowScrollY=framework.getScrollY();}
var rootClasses='pswp--open ';if(_options.mainClass){rootClasses+=_options.mainClass+' ';}
if(_options.showHideOpacity){rootClasses+='pswp--animate_opacity ';}
rootClasses+=_likelyTouchDevice?'pswp--touch':'pswp--notouch';rootClasses+=_features.animationName?' pswp--css_animation':'';rootClasses+=_features.svg?' pswp--svg':'';framework.addClass(template,rootClasses);self.updateSize();_containerShiftIndex=-1;_indexDiff=null;for(i=0;i<NUM_HOLDERS;i++){_setTranslateX((i+_containerShiftIndex)*_slideSize.x,_itemHolders[i].el.style);}
if(!_oldIE){framework.bind(self.scrollWrap,_downEvents,self);}
_listen('initialZoomInEnd',function(){self.setContent(_itemHolders[0],_currentItemIndex-1);self.setContent(_itemHolders[2],_currentItemIndex+1);_itemHolders[0].el.style.display=_itemHolders[2].el.style.display='block';if(_options.focus){template.focus();}
_bindEvents();});self.setContent(_itemHolders[1],_currentItemIndex);self.updateCurrItem();_shout('afterInit');if(!_isFixedPosition){_updateSizeInterval=setInterval(function(){if(!_numAnimations&&!_isDragging&&!_isZooming&&(_currZoomLevel===self.currItem.initialZoomLevel)){self.updateSize();}},1000);}
framework.addClass(template,'pswp--visible');},close:function(){if(!_isOpen){return;}
_isOpen=false;_isDestroying=true;_shout('close');_unbindEvents();_showOrHide(self.currItem,null,true,self.destroy);},destroy:function(){_shout('destroy');if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout);}
template.setAttribute('aria-hidden','true');template.className=_initalClassName;if(_updateSizeInterval){clearInterval(_updateSizeInterval);}
framework.unbind(self.scrollWrap,_downEvents,self);framework.unbind(window,'scroll',self);_stopDragUpdateLoop();_stopAllAnimations();_listeners=null;},panTo:function(x,y,force){if(!force){if(x>_currPanBounds.min.x){x=_currPanBounds.min.x;}else if(x<_currPanBounds.max.x){x=_currPanBounds.max.x;}
if(y>_currPanBounds.min.y){y=_currPanBounds.min.y;}else if(y<_currPanBounds.max.y){y=_currPanBounds.max.y;}}
_panOffset.x=x;_panOffset.y=y;_applyCurrentZoomPan();},handleEvent:function(e){e=e||window.event;if(_globalEventHandlers[e.type]){_globalEventHandlers[e.type](e);}},goTo:function(index){index=_getLoopedId(index);var diff=index-_currentItemIndex;_indexDiff=diff;_currentItemIndex=index;self.currItem=_getItemAt(_currentItemIndex);_currPositionIndex-=diff;_moveMainScroll(_slideSize.x*_currPositionIndex);_stopAllAnimations();_mainScrollAnimating=false;self.updateCurrItem();},next:function(){self.goTo(_currentItemIndex+1);},prev:function(){self.goTo(_currentItemIndex-1);},updateCurrZoomItem:function(emulateSetContent){if(emulateSetContent){_shout('beforeChange',0);}
if(_itemHolders[1].el.children.length){var zoomElement=_itemHolders[1].el.children[0];if(framework.hasClass(zoomElement,'pswp__zoom-wrap')){_currZoomElementStyle=zoomElement.style;}else{_currZoomElementStyle=null;}}else{_currZoomElementStyle=null;}
_currPanBounds=self.currItem.bounds;_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;if(emulateSetContent){_shout('afterChange');}},invalidateCurrItems:function(){_itemsNeedUpdate=true;for(var i=0;i<NUM_HOLDERS;i++){if(_itemHolders[i].item){_itemHolders[i].item.needsUpdate=true;}}},updateCurrItem:function(beforeAnimation){if(_indexDiff===0){return;}
var diffAbs=Math.abs(_indexDiff),tempHolder;if(beforeAnimation&&diffAbs<2){return;}
self.currItem=_getItemAt(_currentItemIndex);_renderMaxResolution=false;_shout('beforeChange',_indexDiff);if(diffAbs>=NUM_HOLDERS){_containerShiftIndex+=_indexDiff+(_indexDiff>0?-NUM_HOLDERS:NUM_HOLDERS);diffAbs=NUM_HOLDERS;}
for(var i=0;i<diffAbs;i++){if(_indexDiff>0){tempHolder=_itemHolders.shift();_itemHolders[NUM_HOLDERS-1]=tempHolder;_containerShiftIndex++;_setTranslateX((_containerShiftIndex+2)*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex-diffAbs+i+1+1);}else{tempHolder=_itemHolders.pop();_itemHolders.unshift(tempHolder);_containerShiftIndex--;_setTranslateX(_containerShiftIndex*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex+diffAbs-i-1-1);}}
if(_currZoomElementStyle&&Math.abs(_indexDiff)===1){var prevItem=_getItemAt(_prevItemIndex);if(prevItem.initialZoomLevel!==_currZoomLevel){_calculateItemSize(prevItem,_viewportSize);_setImageSize(prevItem);_applyZoomPanToItem(prevItem);}}
_indexDiff=0;self.updateCurrZoomItem();_prevItemIndex=_currentItemIndex;_shout('afterChange');},updateSize:function(force){if(!_isFixedPosition&&_options.modal){var windowScrollY=framework.getScrollY();if(_currentWindowScrollY!==windowScrollY){template.style.top=windowScrollY+'px';_currentWindowScrollY=windowScrollY;}
if(!force&&_windowVisibleSize.x===window.innerWidth&&_windowVisibleSize.y===window.innerHeight){return;}
_windowVisibleSize.x=window.innerWidth;_windowVisibleSize.y=window.innerHeight;template.style.height=_windowVisibleSize.y+'px';}
_viewportSize.x=self.scrollWrap.clientWidth;_viewportSize.y=self.scrollWrap.clientHeight;_updatePageScrollOffset();_slideSize.x=_viewportSize.x+Math.round(_viewportSize.x*_options.spacing);_slideSize.y=_viewportSize.y;_moveMainScroll(_slideSize.x*_currPositionIndex);_shout('beforeResize');if(_containerShiftIndex!==undefined){var holder,item,hIndex;for(var i=0;i<NUM_HOLDERS;i++){holder=_itemHolders[i];_setTranslateX((i+_containerShiftIndex)*_slideSize.x,holder.el.style);hIndex=_currentItemIndex+i-1;if(_options.loop&&_getNumItems()>2){hIndex=_getLoopedId(hIndex);}
item=_getItemAt(hIndex);if(item&&(_itemsNeedUpdate||item.needsUpdate||!item.bounds)){self.cleanSlide(item);self.setContent(holder,hIndex);if(i===1){self.currItem=item;self.updateCurrZoomItem(true);}
item.needsUpdate=false;}else if(holder.index===-1&&hIndex>=0){self.setContent(holder,hIndex);}
if(item&&item.container){_calculateItemSize(item,_viewportSize);_setImageSize(item);_applyZoomPanToItem(item);}}
_itemsNeedUpdate=false;}
_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_currPanBounds=self.currItem.bounds;if(_currPanBounds){_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;_applyCurrentZoomPan(true);}
_shout('resize');},zoomTo:function(destZoomLevel,centerPoint,speed,easingFn,updateFn){if(centerPoint){_startZoomLevel=_currZoomLevel;_midZoomPoint.x=Math.abs(centerPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(centerPoint.y)-_panOffset.y;_equalizePoints(_startPanOffset,_panOffset);}
var destPanBounds=_calculatePanBounds(destZoomLevel,false),destPanOffset={};_modifyDestPanOffset('x',destPanBounds,destPanOffset,destZoomLevel);_modifyDestPanOffset('y',destPanBounds,destPanOffset,destZoomLevel);var initialZoomLevel=_currZoomLevel;var initialPanOffset={x:_panOffset.x,y:_panOffset.y};_roundPoint(destPanOffset);var onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=destPanOffset.x;_panOffset.y=destPanOffset.y;}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(destPanOffset.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(destPanOffset.y-initialPanOffset.y)*now+initialPanOffset.y;}
if(updateFn){updateFn(now);}
_applyCurrentZoomPan(now===1);};if(speed){_animateProp('customZoomTo',0,1,speed,easingFn||framework.easing.sine.inOut,onUpdate);}else{onUpdate(1);}}};var MIN_SWIPE_DISTANCE=30,DIRECTION_CHECK_OFFSET=10;var _gestureStartTime,_gestureCheckSpeedTime,p={},p2={},delta={},_currPoint={},_startPoint={},_currPointers=[],_startMainScrollPos={},_releaseAnimData,_posPoints=[],_tempPoint={},_isZoomingIn,_verticalDragInitiated,_oldAndroidTouchEndTimeout,_currZoomedItemIndex=0,_centerPoint=_getEmptyPoint(),_lastReleaseTime=0,_isDragging,_isMultitouch,_zoomStarted,_moved,_dragAnimFrame,_mainScrollShifted,_currentPoints,_isZooming,_currPointsDistance,_startPointsDistance,_currPanBounds,_mainScrollPos=_getEmptyPoint(),_currZoomElementStyle,_mainScrollAnimating,_midZoomPoint=_getEmptyPoint(),_currCenterPoint=_getEmptyPoint(),_direction,_isFirstMove,_opacityChanged,_bgOpacity,_wasOverInitialZoom,_isEqualPoints=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y;},_isNearbyPoints=function(touch0,touch1){return Math.abs(touch0.x-touch1.x)<DOUBLE_TAP_RADIUS&&Math.abs(touch0.y-touch1.y)<DOUBLE_TAP_RADIUS;},_calculatePointsDistance=function(p1,p2){_tempPoint.x=Math.abs(p1.x-p2.x);_tempPoint.y=Math.abs(p1.y-p2.y);return Math.sqrt(_tempPoint.x*_tempPoint.x+_tempPoint.y*_tempPoint.y);},_stopDragUpdateLoop=function(){if(_dragAnimFrame){_cancelAF(_dragAnimFrame);_dragAnimFrame=null;}},_dragUpdateLoop=function(){if(_isDragging){_dragAnimFrame=_requestAF(_dragUpdateLoop);_renderMovement();}},_canPan=function(){return!(_options.scaleMode==='fit'&&_currZoomLevel===self.currItem.initialZoomLevel);},_closestElement=function(el,fn){if(!el||el===document){return false;}
if(el.getAttribute('class')&&el.getAttribute('class').indexOf('pswp__scroll-wrap')>-1){return false;}
if(fn(el)){return el;}
return _closestElement(el.parentNode,fn);},_preventObj={},_preventDefaultEventBehaviour=function(e,isDown){_preventObj.prevent=!_closestElement(e.target,_options.isClickableElement);_shout('preventDragEvent',e,isDown,_preventObj);return _preventObj.prevent;},_convertTouchToPoint=function(touch,p){p.x=touch.pageX;p.y=touch.pageY;p.id=touch.identifier;return p;},_findCenterOfPoints=function(p1,p2,pCenter){pCenter.x=(p1.x+p2.x)*0.5;pCenter.y=(p1.y+p2.y)*0.5;},_pushPosPoint=function(time,x,y){if(time-_gestureCheckSpeedTime>50){var o=_posPoints.length>2?_posPoints.shift():{};o.x=x;o.y=y;_posPoints.push(o);_gestureCheckSpeedTime=time;}},_calculateVerticalDragOpacityRatio=function(){var yOffset=_panOffset.y-self.currItem.initialPosition.y;return 1-Math.abs(yOffset/(_viewportSize.y/2));},_ePoint1={},_ePoint2={},_tempPointsArr=[],_tempCounter,_getTouchPoints=function(e){while(_tempPointsArr.length>0){_tempPointsArr.pop();}
if(!_pointerEventEnabled){if(e.type.indexOf('touch')>-1){if(e.touches&&e.touches.length>0){_tempPointsArr[0]=_convertTouchToPoint(e.touches[0],_ePoint1);if(e.touches.length>1){_tempPointsArr[1]=_convertTouchToPoint(e.touches[1],_ePoint2);}}}else{_ePoint1.x=e.pageX;_ePoint1.y=e.pageY;_ePoint1.id='';_tempPointsArr[0]=_ePoint1;}}else{_tempCounter=0;_currPointers.forEach(function(p){if(_tempCounter===0){_tempPointsArr[0]=p;}else if(_tempCounter===1){_tempPointsArr[1]=p;}
_tempCounter++;});}
return _tempPointsArr;},_panOrMoveMainScroll=function(axis,delta){var panFriction,overDiff=0,newOffset=_panOffset[axis]+delta[axis],startOverDiff,dir=delta[axis]>0,newMainScrollPosition=_mainScrollPos.x+delta.x,mainScrollDiff=_mainScrollPos.x-_startMainScrollPos.x,newPanPos,newMainScrollPos;if(newOffset>_currPanBounds.min[axis]||newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;}else{panFriction=1;}
newOffset=_panOffset[axis]+delta[axis]*panFriction;if(_options.allowPanToNext||_currZoomLevel===self.currItem.initialZoomLevel){if(!_currZoomElementStyle){newMainScrollPos=newMainScrollPosition;}else if(_direction==='h'&&axis==='x'&&!_zoomStarted){if(dir){if(newOffset>_currPanBounds.min[axis]){panFriction=_options.panEndFriction;overDiff=_currPanBounds.min[axis]-newOffset;startOverDiff=_currPanBounds.min[axis]-_startPanOffset[axis];}
if((startOverDiff<=0||mainScrollDiff<0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff<0&&newMainScrollPosition>_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x;}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset;}}}else{if(newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;overDiff=newOffset-_currPanBounds.max[axis];startOverDiff=_startPanOffset[axis]-_currPanBounds.max[axis];}
if((startOverDiff<=0||mainScrollDiff>0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff>0&&newMainScrollPosition<_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x;}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset;}}}}
if(axis==='x'){if(newMainScrollPos!==undefined){_moveMainScroll(newMainScrollPos,true);if(newMainScrollPos===_startMainScrollPos.x){_mainScrollShifted=false;}else{_mainScrollShifted=true;}}
if(_currPanBounds.min.x!==_currPanBounds.max.x){if(newPanPos!==undefined){_panOffset.x=newPanPos;}else if(!_mainScrollShifted){_panOffset.x+=delta.x*panFriction;}}
return newMainScrollPos!==undefined;}}
if(!_mainScrollAnimating){if(!_mainScrollShifted){if(_currZoomLevel>self.currItem.fitRatio){_panOffset[axis]+=delta[axis]*panFriction;}}}},_onDragStart=function(e){if(e.type==='mousedown'&&e.button>0){return;}
if(_initialZoomRunning){e.preventDefault();return;}
if(_oldAndroidTouchEndTimeout&&e.type==='mousedown'){return;}
if(_preventDefaultEventBehaviour(e,true)){e.preventDefault();}
_shout('pointerDown');if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex<0){pointerIndex=_currPointers.length;}
_currPointers[pointerIndex]={x:e.pageX,y:e.pageY,id:e.pointerId};}
var startPointsList=_getTouchPoints(e),numPoints=startPointsList.length;_currentPoints=null;_stopAllAnimations();if(!_isDragging||numPoints===1){_isDragging=_isFirstMove=true;framework.bind(window,_upMoveEvents,self);_isZoomingIn=_wasOverInitialZoom=_opacityChanged=_verticalDragInitiated=_mainScrollShifted=_moved=_isMultitouch=_zoomStarted=false;_direction=null;_shout('firstTouchStart',startPointsList);_equalizePoints(_startPanOffset,_panOffset);_currPanDist.x=_currPanDist.y=0;_equalizePoints(_currPoint,startPointsList[0]);_equalizePoints(_startPoint,_currPoint);_startMainScrollPos.x=_slideSize.x*_currPositionIndex;_posPoints=[{x:_currPoint.x,y:_currPoint.y}];_gestureCheckSpeedTime=_gestureStartTime=_getCurrentTime();_calculatePanBounds(_currZoomLevel,true);_stopDragUpdateLoop();_dragUpdateLoop();}
if(!_isZooming&&numPoints>1&&!_mainScrollAnimating&&!_mainScrollShifted){_startZoomLevel=_currZoomLevel;_zoomStarted=false;_isZooming=_isMultitouch=true;_currPanDist.y=_currPanDist.x=0;_equalizePoints(_startPanOffset,_panOffset);_equalizePoints(p,startPointsList[0]);_equalizePoints(p2,startPointsList[1]);_findCenterOfPoints(p,p2,_currCenterPoint);_midZoomPoint.x=Math.abs(_currCenterPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(_currCenterPoint.y)-_panOffset.y;_currPointsDistance=_startPointsDistance=_calculatePointsDistance(p,p2);}},_onDragMove=function(e){e.preventDefault();if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex>-1){var p=_currPointers[pointerIndex];p.x=e.pageX;p.y=e.pageY;}}
if(_isDragging){var touchesList=_getTouchPoints(e);if(!_direction&&!_moved&&!_isZooming){if(_mainScrollPos.x!==_slideSize.x*_currPositionIndex){_direction='h';}else{var diff=Math.abs(touchesList[0].x-_currPoint.x)-Math.abs(touchesList[0].y-_currPoint.y);if(Math.abs(diff)>=DIRECTION_CHECK_OFFSET){_direction=diff>0?'h':'v';_currentPoints=touchesList;}}}else{_currentPoints=touchesList;}}},_renderMovement=function(){if(!_currentPoints){return;}
var numPoints=_currentPoints.length;if(numPoints===0){return;}
_equalizePoints(p,_currentPoints[0]);delta.x=p.x-_currPoint.x;delta.y=p.y-_currPoint.y;if(_isZooming&&numPoints>1){_currPoint.x=p.x;_currPoint.y=p.y;if(!delta.x&&!delta.y&&_isEqualPoints(_currentPoints[1],p2)){return;}
_equalizePoints(p2,_currentPoints[1]);if(!_zoomStarted){_zoomStarted=true;_shout('zoomGestureStarted');}
var pointsDistance=_calculatePointsDistance(p,p2);var zoomLevel=_calculateZoomLevel(pointsDistance);if(zoomLevel>self.currItem.initialZoomLevel+self.currItem.initialZoomLevel/15){_wasOverInitialZoom=true;}
var zoomFriction=1,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(zoomLevel<minZoomLevel){if(_options.pinchToClose&&!_wasOverInitialZoom&&_startZoomLevel<=self.currItem.initialZoomLevel){var minusDiff=minZoomLevel-zoomLevel;var percent=1-minusDiff/(minZoomLevel/1.2);_applyBgOpacity(percent);_shout('onPinchClose',percent);_opacityChanged=true;}else{zoomFriction=(minZoomLevel-zoomLevel)/minZoomLevel;if(zoomFriction>1){zoomFriction=1;}
zoomLevel=minZoomLevel-zoomFriction*(minZoomLevel/3);}}else if(zoomLevel>maxZoomLevel){zoomFriction=(zoomLevel-maxZoomLevel)/(minZoomLevel*6);if(zoomFriction>1){zoomFriction=1;}
zoomLevel=maxZoomLevel+zoomFriction*minZoomLevel;}
if(zoomFriction<0){zoomFriction=0;}
_currPointsDistance=pointsDistance;_findCenterOfPoints(p,p2,_centerPoint);_currPanDist.x+=_centerPoint.x-_currCenterPoint.x;_currPanDist.y+=_centerPoint.y-_currCenterPoint.y;_equalizePoints(_currCenterPoint,_centerPoint);_panOffset.x=_calculatePanOffset('x',zoomLevel);_panOffset.y=_calculatePanOffset('y',zoomLevel);_isZoomingIn=zoomLevel>_currZoomLevel;_currZoomLevel=zoomLevel;_applyCurrentZoomPan();}else{if(!_direction){return;}
if(_isFirstMove){_isFirstMove=false;if(Math.abs(delta.x)>=DIRECTION_CHECK_OFFSET){delta.x-=_currentPoints[0].x-_startPoint.x;}
if(Math.abs(delta.y)>=DIRECTION_CHECK_OFFSET){delta.y-=_currentPoints[0].y-_startPoint.y;}}
_currPoint.x=p.x;_currPoint.y=p.y;if(delta.x===0&&delta.y===0){return;}
if(_direction==='v'&&_options.closeOnVerticalDrag){if(!_canPan()){_currPanDist.y+=delta.y;_panOffset.y+=delta.y;var opacityRatio=_calculateVerticalDragOpacityRatio();_verticalDragInitiated=true;_shout('onVerticalDrag',opacityRatio);_applyBgOpacity(opacityRatio);_applyCurrentZoomPan();return;}}
_pushPosPoint(_getCurrentTime(),p.x,p.y);_moved=true;_currPanBounds=self.currItem.bounds;var mainScrollChanged=_panOrMoveMainScroll('x',delta);if(!mainScrollChanged){_panOrMoveMainScroll('y',delta);_roundPoint(_panOffset);_applyCurrentZoomPan();}}},_onDragRelease=function(e){if(_features.isOldAndroid){if(_oldAndroidTouchEndTimeout&&e.type==='mouseup'){return;}
if(e.type.indexOf('touch')>-1){clearTimeout(_oldAndroidTouchEndTimeout);_oldAndroidTouchEndTimeout=setTimeout(function(){_oldAndroidTouchEndTimeout=0;},600);}}
_shout('pointerUp');if(_preventDefaultEventBehaviour(e,false)){e.preventDefault();}
var releasePoint;if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex>-1){releasePoint=_currPointers.splice(pointerIndex,1)[0];if(navigator.pointerEnabled){releasePoint.type=e.pointerType||'mouse';}else{var MSPOINTER_TYPES={4:'mouse',2:'touch',3:'pen'};releasePoint.type=MSPOINTER_TYPES[e.pointerType];if(!releasePoint.type){releasePoint.type=e.pointerType||'mouse';}}}}
var touchList=_getTouchPoints(e),gestureType,numPoints=touchList.length;if(e.type==='mouseup'){numPoints=0;}
if(numPoints===2){_currentPoints=null;return true;}
if(numPoints===1){_equalizePoints(_startPoint,touchList[0]);}
if(numPoints===0&&!_direction&&!_mainScrollAnimating){if(!releasePoint){if(e.type==='mouseup'){releasePoint={x:e.pageX,y:e.pageY,type:'mouse'};}else if(e.changedTouches&&e.changedTouches[0]){releasePoint={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:'touch'};}}
_shout('touchRelease',e,releasePoint);}
var releaseTimeDiff=-1;if(numPoints===0){_isDragging=false;framework.unbind(window,_upMoveEvents,self);_stopDragUpdateLoop();if(_isZooming){releaseTimeDiff=0;}else if(_lastReleaseTime!==-1){releaseTimeDiff=_getCurrentTime()-_lastReleaseTime;}}
_lastReleaseTime=numPoints===1?_getCurrentTime():-1;if(releaseTimeDiff!==-1&&releaseTimeDiff<150){gestureType='zoom';}else{gestureType='swipe';}
if(_isZooming&&numPoints<2){_isZooming=false;if(numPoints===1){gestureType='zoomPointerUp';}
_shout('zoomGestureEnded');}
_currentPoints=null;if(!_moved&&!_zoomStarted&&!_mainScrollAnimating&&!_verticalDragInitiated){return;}
_stopAllAnimations();if(!_releaseAnimData){_releaseAnimData=_initDragReleaseAnimationData();}
_releaseAnimData.calculateSwipeSpeed('x');if(_verticalDragInitiated){var opacityRatio=_calculateVerticalDragOpacityRatio();if(opacityRatio<_options.verticalDragRange){self.close();}else{var initalPanY=_panOffset.y,initialBgOpacity=_bgOpacity;_animateProp('verticalDrag',0,1,300,framework.easing.cubic.out,function(now){_panOffset.y=(self.currItem.initialPosition.y-initalPanY)*now+initalPanY;_applyBgOpacity((1-initialBgOpacity)*now+initialBgOpacity);_applyCurrentZoomPan();});_shout('onVerticalDrag',1);}
return;}
if((_mainScrollShifted||_mainScrollAnimating)&&numPoints===0){var itemChanged=_finishSwipeMainScrollGesture(gestureType,_releaseAnimData);if(itemChanged){return;}
gestureType='zoomPointerUp';}
if(_mainScrollAnimating){return;}
if(gestureType!=='swipe'){_completeZoomGesture();return;}
if(!_mainScrollShifted&&_currZoomLevel>self.currItem.fitRatio){_completePanGesture(_releaseAnimData);}},_initDragReleaseAnimationData=function(){var lastFlickDuration,tempReleasePos;var s={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(axis){if(_posPoints.length>1){lastFlickDuration=_getCurrentTime()-_gestureCheckSpeedTime+50;tempReleasePos=_posPoints[_posPoints.length-2][axis];}else{lastFlickDuration=_getCurrentTime()-_gestureStartTime;tempReleasePos=_startPoint[axis];}
s.lastFlickOffset[axis]=_currPoint[axis]-tempReleasePos;s.lastFlickDist[axis]=Math.abs(s.lastFlickOffset[axis]);if(s.lastFlickDist[axis]>20){s.lastFlickSpeed[axis]=s.lastFlickOffset[axis]/lastFlickDuration;}else{s.lastFlickSpeed[axis]=0;}
if(Math.abs(s.lastFlickSpeed[axis])<0.1){s.lastFlickSpeed[axis]=0;}
s.slowDownRatio[axis]=0.95;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];s.speedDecelerationRatio[axis]=1;},calculateOverBoundsAnimOffset:function(axis,speed){if(!s.backAnimStarted[axis]){if(_panOffset[axis]>_currPanBounds.min[axis]){s.backAnimDestination[axis]=_currPanBounds.min[axis];}else if(_panOffset[axis]<_currPanBounds.max[axis]){s.backAnimDestination[axis]=_currPanBounds.max[axis];}
if(s.backAnimDestination[axis]!==undefined){s.slowDownRatio[axis]=0.7;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];if(s.speedDecelerationRatioAbs[axis]<0.05){s.lastFlickSpeed[axis]=0;s.backAnimStarted[axis]=true;_animateProp('bounceZoomPan'+axis,_panOffset[axis],s.backAnimDestination[axis],speed||300,framework.easing.sine.out,function(pos){_panOffset[axis]=pos;_applyCurrentZoomPan();});}}}},calculateAnimOffset:function(axis){if(!s.backAnimStarted[axis]){s.speedDecelerationRatio[axis]=s.speedDecelerationRatio[axis]*(s.slowDownRatio[axis]+
s.slowDownRatioReverse[axis]-
s.slowDownRatioReverse[axis]*s.timeDiff/10);s.speedDecelerationRatioAbs[axis]=Math.abs(s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]);s.distanceOffset[axis]=s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]*s.timeDiff;_panOffset[axis]+=s.distanceOffset[axis];}},panAnimLoop:function(){if(_animations.zoomPan){_animations.zoomPan.raf=_requestAF(s.panAnimLoop);s.now=_getCurrentTime();s.timeDiff=s.now-s.lastNow;s.lastNow=s.now;s.calculateAnimOffset('x');s.calculateAnimOffset('y');_applyCurrentZoomPan();s.calculateOverBoundsAnimOffset('x');s.calculateOverBoundsAnimOffset('y');if(s.speedDecelerationRatioAbs.x<0.05&&s.speedDecelerationRatioAbs.y<0.05){_panOffset.x=Math.round(_panOffset.x);_panOffset.y=Math.round(_panOffset.y);_applyCurrentZoomPan();_stopAnimation('zoomPan');return;}}}};return s;},_completePanGesture=function(animData){animData.calculateSwipeSpeed('y');_currPanBounds=self.currItem.bounds;animData.backAnimDestination={};animData.backAnimStarted={};if(Math.abs(animData.lastFlickSpeed.x)<=0.05&&Math.abs(animData.lastFlickSpeed.y)<=0.05){animData.speedDecelerationRatioAbs.x=animData.speedDecelerationRatioAbs.y=0;animData.calculateOverBoundsAnimOffset('x');animData.calculateOverBoundsAnimOffset('y');return true;}
_registerStartAnimation('zoomPan');animData.lastNow=_getCurrentTime();animData.panAnimLoop();},_finishSwipeMainScrollGesture=function(gestureType,_releaseAnimData){var itemChanged;if(!_mainScrollAnimating){_currZoomedItemIndex=_currentItemIndex;}
var itemsDiff;if(gestureType==='swipe'){var totalShiftDist=_currPoint.x-_startPoint.x,isFastLastFlick=_releaseAnimData.lastFlickDist.x<10;if(totalShiftDist>MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x>20)){itemsDiff=-1;}else if(totalShiftDist<-MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x<-20)){itemsDiff=1;}}
var nextCircle;if(itemsDiff){_currentItemIndex+=itemsDiff;if(_currentItemIndex<0){_currentItemIndex=_options.loop?_getNumItems()-1:0;nextCircle=true;}else if(_currentItemIndex>=_getNumItems()){_currentItemIndex=_options.loop?0:_getNumItems()-1;nextCircle=true;}
if(!nextCircle||_options.loop){_indexDiff+=itemsDiff;_currPositionIndex-=itemsDiff;itemChanged=true;}}
var animateToX=_slideSize.x*_currPositionIndex;var animateToDist=Math.abs(animateToX-_mainScrollPos.x);var finishAnimDuration;if(!itemChanged&&animateToX>_mainScrollPos.x!==_releaseAnimData.lastFlickSpeed.x>0){finishAnimDuration=333;}else{finishAnimDuration=Math.abs(_releaseAnimData.lastFlickSpeed.x)>0?animateToDist/Math.abs(_releaseAnimData.lastFlickSpeed.x):333;finishAnimDuration=Math.min(finishAnimDuration,400);finishAnimDuration=Math.max(finishAnimDuration,250);}
if(_currZoomedItemIndex===_currentItemIndex){itemChanged=false;}
_mainScrollAnimating=true;_shout('mainScrollAnimStart');_animateProp('mainScroll',_mainScrollPos.x,animateToX,finishAnimDuration,framework.easing.cubic.out,_moveMainScroll,function(){_stopAllAnimations();_mainScrollAnimating=false;_currZoomedItemIndex=-1;if(itemChanged||_currZoomedItemIndex!==_currentItemIndex){self.updateCurrItem();}
_shout('mainScrollAnimComplete');});if(itemChanged){self.updateCurrItem(true);}
return itemChanged;},_calculateZoomLevel=function(touchesDistance){return 1/_startPointsDistance*touchesDistance*_startZoomLevel;},_completeZoomGesture=function(){var destZoomLevel=_currZoomLevel,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(_currZoomLevel<minZoomLevel){destZoomLevel=minZoomLevel;}else if(_currZoomLevel>maxZoomLevel){destZoomLevel=maxZoomLevel;}
var destOpacity=1,onUpdate,initialOpacity=_bgOpacity;if(_opacityChanged&&!_isZoomingIn&&!_wasOverInitialZoom&&_currZoomLevel<minZoomLevel){self.close();return true;}
if(_opacityChanged){onUpdate=function(now){_applyBgOpacity((destOpacity-initialOpacity)*now+initialOpacity);};}
self.zoomTo(destZoomLevel,0,200,framework.easing.cubic.out,onUpdate);return true;};_registerModule('Gestures',{publicMethods:{initGestures:function(){var addEventNames=function(pref,down,move,up,cancel){_dragStartEvent=pref+down;_dragMoveEvent=pref+move;_dragEndEvent=pref+up;if(cancel){_dragCancelEvent=pref+cancel;}else{_dragCancelEvent='';}};_pointerEventEnabled=_features.pointerEvent;if(_pointerEventEnabled&&_features.touch){_features.touch=false;}
if(_pointerEventEnabled){if(navigator.pointerEnabled){addEventNames('pointer','down','move','up','cancel');}else{addEventNames('MSPointer','Down','Move','Up','Cancel');}}else if(_features.touch){addEventNames('touch','start','move','end','cancel');_likelyTouchDevice=true;}else{addEventNames('mouse','down','move','up');}
_upMoveEvents=_dragMoveEvent+' '+_dragEndEvent+' '+_dragCancelEvent;_downEvents=_dragStartEvent;if(_pointerEventEnabled&&!_likelyTouchDevice){_likelyTouchDevice=(navigator.maxTouchPoints>1)||(navigator.msMaxTouchPoints>1);}
self.likelyTouchDevice=_likelyTouchDevice;_globalEventHandlers[_dragStartEvent]=_onDragStart;_globalEventHandlers[_dragMoveEvent]=_onDragMove;_globalEventHandlers[_dragEndEvent]=_onDragRelease;if(_dragCancelEvent){_globalEventHandlers[_dragCancelEvent]=_globalEventHandlers[_dragEndEvent];}
if(_features.touch){_downEvents+=' mousedown';_upMoveEvents+=' mousemove mouseup';_globalEventHandlers.mousedown=_globalEventHandlers[_dragStartEvent];_globalEventHandlers.mousemove=_globalEventHandlers[_dragMoveEvent];_globalEventHandlers.mouseup=_globalEventHandlers[_dragEndEvent];}
if(!_likelyTouchDevice){_options.allowPanToNext=false;}}}});var _showOrHideTimeout,_showOrHide=function(item,img,out,completeFn){if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout);}
_initialZoomRunning=true;_initialContentSet=true;var thumbBounds;if(item.initialLayout){thumbBounds=item.initialLayout;item.initialLayout=null;}else{thumbBounds=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex);}
var duration=out?_options.hideAnimationDuration:_options.showAnimationDuration;var onComplete=function(){_stopAnimation('initialZoom');if(!out){_applyBgOpacity(1);if(img){img.style.display='block';}
framework.addClass(template,'pswp--animated-in');_shout('initialZoom'+(out?'OutEnd':'InEnd'));}else{self.template.removeAttribute('style');self.bg.removeAttribute('style');}
if(completeFn){completeFn();}
_initialZoomRunning=false;};if(!duration||!thumbBounds||thumbBounds.x===undefined){_shout('initialZoom'+(out?'Out':'In'));_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();template.style.opacity=out?0:1;_applyBgOpacity(1);if(duration){setTimeout(function(){onComplete();},duration);}else{onComplete();}
return;}
var startAnimation=function(){var closeWithRaf=_closedByScroll,fadeEverything=!self.currItem.src||self.currItem.loadError||_options.showHideOpacity;if(item.miniImg){item.miniImg.style.webkitBackfaceVisibility='hidden';}
if(!out){_currZoomLevel=thumbBounds.w/item.w;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_initalWindowScrollY;self[fadeEverything?'template':'bg'].style.opacity=0.001;_applyCurrentZoomPan();}
_registerStartAnimation('initialZoom');if(out&&!closeWithRaf){framework.removeClass(template,'pswp--animated-in');}
if(fadeEverything){if(out){framework[(closeWithRaf?'remove':'add')+'Class'](template,'pswp--animate_opacity');}else{setTimeout(function(){framework.addClass(template,'pswp--animate_opacity');},30);}}
_showOrHideTimeout=setTimeout(function(){_shout('initialZoom'+(out?'Out':'In'));if(!out){_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();_applyBgOpacity(1);if(fadeEverything){template.style.opacity=1;}else{_applyBgOpacity(1);}
_showOrHideTimeout=setTimeout(onComplete,duration+20);}else{var destZoomLevel=thumbBounds.w/item.w,initialPanOffset={x:_panOffset.x,y:_panOffset.y},initialZoomLevel=_currZoomLevel,initalBgOpacity=_bgOpacity,onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_currentWindowScrollY;}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(thumbBounds.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(thumbBounds.y-_currentWindowScrollY-initialPanOffset.y)*now+initialPanOffset.y;}
_applyCurrentZoomPan();if(fadeEverything){template.style.opacity=1-now;}else{_applyBgOpacity(initalBgOpacity-now*initalBgOpacity);}};if(closeWithRaf){_animateProp('initialZoom',0,1,duration,framework.easing.cubic.out,onUpdate,onComplete);}else{onUpdate(1);_showOrHideTimeout=setTimeout(onComplete,duration+20);}}},out?25:90);};startAnimation();};var _items,_tempPanAreaSize={},_imagesToAppendPool=[],_initialContentSet,_initialZoomRunning,_controllerDefaultOptions={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:false,preload:[1,1],getNumItemsFn:function(){return _items.length;}};var _getItemAt,_getNumItems,_initialIsLoop,_getZeroBounds=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}};},_calculateSingleItemPanBounds=function(item,realPanElementW,realPanElementH){var bounds=item.bounds;bounds.center.x=Math.round((_tempPanAreaSize.x-realPanElementW)/2);bounds.center.y=Math.round((_tempPanAreaSize.y-realPanElementH)/2)+item.vGap.top;bounds.max.x=(realPanElementW>_tempPanAreaSize.x)?Math.round(_tempPanAreaSize.x-realPanElementW):bounds.center.x;bounds.max.y=(realPanElementH>_tempPanAreaSize.y)?Math.round(_tempPanAreaSize.y-realPanElementH)+item.vGap.top:bounds.center.y;bounds.min.x=(realPanElementW>_tempPanAreaSize.x)?0:bounds.center.x;bounds.min.y=(realPanElementH>_tempPanAreaSize.y)?item.vGap.top:bounds.center.y;},_calculateItemSize=function(item,viewportSize,zoomLevel){if(item.src&&!item.loadError){var isInitial=!zoomLevel;if(isInitial){if(!item.vGap){item.vGap={top:0,bottom:0};}
_shout('parseVerticalMargin',item);}
_tempPanAreaSize.x=viewportSize.x;_tempPanAreaSize.y=viewportSize.y-item.vGap.top-item.vGap.bottom;if(isInitial){var hRatio=_tempPanAreaSize.x/item.w;var vRatio=_tempPanAreaSize.y/item.h;item.fitRatio=hRatio<vRatio?hRatio:vRatio;var scaleMode=_options.scaleMode;if(scaleMode==='orig'){zoomLevel=1;}else if(scaleMode==='fit'){zoomLevel=item.fitRatio;}
if(zoomLevel>1){zoomLevel=1;}
item.initialZoomLevel=zoomLevel;if(!item.bounds){item.bounds=_getZeroBounds();}}
if(!zoomLevel){return;}
_calculateSingleItemPanBounds(item,item.w*zoomLevel,item.h*zoomLevel);if(isInitial&&zoomLevel===item.initialZoomLevel){item.initialPosition=item.bounds.center;}
return item.bounds;}else{item.w=item.h=0;item.initialZoomLevel=item.fitRatio=1;item.bounds=_getZeroBounds();item.initialPosition=item.bounds.center;return item.bounds;}},_appendImage=function(index,item,baseDiv,img,preventAnimation,keepPlaceholder){if(item.loadError){return;}
if(img){item.imageAppended=true;_setImageSize(item,img,(item===self.currItem&&_renderMaxResolution));baseDiv.appendChild(img);if(keepPlaceholder){setTimeout(function(){if(item&&item.loaded&&item.placeholder){item.placeholder.style.display='none';item.placeholder=null;}},500);}}},_preloadImage=function(item){item.loading=true;item.loaded=false;var img=item.img=framework.createEl('pswp__img','img');var onComplete=function(){item.loading=false;item.loaded=true;if(item.loadComplete){item.loadComplete(item);}else{item.img=null;}
img.onload=img.onerror=null;img=null;};img.onload=onComplete;img.onerror=function(){item.loadError=true;onComplete();};img.src=item.src;return img;},_checkForError=function(item,cleanUp){if(item.src&&item.loadError&&item.container){if(cleanUp){item.container.innerHTML='';}
item.container.innerHTML=_options.errorMsg.replace('%url%',item.src);return true;}},_setImageSize=function(item,img,maxRes){if(!item.src){return;}
if(!img){img=item.container.lastChild;}
var w=maxRes?item.w:Math.round(item.w*item.fitRatio),h=maxRes?item.h:Math.round(item.h*item.fitRatio);if(item.placeholder&&!item.loaded){item.placeholder.style.width=w+'px';item.placeholder.style.height=h+'px';}
img.style.width=w+'px';img.style.height=h+'px';},_appendImagesPool=function(){if(_imagesToAppendPool.length){var poolItem;for(var i=0;i<_imagesToAppendPool.length;i++){poolItem=_imagesToAppendPool[i];if(poolItem.holder.index===poolItem.index){_appendImage(poolItem.index,poolItem.item,poolItem.baseDiv,poolItem.img,false,poolItem.clearPlaceholder);}}
_imagesToAppendPool=[];}};_registerModule('Controller',{publicMethods:{lazyLoadItem:function(index){index=_getLoopedId(index);var item=_getItemAt(index);if(!item||((item.loaded||item.loading)&&!_itemsNeedUpdate)){return;}
_shout('gettingData',index,item);if(!item.src){return;}
_preloadImage(item);},initController:function(){framework.extend(_options,_controllerDefaultOptions,true);self.items=_items=items;_getItemAt=self.getItemAt;_getNumItems=_options.getNumItemsFn;_initialIsLoop=_options.loop;if(_getNumItems()<3){_options.loop=false;}
_listen('beforeChange',function(diff){var p=_options.preload,isNext=diff===null?true:(diff>=0),preloadBefore=Math.min(p[0],_getNumItems()),preloadAfter=Math.min(p[1],_getNumItems()),i;for(i=1;i<=(isNext?preloadAfter:preloadBefore);i++){self.lazyLoadItem(_currentItemIndex+i);}
for(i=1;i<=(isNext?preloadBefore:preloadAfter);i++){self.lazyLoadItem(_currentItemIndex-i);}});_listen('initialLayout',function(){self.currItem.initialLayout=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex);});_listen('mainScrollAnimComplete',_appendImagesPool);_listen('initialZoomInEnd',_appendImagesPool);_listen('destroy',function(){var item;for(var i=0;i<_items.length;i++){item=_items[i];if(item.container){item.container=null;}
if(item.placeholder){item.placeholder=null;}
if(item.img){item.img=null;}
if(item.preloader){item.preloader=null;}
if(item.loadError){item.loaded=item.loadError=false;}}
_imagesToAppendPool=null;});},getItemAt:function(index){if(index>=0){return _items[index]!==undefined?_items[index]:false;}
return false;},allowProgressiveImg:function(){return _options.forceProgressiveLoading||!_likelyTouchDevice||_options.mouseUsed||screen.width>1200;},setContent:function(holder,index){if(_options.loop){index=_getLoopedId(index);}
var prevItem=self.getItemAt(holder.index);if(prevItem){prevItem.container=null;}
var item=self.getItemAt(index),img;if(!item){holder.el.innerHTML='';return;}
_shout('gettingData',index,item);holder.index=index;holder.item=item;var baseDiv=item.container=framework.createEl('pswp__zoom-wrap');if(!item.src&&item.html){if(item.html.tagName){baseDiv.appendChild(item.html);}else{baseDiv.innerHTML=item.html;}}
_checkForError(item);_calculateItemSize(item,_viewportSize);if(item.src&&!item.loadError&&!item.loaded){item.loadComplete=function(item){if(!_isOpen){return;}
if(holder&&holder.index===index){if(_checkForError(item,true)){item.loadComplete=item.img=null;_calculateItemSize(item,_viewportSize);_applyZoomPanToItem(item);if(holder.index===_currentItemIndex){self.updateCurrZoomItem();}
return;}
if(!item.imageAppended){if(_features.transform&&(_mainScrollAnimating||_initialZoomRunning)){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder,clearPlaceholder:true});}else{_appendImage(index,item,baseDiv,item.img,_mainScrollAnimating||_initialZoomRunning,true);}}else{if(!_initialZoomRunning&&item.placeholder){item.placeholder.style.display='none';item.placeholder=null;}}}
item.loadComplete=null;item.img=null;_shout('imageLoadComplete',index,item);};if(framework.features.transform){var placeholderClassName='pswp__img pswp__img--placeholder';placeholderClassName+=(item.msrc?'':' pswp__img--placeholder--blank');var placeholder=framework.createEl(placeholderClassName,item.msrc?'img':'');if(item.msrc){placeholder.src=item.msrc;}
_setImageSize(item,placeholder);baseDiv.appendChild(placeholder);item.placeholder=placeholder;}
if(!item.loading){_preloadImage(item);}
if(self.allowProgressiveImg()){if(!_initialContentSet&&_features.transform){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder});}else{_appendImage(index,item,baseDiv,item.img,true,true);}}}else if(item.src&&!item.loadError){img=framework.createEl('pswp__img','img');img.style.opacity=1;img.src=item.src;_setImageSize(item,img);_appendImage(index,item,baseDiv,img,true);}
if(!_initialContentSet&&index===_currentItemIndex){_currZoomElementStyle=baseDiv.style;_showOrHide(item,(img||item.img));}else{_applyZoomPanToItem(item);}
holder.el.innerHTML='';holder.el.appendChild(baseDiv);},cleanSlide:function(item){if(item.img){item.img.onload=item.img.onerror=null;}
item.loaded=item.loading=item.img=item.imageAppended=false;}}});var tapTimer,tapReleasePoint={},_dispatchTapEvent=function(origEvent,releasePoint,pointerType){var e=document.createEvent('CustomEvent'),eDetail={origEvent:origEvent,target:origEvent.target,releasePoint:releasePoint,pointerType:pointerType||'touch'};e.initCustomEvent('pswpTap',true,true,eDetail);origEvent.target.dispatchEvent(e);};_registerModule('Tap',{publicMethods:{initTap:function(){_listen('firstTouchStart',self.onTapStart);_listen('touchRelease',self.onTapRelease);_listen('destroy',function(){tapReleasePoint={};tapTimer=null;});},onTapStart:function(touchList){if(touchList.length>1){clearTimeout(tapTimer);tapTimer=null;}},onTapRelease:function(e,releasePoint){if(!releasePoint){return;}
if(!_moved&&!_isMultitouch&&!_numAnimations){var p0=releasePoint;if(tapTimer){clearTimeout(tapTimer);tapTimer=null;if(_isNearbyPoints(p0,tapReleasePoint)){_shout('doubleTap',p0);return;}}
if(releasePoint.type==='mouse'){_dispatchTapEvent(e,releasePoint,'mouse');return;}
var clickedTagName=e.target.tagName.toUpperCase();if(clickedTagName==='BUTTON'||framework.hasClass(e.target,'pswp__single-tap')){_dispatchTapEvent(e,releasePoint);return;}
_equalizePoints(tapReleasePoint,p0);tapTimer=setTimeout(function(){_dispatchTapEvent(e,releasePoint);tapTimer=null;},300);}}}});var _wheelDelta;_registerModule('DesktopZoom',{publicMethods:{initDesktopZoom:function(){if(_oldIE){return;}
if(_likelyTouchDevice){_listen('mouseUsed',function(){self.setupDesktopZoom();});}else{self.setupDesktopZoom(true);}},setupDesktopZoom:function(onInit){_wheelDelta={};var events='wheel mousewheel DOMMouseScroll';_listen('bindEvents',function(){framework.bind(template,events,self.handleMouseWheel);});_listen('unbindEvents',function(){if(_wheelDelta){framework.unbind(template,events,self.handleMouseWheel);}});self.mouseZoomedIn=false;var hasDraggingClass,updateZoomable=function(){if(self.mouseZoomedIn){framework.removeClass(template,'pswp--zoomed-in');self.mouseZoomedIn=false;}
if(_currZoomLevel<1){framework.addClass(template,'pswp--zoom-allowed');}else{framework.removeClass(template,'pswp--zoom-allowed');}
removeDraggingClass();},removeDraggingClass=function(){if(hasDraggingClass){framework.removeClass(template,'pswp--dragging');hasDraggingClass=false;}};_listen('resize',updateZoomable);_listen('afterChange',updateZoomable);_listen('pointerDown',function(){if(self.mouseZoomedIn){hasDraggingClass=true;framework.addClass(template,'pswp--dragging');}});_listen('pointerUp',removeDraggingClass);if(!onInit){updateZoomable();}},handleMouseWheel:function(e){if(_currZoomLevel<=self.currItem.fitRatio){if(_options.modal){if(!_options.closeOnScroll||_numAnimations||_isDragging){e.preventDefault();}else if(_transformKey&&Math.abs(e.deltaY)>2){_closedByScroll=true;self.close();}}
return true;}
e.stopPropagation();_wheelDelta.x=0;if('deltaX'in e){if(e.deltaMode===1){_wheelDelta.x=e.deltaX*18;_wheelDelta.y=e.deltaY*18;}else{_wheelDelta.x=e.deltaX;_wheelDelta.y=e.deltaY;}}else if('wheelDelta'in e){if(e.wheelDeltaX){_wheelDelta.x=-0.16*e.wheelDeltaX;}
if(e.wheelDeltaY){_wheelDelta.y=-0.16*e.wheelDeltaY;}else{_wheelDelta.y=-0.16*e.wheelDelta;}}else if('detail'in e){_wheelDelta.y=e.detail;}else{return;}
_calculatePanBounds(_currZoomLevel,true);var newPanX=_panOffset.x-_wheelDelta.x,newPanY=_panOffset.y-_wheelDelta.y;if(_options.modal||(newPanX<=_currPanBounds.min.x&&newPanX>=_currPanBounds.max.x&&newPanY<=_currPanBounds.min.y&&newPanY>=_currPanBounds.max.y)){e.preventDefault();}
self.panTo(newPanX,newPanY);},toggleDesktopZoom:function(centerPoint){centerPoint=centerPoint||{x:_viewportSize.x/2+_offset.x,y:_viewportSize.y/2+_offset.y};var doubleTapZoomLevel=_options.getDoubleTapZoom(true,self.currItem);var zoomOut=_currZoomLevel===doubleTapZoomLevel;self.mouseZoomedIn=!zoomOut;self.zoomTo(zoomOut?self.currItem.initialZoomLevel:doubleTapZoomLevel,centerPoint,333);framework[(!zoomOut?'add':'remove')+'Class'](template,'pswp--zoomed-in');}}});var _historyDefaultOptions={history:true,galleryUID:1};var _historyUpdateTimeout,_hashChangeTimeout,_hashAnimCheckTimeout,_hashChangedByScript,_hashChangedByHistory,_hashReseted,_initialHash,_historyChanged,_closedFromURL,_urlChangedOnce,_windowLoc,_supportsPushState,_getHash=function(){return _windowLoc.hash.substring(1);},_cleanHistoryTimeouts=function(){if(_historyUpdateTimeout){clearTimeout(_historyUpdateTimeout);}
if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout);}},_parseItemIndexFromURL=function(){var hash=_getHash(),params={};if(hash.length<5){return params;}
var i,vars=hash.split('&');for(i=0;i<vars.length;i++){if(!vars[i]){continue;}
var pair=vars[i].split('=');if(pair.length<2){continue;}
params[pair[0]]=pair[1];}
if(_options.galleryPIDs){var searchfor=params.pid;params.pid=0;for(i=0;i<_items.length;i++){if(_items[i].pid===searchfor){params.pid=i;break;}}}else{params.pid=parseInt(params.pid,10)-1;}
if(params.pid<0){params.pid=0;}
return params;},_updateHash=function(){if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout);}
if(_numAnimations||_isDragging){_hashAnimCheckTimeout=setTimeout(_updateHash,500);return;}
if(_hashChangedByScript){clearTimeout(_hashChangeTimeout);}else{_hashChangedByScript=true;}
var pid=(_currentItemIndex+1);var item=_getItemAt(_currentItemIndex);if(item.hasOwnProperty('pid')){pid=item.pid;}
var newHash=_initialHash+'&'+'gid='+_options.galleryUID+'&'+'pid='+pid;if(!_historyChanged){if(_windowLoc.hash.indexOf(newHash)===-1){_urlChangedOnce=true;}}
var newURL=_windowLoc.href.split('#')[0]+'#'+newHash;if(_supportsPushState){if('#'+newHash!==window.location.hash){history[_historyChanged?'replaceState':'pushState']('',document.title,newURL);}}else{if(_historyChanged){_windowLoc.replace(newURL);}else{_windowLoc.hash=newHash;}}
_historyChanged=true;_hashChangeTimeout=setTimeout(function(){_hashChangedByScript=false;},60);};_registerModule('History',{publicMethods:{initHistory:function(){framework.extend(_options,_historyDefaultOptions,true);if(!_options.history){return;}
_windowLoc=window.location;_urlChangedOnce=false;_closedFromURL=false;_historyChanged=false;_initialHash=_getHash();_supportsPushState=('pushState'in history);if(_initialHash.indexOf('gid=')>-1){_initialHash=_initialHash.split('&gid=')[0];_initialHash=_initialHash.split('?gid=')[0];}
_listen('afterChange',self.updateURL);_listen('unbindEvents',function(){framework.unbind(window,'hashchange',self.onHashChange);});var returnToOriginal=function(){_hashReseted=true;if(!_closedFromURL){if(_urlChangedOnce){history.back();}else{if(_initialHash){_windowLoc.hash=_initialHash;}else{if(_supportsPushState){history.pushState('',document.title,_windowLoc.pathname+_windowLoc.search);}else{_windowLoc.hash='';}}}}
_cleanHistoryTimeouts();};_listen('unbindEvents',function(){if(_closedByScroll){returnToOriginal();}});_listen('destroy',function(){if(!_hashReseted){returnToOriginal();}});_listen('firstUpdate',function(){_currentItemIndex=_parseItemIndexFromURL().pid;});var index=_initialHash.indexOf('pid=');if(index>-1){_initialHash=_initialHash.substring(0,index);if(_initialHash.slice(-1)==='&'){_initialHash=_initialHash.slice(0,-1);}}
setTimeout(function(){if(_isOpen){framework.bind(window,'hashchange',self.onHashChange);}},40);},onHashChange:function(){if(_getHash()===_initialHash){_closedFromURL=true;self.close();return;}
if(!_hashChangedByScript){_hashChangedByHistory=true;self.goTo(_parseItemIndexFromURL().pid);_hashChangedByHistory=false;}},updateURL:function(){_cleanHistoryTimeouts();if(_hashChangedByHistory){return;}
if(!_historyChanged){_updateHash();}else{_historyUpdateTimeout=setTimeout(_updateHash,800);}}}});framework.extend(self,publicMethods);};return PhotoSwipe;});(function(root,factory){if(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.PhotoSwipeUI_Default=factory();}})(this,function(){'use strict';var PhotoSwipeUI_Default=function(pswp,framework){var ui=this;var _overlayUIUpdated=false,_controlsVisible=true,_fullscrenAPI,_controls,_captionContainer,_fakeCaptionContainer,_indexIndicator,_shareButton,_shareModal,_shareModalHidden=true,_initalCloseOnScrollValue,_isIdle,_listen,_loadingIndicator,_loadingIndicatorHidden,_loadingIndicatorTimeout,_galleryHasOneSlide,_options,_defaultUIOptions={barsSize:{top:44,bottom:'auto'},closeElClasses:['item','caption','zoom-wrap','ui','top-bar'],timeToIdle:4000,timeToIdleOutside:1000,loadingIndicatorDelay:1000,addCaptionHTMLFn:function(item,captionEl){if(!item.title){captionEl.children[0].innerHTML='';return false;}
captionEl.children[0].innerHTML=item.title;return true;},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:'facebook',label:'Share on Facebook',url:'https://www.facebook.com/sharer/sharer.php?u={{url}}'},{id:'twitter',label:'Tweet',url:'https://twitter.com/intent/tweet?text={{text}}&url={{url}}'},{id:'pinterest',label:'Pin it',url:'http://www.pinterest.com/pin/create/button/'+'?url={{url}}&media={{image_url}}&description={{text}}'},{id:'download',label:'Download image',url:'{{raw_image_url}}',download:true}],getImageURLForShare:function(){return pswp.currItem.src||'';},getPageURLForShare:function(){return window.location.href;},getTextForShare:function(){return pswp.currItem.title||'';},getShareUrl:function(){return(pswp.currItem.shareUrl+'/')||'';},getShareHeadline:function(){return pswp.currItem.shareHeadline||'';},getShortUrl:function(){return pswp.currItem.shortUrl||'';},getShareSummary:function(){return pswp.currItem.shareSummary||'';},getShareMainMediaUrl:function(){return pswp.currItem.imageUrl||'';},indexIndicatorSep:' / ',fitControlsWidth:1200},_blockControlsTap,_blockControlsTapTimeout;var _onControlsTap=function(e){if(_blockControlsTap){return true;}
e=e||window.event;if(_options.timeToIdle&&_options.mouseUsed&&!_isIdle){_onIdleMouseMove();}
var target=e.target||e.srcElement,uiElement,clickedClass=target.getAttribute('class')||'',found;for(var i=0;i<_uiElements.length;i++){uiElement=_uiElements[i];if(uiElement.onTap&&clickedClass.indexOf('pswp__'+uiElement.name)>-1){uiElement.onTap();found=true;}}
if(found){if(e.stopPropagation){e.stopPropagation();}
_blockControlsTap=true;var tapDelay=framework.features.isOldAndroid?600:30;_blockControlsTapTimeout=setTimeout(function(){_blockControlsTap=false;},tapDelay);}},_fitControlsInViewport=function(){return!pswp.likelyTouchDevice||_options.mouseUsed||screen.width>_options.fitControlsWidth;},_togglePswpClass=function(el,cName,add){framework[(add?'add':'remove')+'Class'](el,'pswp__'+cName);},_countNumItems=function(){var hasOneSlide=(_options.getNumItemsFn()===1);if(hasOneSlide!==_galleryHasOneSlide){_togglePswpClass(_controls,'ui--one-slide',hasOneSlide);_galleryHasOneSlide=hasOneSlide;}},_toggleShareModalClass=function(){_togglePswpClass(_shareModal,'share-modal--hidden',_shareModalHidden);},_toggleShareModal=function(){_shareModalHidden=!_shareModalHidden;if(!_shareModalHidden){_toggleShareModalClass();setTimeout(function(){if(!_shareModalHidden){framework.addClass(_shareModal,'pswp__share-modal--fade-in');}},30);}else{framework.removeClass(_shareModal,'pswp__share-modal--fade-in');setTimeout(function(){if(_shareModalHidden){_toggleShareModalClass();}},300);}
if(!_shareModalHidden){_updateShareURLs();}
return false;},_openWindowPopup=function(e){e=e||window.event;var target=e.target||e.srcElement;pswp.shout('shareLinkClick',e,target);if(!target.href){return false;}
if(target.hasAttribute('download')){return true;}
window.open(target.href,'pswp_share','scrollbars=yes,resizable=yes,toolbar=no,'+'location=yes,width=550,height=420,top=100,left='+
(window.screen?Math.round(screen.width/2-275):100));if(!_shareModalHidden){_toggleShareModal();}
return false;},_updateShareURLs=function(){var shareButtonOut='',shareButtonData,shareURL,image_url,page_url,share_text;var shareObj={},shareUrl,shareHeadline,shortUrl,shareSummary,shareMainMediaUrl;for(var i=0;i<_options.shareButtons.length;i++){shareButtonData=_options.shareButtons[i];image_url=_options.getImageURLForShare(shareButtonData);page_url=_options.getPageURLForShare(shareButtonData);share_text=_options.getTextForShare(shareButtonData);shareUrl=_options.getShareUrl(shareButtonData);shareHeadline=_options.getShareHeadline(shareButtonData);shortUrl=_options.getShortUrl(shareButtonData);shareSummary=_options.getShareSummary(shareButtonData);shareMainMediaUrl=_options.getShareMainMediaUrl(shareButtonData);shareObj.shareUrl=shareURL=shareButtonData.shareUrl.replace('{{shareUrl}}',shareUrl);shareObj.shareHeadline=shareHeadline=shareButtonData.shareHeadline.replace('{{shareHeadline}}',shareHeadline);shareObj.shortUrl=shortUrl=shareButtonData.shortUrl.replace('{{shortUrl}}',shortUrl);shareObj.shareSummary=shareSummary=shareButtonData.shareSummary.replace('{{shareSummary}}',shareSummary);shareObj.shareMainMediaUrl=shareMainMediaUrl=shareButtonData.shareMainMediaUrl.replace('{{shareMainMediaUrl}}',shareMainMediaUrl);if(_options.parseShareButtonOut){shareButtonOut=_options.parseShareButtonOut(shareButtonData,shareButtonOut,shareObj);}}
jQuery(_shareModal.children[0]).empty()
jQuery(_shareModal.children[0]).append(shareButtonOut)},_hasCloseClass=function(target){for(var i=0;i<_options.closeElClasses.length;i++){if(framework.hasClass(target,'pswp__'+_options.closeElClasses[i])){return true;}}},_idleInterval,_idleTimer,_idleIncrement=0,_onIdleMouseMove=function(){clearTimeout(_idleTimer);_idleIncrement=0;if(_isIdle){ui.setIdle(false);}},_onMouseLeaveWindow=function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(!from||from.nodeName==='HTML'){clearTimeout(_idleTimer);_idleTimer=setTimeout(function(){ui.setIdle(true);},_options.timeToIdleOutside);}},_setupFullscreenAPI=function(){if(_options.fullscreenEl&&!framework.features.isOldAndroid){if(!_fullscrenAPI){_fullscrenAPI=ui.getFullscreenAPI();}
if(_fullscrenAPI){framework.bind(document,_fullscrenAPI.eventK,ui.updateFullscreen);ui.updateFullscreen();framework.addClass(pswp.template,'pswp--supports-fs');}else{framework.removeClass(pswp.template,'pswp--supports-fs');}}},_setupLoadingIndicator=function(){if(_options.preloaderEl){_toggleLoadingIndicator(true);_listen('beforeChange',function(){clearTimeout(_loadingIndicatorTimeout);_loadingIndicatorTimeout=setTimeout(function(){if(pswp.currItem&&pswp.currItem.loading){if(!pswp.allowProgressiveImg()||(pswp.currItem.img&&!pswp.currItem.img.naturalWidth)){_toggleLoadingIndicator(false);}}else{_toggleLoadingIndicator(true);}},_options.loadingIndicatorDelay);});_listen('imageLoadComplete',function(index,item){if(pswp.currItem===item){_toggleLoadingIndicator(true);}});}},_toggleLoadingIndicator=function(hide){if(_loadingIndicatorHidden!==hide){_togglePswpClass(_loadingIndicator,'preloader--active',!hide);_loadingIndicatorHidden=hide;}},_applyNavBarGaps=function(item){var gap=item.vGap;if(_fitControlsInViewport()){var bars=_options.barsSize;if(_options.captionEl&&bars.bottom==='auto'){if(!_fakeCaptionContainer){_fakeCaptionContainer=framework.createEl('pswp__caption pswp__caption--fake');_fakeCaptionContainer.appendChild(framework.createEl('pswp__caption__center'));_controls.insertBefore(_fakeCaptionContainer,_captionContainer);framework.addClass(_controls,'pswp__ui--fit');}
if(_options.addCaptionHTMLFn(item,_fakeCaptionContainer,true)){var captionSize=_fakeCaptionContainer.clientHeight;gap.bottom=parseInt(captionSize,10)||44;}else{gap.bottom=bars.top;}}else{gap.bottom=bars.bottom==='auto'?0:bars.bottom;}
gap.top=bars.top;}else{gap.top=gap.bottom=0;}},_setupIdle=function(){if(_options.timeToIdle){_listen('mouseUsed',function(){framework.bind(document,'mousemove',_onIdleMouseMove);framework.bind(document,'mouseout',_onMouseLeaveWindow);_idleInterval=setInterval(function(){_idleIncrement++;if(_idleIncrement===2){ui.setIdle(true);}},_options.timeToIdle/2);});}},_setupHidingControlsDuringGestures=function(){_listen('onVerticalDrag',function(now){if(_controlsVisible&&now<0.95){ui.hideControls();}else if(!_controlsVisible&&now>=0.95){ui.showControls();}});var pinchControlsHidden;_listen('onPinchClose',function(now){if(_controlsVisible&&now<0.9){ui.hideControls();pinchControlsHidden=true;}else if(pinchControlsHidden&&!_controlsVisible&&now>0.9){ui.showControls();}});_listen('zoomGestureEnded',function(){pinchControlsHidden=false;if(pinchControlsHidden&&!_controlsVisible){ui.showControls();}});};var _uiElements=[{name:'caption',option:'captionEl',onInit:function(el){_captionContainer=el;}},{name:'share-modal',option:'shareEl',onInit:function(el){_shareModal=el;},onTap:function(){_toggleShareModal();}},{name:'button--share',option:'shareEl',onInit:function(el){_shareButton=el;},onTap:function(){_toggleShareModal();}},{name:'button--zoom',option:'zoomEl',onTap:pswp.toggleDesktopZoom},{name:'counter',option:'counterEl',onInit:function(el){_indexIndicator=el;}},{name:'button--close',option:'closeEl',onTap:pswp.close},{name:'button--arrow--left',option:'arrowEl',onTap:pswp.prev},{name:'button--arrow--right',option:'arrowEl',onTap:pswp.next},{name:'button--fs',option:'fullscreenEl',onTap:function(){if(_fullscrenAPI.isFullscreen()){_fullscrenAPI.exit();}else{_fullscrenAPI.enter();}}},{name:'preloader',option:'preloaderEl',onInit:function(el){_loadingIndicator=el;}}];var _setupUIElements=function(){var item,classAttr,uiElement;var loopThroughChildElements=function(sChildren){if(!sChildren){return;}
var l=sChildren.length;for(var i=0;i<l;i++){item=sChildren[i];classAttr=item.className;for(var a=0;a<_uiElements.length;a++){uiElement=_uiElements[a];if(classAttr.indexOf('pswp__'+uiElement.name)>-1){if(_options[uiElement.option]){framework.removeClass(item,'pswp__element--disabled');if(uiElement.onInit){uiElement.onInit(item);}}else{framework.addClass(item,'pswp__element--disabled');}}}}};loopThroughChildElements(_controls.children);var topBar=framework.getChildByClass(_controls,'pswp__top-bar');if(topBar){loopThroughChildElements(topBar.children);}};ui.init=function(){framework.extend(pswp.options,_defaultUIOptions,true);_options=pswp.options;_controls=framework.getChildByClass(pswp.scrollWrap,'pswp__ui');_listen=pswp.listen;_setupHidingControlsDuringGestures();_listen('beforeChange',ui.update);_listen('doubleTap',function(point){var initialZoomLevel=pswp.currItem.initialZoomLevel;if(pswp.getZoomLevel()!==initialZoomLevel){pswp.zoomTo(initialZoomLevel,point,333);}else{if($(pswp.container).next(".pswp__ui").find(".pswp__share-modal").is(":visible")){return;}
pswp.zoomTo(_options.getDoubleTapZoom(false,pswp.currItem),point,333);}});_listen('preventDragEvent',function(e,isDown,preventObj){var t=e.target||e.srcElement;if(t&&t.getAttribute('class')&&e.type.indexOf('mouse')>-1&&(t.getAttribute('class').indexOf('__caption')>0||(/(SMALL|STRONG|EM)/i).test(t.tagName))){preventObj.prevent=false;}});_listen('bindEvents',function(){framework.bind(_controls,'pswpTap click',_onControlsTap);framework.bind(pswp.scrollWrap,'pswpTap',ui.onGlobalTap);if(!pswp.likelyTouchDevice){framework.bind(pswp.scrollWrap,'mouseover',ui.onMouseOver);}});_listen('unbindEvents',function(){if(!_shareModalHidden){_toggleShareModal();}
if(_idleInterval){clearInterval(_idleInterval);}
framework.unbind(document,'mouseout',_onMouseLeaveWindow);framework.unbind(document,'mousemove',_onIdleMouseMove);framework.unbind(_controls,'pswpTap click',_onControlsTap);framework.unbind(pswp.scrollWrap,'pswpTap',ui.onGlobalTap);framework.unbind(pswp.scrollWrap,'mouseover',ui.onMouseOver);if(_fullscrenAPI){framework.unbind(document,_fullscrenAPI.eventK,ui.updateFullscreen);if(_fullscrenAPI.isFullscreen()){_options.hideAnimationDuration=0;_fullscrenAPI.exit();}
_fullscrenAPI=null;}});_listen('destroy',function(){if(_options.captionEl){if(_fakeCaptionContainer){_controls.removeChild(_fakeCaptionContainer);}
framework.removeClass(_captionContainer,'pswp__caption--empty');}
if(_shareModal){_shareModal.children[0].onclick=null;}
framework.removeClass(_controls,'pswp__ui--over-close');framework.addClass(_controls,'pswp__ui--hidden');ui.setIdle(false);});if(!_options.showAnimationDuration){framework.removeClass(_controls,'pswp__ui--hidden');}
_listen('initialZoomIn',function(){if(_options.showAnimationDuration){framework.removeClass(_controls,'pswp__ui--hidden');}});_listen('initialZoomOut',function(){framework.addClass(_controls,'pswp__ui--hidden');});_listen('parseVerticalMargin',_applyNavBarGaps);_setupUIElements();if(_options.shareEl&&_shareButton&&_shareModal){_shareModalHidden=true;}
_countNumItems();_setupIdle();_setupFullscreenAPI();_setupLoadingIndicator();};ui.setIdle=function(isIdle){_isIdle=isIdle;_togglePswpClass(_controls,'ui--idle',isIdle);};ui.update=function(){if(_controlsVisible&&pswp.currItem){ui.updateIndexIndicator();if(_options.captionEl){_options.addCaptionHTMLFn(pswp.currItem,_captionContainer);_togglePswpClass(_captionContainer,'caption--empty',!pswp.currItem.title);}
_overlayUIUpdated=true;}else{_overlayUIUpdated=false;}
if(!_shareModalHidden){_toggleShareModal();}
_countNumItems();};ui.updateFullscreen=function(e){if(e){setTimeout(function(){pswp.setScrollOffset(0,framework.getScrollY());},50);}
framework[(_fullscrenAPI.isFullscreen()?'add':'remove')+'Class'](pswp.template,'pswp--fs');};ui.updateIndexIndicator=function(){if(_options.counterEl){_indexIndicator.innerHTML=(pswp.getCurrentIndex()+1)+
_options.indexIndicatorSep+
_options.getNumItemsFn();}};ui.onGlobalTap=function(e){e=e||window.event;var target=e.target||e.srcElement;if(_blockControlsTap){return;}
if(e.detail&&e.detail.pointerType==='mouse'){if(_hasCloseClass(target)){pswp.close();return;}
if(framework.hasClass(target,'pswp__img')){if(pswp.getZoomLevel()===1&&pswp.getZoomLevel()<=pswp.currItem.fitRatio){if(_options.clickToCloseNonZoomable){pswp.close();}}else{pswp.toggleDesktopZoom(e.detail.releasePoint);}}}else{if(_options.tapToToggleControls){if(_controlsVisible){ui.hideControls();}else{ui.showControls();}}
if(_options.tapToClose&&(framework.hasClass(target,'pswp__img')||_hasCloseClass(target))){pswp.close();return;}}};ui.onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement;_togglePswpClass(_controls,'ui--over-close',_hasCloseClass(target));};ui.hideControls=function(){framework.addClass(_controls,'pswp__ui--hidden');_controlsVisible=false;};ui.showControls=function(){_controlsVisible=true;if(!_overlayUIUpdated){ui.update();}
framework.removeClass(_controls,'pswp__ui--hidden');};ui.supportsFullscreen=function(){var d=document;return!!(d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen);};ui.getFullscreenAPI=function(){var dE=document.documentElement,api,tF='fullscreenchange';if(dE.requestFullscreen){api={enterK:'requestFullscreen',exitK:'exitFullscreen',elementK:'fullscreenElement',eventK:tF};}else if(dE.mozRequestFullScreen){api={enterK:'mozRequestFullScreen',exitK:'mozCancelFullScreen',elementK:'mozFullScreenElement',eventK:'moz'+tF};}else if(dE.webkitRequestFullscreen){api={enterK:'webkitRequestFullscreen',exitK:'webkitExitFullscreen',elementK:'webkitFullscreenElement',eventK:'webkit'+tF};}else if(dE.msRequestFullscreen){api={enterK:'msRequestFullscreen',exitK:'msExitFullscreen',elementK:'msFullscreenElement',eventK:'MSFullscreenChange'};}
if(api){api.enter=function(){_initalCloseOnScrollValue=_options.closeOnScroll;_options.closeOnScroll=false;if(this.enterK==='webkitRequestFullscreen'){pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT);}else{return pswp.template[this.enterK]();}};api.exit=function(){_options.closeOnScroll=_initalCloseOnScrollValue;return document[this.exitK]();};api.isFullscreen=function(){return document[this.elementK];};}
return api;};};return PhotoSwipeUI_Default;});'use strict'
snaApp.directive("snaImageTeaser",['$rootScope','$interval','$timeout','$http','appConfig','$log','$window','videoPlayer','$filter',function($rootScope,$interval,$timeout,$http,appConfig,$log,$window,videoPlayer,$filter){function link(scope,element){scope.imageTeaserSupported=true;if(isIEBrowser()){scope.imageTeaserSupported=false;return;}
scope.aspectRatio=scope.aspectRatio||0.5625;scope.imageData=(typeof scope.imagesData!='undefined'&&JSON.parse(scope.imagesData))||'';scope.imageData=scope.imageData;scope.imageData.reverse();for(var i=0;i<scope.imageData.length;i++){scope.imageData[i].imageUrl=formImgUrl(scope.imageData[i].imageUrl);}
if(element.prev('img').length>0){element.prev('img').one("load",function(){$(this).addClass("no-transform hide").prev('img').css('visibility','hidden');element.parent().addClass('image-teaser-on');}).each(function(){if(this.complete)$(this).load();});}
addAnimCss(4.4,1.6,scope.imageData.length,scope.contentId);function formImgUrl(imageUrl){if(scope.viewportWidth){return $filter('imageAdvFilter')(imageUrl,JSON.parse(scope.viewportWidth),scope.aspectRatio);}else{return $filter('imagefilter')(imageUrl,400,scope.aspectRatio);}}}
return{restrict:'E',scope:{imagesData:'@',aspectRatio:'@',contentId:'@',viewportWidth:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaImageTeaser.html"}
function addAnimCss(a,b,n,contentId){var a_val=parseFloat(a);var b_val=parseFloat(b);var n_val=parseInt(n);var single_time=a_val+b_val;var total_time=single_time*n_val;var keyframes_percent=["0%",null,null,null,"100%"];keyframes_percent[1]=(a_val/total_time*100);keyframes_percent[2]=((a_val+b_val)/total_time*100);keyframes_percent[3]=(100-(b_val/total_time*100));keyframes_percent[1]=keyframes_percent[1]+"%";keyframes_percent[2]=keyframes_percent[2]+"%";keyframes_percent[3]=keyframes_percent[3]+"%";var animDelaySingleTmpl;var animDelayCssTmpl='';var animName="FadeInOut"+contentId;var cssRulesToBeAdded='';var scaleFactor=1.3;if($rootScope.device=='MOBILE'){scaleFactor=1.5;}
var animOnCssTmpl=".image-teaser-on #img-teaser-"+contentId+" .single-img-preview {-webkit-animation-name: "+animName+"; animation-name: "+animName+"; -webkit-animation-duration: "+(total_time)+"s; animation-duration: "+(total_time)+"s; }"
var keyframeCssTmpl="@-webkit-keyframes "+animName+" {"+keyframes_percent[0]+" {opacity: 1; -webkit-transform: scale(1); transform: scale(1); } "+keyframes_percent[1]+" {opacity: 1; -webkit-transform: scale("+(1+((scaleFactor-1)/2))+"); transform: scale("+(1+((scaleFactor-1)/2))+"); } "+keyframes_percent[2]+" {opacity: 0; -webkit-transform: scale("+(scaleFactor)+"); transform: scale("+(scaleFactor)+"); } "+keyframes_percent[3]+" {opacity: 0; -webkit-transform: scale(1); transform: scale(1); } "+keyframes_percent[4]+" {opacity: 1; -webkit-transform: scale(1); transform: scale(1); } } @keyframes  "+animName+"  {"+keyframes_percent[0]+" {opacity: 1; -webkit-transform: scale(1); transform: scale(1); } "+keyframes_percent[1]+" {opacity: 1; -webkit-transform: scale("+(1+((scaleFactor-1)/2))+"); transform: scale("+(1+((scaleFactor-1)/2))+"); } "+keyframes_percent[2]+" {opacity: 0; -webkit-transform: scale("+(scaleFactor)+"); transform: scale("+(scaleFactor)+"); } "+keyframes_percent[3]+" {opacity: 0; -webkit-transform: scale(1); transform: scale(1); } "+keyframes_percent[4]+" {opacity: 1; -webkit-transform: scale(1); transform: scale(1); } }";var startDelay;if(isSafari()){startDelay=3;}else{startDelay=0;}
for(var i=0;i<n_val;i++){animDelaySingleTmpl='';animDelaySingleTmpl=".image-teaser-on #img-teaser-"+contentId+" .single-img-preview:nth-of-type("+(i+1)+") { -webkit-animation-delay: "+(total_time-((i+1)*single_time)+startDelay)+"s; animation-delay: "+(total_time-((i+1)*single_time)+startDelay)+"s; }"
animDelayCssTmpl+=animDelaySingleTmpl;}
cssRulesToBeAdded=" "+keyframeCssTmpl+animOnCssTmpl+animDelayCssTmpl;injectStyles(cssRulesToBeAdded);}
function injectStyles(rule){var div=$("<div />",{html:'&shy;<style>'+rule+'</style>'}).appendTo("body");if(isIEBrowser()){div.hide();}}
function greenSockAnim(a,b,element){var imgs=$.makeArray(element.find('.single-img-preview'))
var scaleFactor=1.3;if($rootScope.device=='MOBILE'){scaleFactor=1.5;}
var tl=new TimelineMax({repeat:-1});var crossfade=function(){tl.add("lab")
tl.to(imgs[0],1.6,{autoAlpha:0,scale:1,ease:Power0.easeNone},"lab")
tl.to(imgs[1],1.6,{autoAlpha:1,scale:1,ease:Power0.easeNone},"lab")
tl.to(imgs[1],4.4,{scale:scaleFactor,ease:Power0.easeNone})
imgs.push(imgs.shift())}
crossfade();var cycle=setInterval(crossfade,6000);}}]);"use strict"
snaApp.factory('videoPlayer',['$rootScope','appConfig','$http','$log','$sce','$filter','getDeviceOSService',function($rootScope,appConfig,$http,$log,$sce,$filter,getDeviceOSService){var make360VideoSameDomain=function(_360Videourl){_360Videourl=_360Videourl.replace(/^(https?)(\:\/\/.+\.com)/ig,function(){if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
var changedDomain=window.location.origin;return changedDomain;});return _360Videourl;};var videoPlayer=new function(){this.jwplayer=function(elementId,urls,isAndroid,autoStart,image,adTag,isYotube,tracksThumbnails,relatedVideos,jwPlayerMediaId,videoTitle,muted,videoId,currentVideoObj,isVrSupportedPlayer,viewportWidthObj){if(isVrSupportedPlayer&&currentVideoObj.is360Video){var isVrVideoSupported=true;}
var srcUrls=[];for(var i=0;i<urls.length;i++){if(isVrVideoSupported&&currentVideoObj.is360Video){urls[i].url=make360VideoSameDomain(urls[i].url);}
srcUrls.push({file:urls[i].url});}
var tracks=[];if(tracksThumbnails&&tracksThumbnails.length>0){tracks=tracksThumbnails;if(document.location.protocol=='https:'&&typeof tracks[0].file!="undefined"){tracks[0].file=tracks[0].file.replace("http://","https://");}}
var _muted=muted||false;var repeat=false;var playlist=[{id:videoId,title:videoTitle,sources:srcUrls,image:image,tracks:tracks,mediaid:jwPlayerMediaId}];if(isVrVideoSupported&&window.jwplayerVersion==8){playlist[0].stereomode='monoscopic';}
if(isVrVideoSupported){relatedVideos=relatedVideos.filter(function(video){if(!video.is360Video){return false;}
return true;});}else if(isVrSupportedPlayer&&!currentVideoObj.is360Video){relatedVideos=relatedVideos.filter(function(video){if(video.is360Video){return false;}
return true;});}
if(typeof relatedVideos!=='undefined'&&relatedVideos.length>0&&(getIEVersion()==0||getIEVersion()>9)){var relatedVideosList;repeat=true;relatedVideosList=relatedVideos.map(function(video){var srcUrlsRelated=[];for(var i=0;i<video.videoUrl.length;i++){if(isVrVideoSupported&&video.is360Video){video.videoUrl[i].url=make360VideoSameDomain(video.videoUrl[i].url);}
srcUrlsRelated.push({file:video.videoUrl[i].url})}
var imageSrc='';if(lodash.get(viewportWidthObj,"viewportWidth",false)){imageSrc="/"+$rootScope.webContext+"/images"+$filter('imageAdvFilter')(video.mediaAsset.imageUrl,viewportWidthObj.viewportWidth,0.563,lodash.get(viewportWidthObj,"noSidebar",false),lodash.get(viewportWidthObj,"maxWidthOfRoot",null),lodash.get(viewportWidthObj,"maxWidthLevel1",null));}else{imageSrc="/"+$rootScope.webContext+"/images"+$filter('imagefilter')(video.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}
var videoItem={id:video.id,title:video.headline,sources:srcUrlsRelated,image:imageSrc,mediaid:video.jwPlayerMediaId,tracks:[{file:(document.location.protocol=='https:'&&typeof video.thumbnailUrl!="undefined"?video.thumbnailUrl.replace("http://","https://"):video.thumbnailUrl),kind:"thumbnails"}],videoObj:video};if(isVrVideoSupported&&video.is360Video&&window.jwplayerVersion==8){videoItem.stereomode='monoscopic';}
return videoItem;});if(typeof relatedVideosList!=='undefined'&&relatedVideosList.length>0){playlist[0].videoObj=currentVideoObj;playlist=playlist.concat(relatedVideosList);}}
var setup={primary:getIEVersion()==9?"flash":"html5",autostart:autoStart,repeat:repeat,mute:_muted,width:'100%',height:'100%',stretching:'uniform',androidhls:!!isAndroid,localization:{nextUp:' ',},"hlshtml":true,"skin":{"url":$rootScope.appAssetsUrl+"/styles/jw-skin-sna.css","name":"seven sna"},ga:{label:"title"},}
if(isYotube){setup.playlist=[{id:videoId,title:videoTitle,image:image,file:srcUrls[0].file,tracks:tracks,mediaid:jwPlayerMediaId}];}else{setup.playlist=playlist;}
if(isVrSupportedPlayer&&currentVideoObj.is360Video&&window.jwplayerVersion==7){setup.plugins={};setup.plugins[$rootScope.appAssetsUrl+'/js/lib/jwplayer-7.8.7/plugins/vr/vr.js']={}}
if(isVrVideoSupported&&((getDeviceOSService.isWindows&&isFirefox())||(isAndroidOS()&&isFirefox()))){setup.autostart=false;$(".win-and-ff-360-banner").show();}else{$(".win-and-ff-360-banner").hide();}
var player=jwplayer(elementId).setup(setup);player.on('pause',function(){this.pause(true);});player.on('play',function(event){if(event&&event.playReason=='interaction'){this.autoplay=false;}
if(this&&this.autoplay){return;}
if(this.snaPaused){this.pause(true);return;}else if(window.activeJWPlayer&&this&&window.activeJWPlayer.id!=this.id){if(window.activeJWPlayer.getState().toLowerCase()=='buffering'){window.activeJWPlayer.snaPaused=true;}
window.activeJWPlayer.pause(true);}
if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'){window.activeYtPlayer.pauseVideo();typeof window.activeYtPlayer.closeFlyout!='undefined'&&window.activeYtPlayer.closeFlyout();}
window.activeJWPlayer=this;typeof(playRadio)!='undefined'&&window.playRadio(true);if(isVrVideoSupported&&$rootScope.device=='DESKTOP'){if(isChrome()||isSafari()){$("#"+elementId+" .jw-media canvas").css("cursor","-webkit-grab")}else{$("#"+elementId+" .jw-media canvas").css("cursor","grab")}}});player.on('error',function(event){$log.error("Error playing video",event.message);});player.on('setupError',function(event){$log.error("Error setup player",event.message);});player.on('adPlay',function(){if(window.activeJWPlayer&&this&&window.activeJWPlayer.id!=this.id){window.activeJWPlayer.pause(true);}
window.activeJWPlayer=this;typeof(playRadio)!='undefined'&&window.playRadio(true);});player.on('adError',function(error){$log.error("Error loading ad",error.message);});if(typeof(screen)!='undefined'&&screen.unlockOrientation){player.on('fullscreen',function(event){if(event.fullscreen){screen.unlockOrientation();}else{screen.lockOrientation('portrait');}});}
return player;};}()
return videoPlayer;}]);'use strict'
snaApp.directive('bindHtmlCompile',['$compile',function($compile){return{restrict:'A',link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.bindHtmlCompile);},function(value){element.html(value);removeLastEmptyParagraphInArticleBody();$compile(element.contents())(scope);});function removeLastEmptyParagraphInArticleBody(){if(attrs.bindHtmlContentType=='article'){var lastParaEl=element.find("> p:last-child");var lastParaContent;if(lastParaEl&&lastParaEl.length>0){lastParaContent=lastParaEl.html().trim();var lastParaContentMatchForEmptyStrings=lastParaContent.match(/^(&nbsp;)*$/g);if(lastParaContentMatchForEmptyStrings&&lastParaContentMatchForEmptyStrings.length>0){lastParaEl.remove();}}}}}};}]);snaApp.directive("sna",['$rootScope','$interval','$timeout','$http','appConfig','$log',function($rootScope,$interval,$timeout,$http,appConfig,$log){function link(scope,element,attrs){var inlineItems=scope.$parent.inlineItems||[],inlineItem,allowPosition=scope.$parent.allowPosition,articleModal=scope.$parent.articleModal;if(typeof scope.$parent.article!="undefined"&&typeof scope.$parent.article.inlineItems!="undefined"&&Array.isArray(scope.$parent.article.inlineItems)&&scope.$parent.article.inlineItems.length>0){inlineItems=scope.$parent.article.inlineItems;}
for(var i=0;i<inlineItems.length;i++){if(attrs.refid==inlineItems[i].id){scope.inlineItem=inlineItems[i];inlineItem=inlineItems[i];break}}
var viewportWidth="";var bottomImgViewportWidth="";var nosidebar="false";var setImageGalleryViewportWidth=function(){if((!attrs.reftype.toLowerCase()=='image_gallery')||(!attrs.reftype.toLowerCase()=='video')||(!attrs.reftype.toLowerCase()=='image_set')){return;}
if(typeof scope.$parent.article!="undefined"&&location.pathname.split("/")[2].toLowerCase()=="article"){viewportWidth="[ [1, 0.66], [1, 0.83], [1, 1] ]";bottomImgViewportWidth="[ [.66, .16], [.83, .25], [1, 1] ]";}else if(typeof scope.$parent.blog!="undefined"){viewportWidth="[ [.66, 1], [.83, 1], [1, 1] ]";bottomImgViewportWidth="[ [.66, .16], [.83, .25], [1, 1] ]";}else if(typeof scope.$parent.staticPage!="undefined"){viewportWidth="[ [.75], [.66], [1] ]";bottomImgViewportWidth="[ [.75, .16], [.66, .25], [1, 1] ]";}else if(typeof scope.$parent.article!="undefined"&&location.pathname.split("/")[2].toLowerCase()=="timeline"){viewportWidth="[ [1, 0.583], [1, 0.66], [1, 1] ]";bottomImgViewportWidth="[ [.583, .16], [.66, .25], [1, 1] ]";nosidebar="true";}}
setImageGalleryViewportWidth();var flyout=scope.$parent.flyout||false;scope.flyout=flyout;if(attrs.reftype.toLowerCase()=='image_set'){scope.contentHtml="<sna-image content='inlineItem' viewport-width='{{"+viewportWidth+"}}' refid='"+attrs.refid+"'"+(allowPosition?" position='"+attrs.position+"'":"")+"></sna-image>";}else if(attrs.reftype.toLowerCase()=='video'){if(flyout){scope.contentHtml='<img src="/static/web-rev/img/default_img.jpg" style="width: 100%"/>'+'<img class="main-image article-image" data-ng-src="{{\'/web/images\' + inlineItem.mediaAsset.imageUrl | imageAdvFilter:'+viewportWidth+':0.563:'+nosidebar+'}}" style="width: 100%;position: absolute; top: 0; left:0;height: 100%" onload="showImage();" />'+"<sna-video image-gallery-on-full-page='{{"+nosidebar+"}}'  viewport-width='{{"+viewportWidth+"}}' jw-player-media-id='inlineItem.jwPlayerMediaId' autoplay='true' postLoad='false' flyout='true' content='inlineItem' refid='"+attrs.refid+"' "+(scope.$parent.prerollTag?"preroll-tag='"+scope.$parent.prerollTag+"'":"")+'></sna-video>';}else{scope.contentHtml="<sna-video image-gallery-on-full-page='{{"+nosidebar+"}}'  viewport-width='{{"+viewportWidth+"}}' jw-player-media-id='inlineItem.jwPlayerMediaId' autoplay='true' postLoad='false' flyout='"+flyout+"' content='inlineItem' refid='"+attrs.refid+"' "+(scope.$parent.prerollTag?"preroll-tag='"+scope.$parent.prerollTag+"'":"")+"></sna-video>";}}else if(attrs.reftype.toLowerCase()=='image_gallery'){scope.contentHtml="<sna-image-gallery image-gallery-on-full-page='{{"+nosidebar+"}}' bottom-img-viewport-width='{{"+bottomImgViewportWidth+"}}' viewport-width='{{"+viewportWidth+"}}' image-gallery='true' content='inlineItem' refid='"+attrs.refid+"' article-modal='"+articleModal+"' trigger-full-screen-slide-show-on-click='true'></sna-image-gallery>";}else if(attrs.reftype.toLowerCase()=='custom_html'){scope.contentHtml="<sna-custom-html content='inlineItem' refid='"+attrs.refid+"'></sna-custom-html>";}else if(attrs.reftype.toLowerCase()=='poll'){scope.contentHtml="<sna-poll content='inlineItem' refid='"+attrs.refid+"' position='"+attrs.position+"'></sna-poll>";}else if(attrs.reftype.toLowerCase()=='poll_apester'){scope.contentHtml="<sna-poll-apster content='inlineItem' refid='"+attrs.refid+"'></sna-poll-apster>";}else if(attrs.reftype.toLowerCase()=='quote'){scope.contentHtml="<sna-quote content='inlineItem' refid='"+attrs.refid+"' position='"+attrs.position+"'></sna-quote>";}else if(attrs.reftype.toLowerCase()=='youtube_video'&&!!getVideoIdFromYoutubeUrl(inlineItem.url)){scope.contentHtml="<sna-youtube-video content='inlineItem' flyout='false' one-time-bind-yt-video-id='"+getVideoIdFromYoutubeUrl(inlineItem.url)+"'></sna-youtube-video>";}}
return{restrict:'E',scope:{refid:"=refid"},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaBase.html"}}]);function getVideoIdFromYoutubeUrl(url){var regExp=/https?:\/\/www.youtube.com\/watch\?v=((?=\S)[^\&#]+)&*(\S)*/i;var result=!!regExp.exec(url)&&regExp.exec(url)[1];return result;};snaApp.directive("snaImage",['$rootScope','$interval','$timeout','$http','appConfig','$log',function($rootScope,$interval,$timeout,$http,appConfig,$log){function link(scope,element,attrs){scope.$watch("content",function(content){if(!content){return}
if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}})}
return{restrict:'E',scope:{content:'=content',viewportWidth:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaImage.html"}}]);snaApp.directive("snaImageGallery",['$rootScope','$interval','$timeout','$http','appConfig','$log','$filter','$compile',function($rootScope,$interval,$timeout,$http,appConfig,$log,$filter,$compile){function link(scope,element,attrs){var imageCount=6,subElementId,showBullets=false,elementId,afterChangeHandler,currentSlideElement,currentSlideHref,currentSlideImageId,snaImageGalleryContElem;snaImageGalleryContElem=element;scope.deviceType=$rootScope.deviceType;scope.webContext=appConfig.webContext;if(scope.$parent.imageCount){imageCount=scope.$parent.imageCount;}else if($rootScope.deviceType=='TABLET'){imageCount=4;}else if($rootScope.deviceType=='MOBILE'){imageCount=1;}
if($rootScope.deviceType=='MOBILE'){showBullets=true;}
afterChangeHandler=function(slick,currentSlide){if(typeof scope.content.type==='undefined'||scope.content.type===''){return;}
currentSlideElement=snaImageGalleryContElem.find(elementId).find("[data-slick-index='"+currentSlide.slickCurrentSlide()+"']");currentSlideHref=snaImageGalleryContElem.find(currentSlideElement).find('[data-ng-href]').attr('data-ng-href');currentSlideImageId=currentSlideHref.split("/").pop();if(!scope.content.mainMediaImageGallery){sendGAPageView(appConfig.webContext,'Image',scope.content.id,currentSlideImageId,scope.content.headline);sendFBPixelPageView();}}
scope.$watch('content',function(value){if(!scope.content){return}
blockUI($(element),true);elementId='#imageGalleryCarouselDiv'+(scope.content.id?scope.content.id:'');subElementId='#imageGalleryCarouselSyncDiv'+(scope.content.id?scope.content.id:'');$timeout(function(){snaImageGalleryContElem.find(subElementId).show();if(!snaImageGalleryContElem.find(subElementId+'.slick-initialized').length){snaImageGalleryContElem.find(subElementId).slick({rtl:true,slidesToShow:1,slidesToScroll:1,asNavFor:elementId,arrows:false,fade:true})}
if(!snaImageGalleryContElem.find(elementId+'.slick-initialized').length){snaImageGalleryContElem.find(elementId).slick({rtl:true,dots:showBullets,autoplay:false,mobileFirst:true,slidesToShow:imageCount,slidesToScroll:1,infinite:true,asNavFor:subElementId,focusOnSelect:true,centerMode:false});}
if(scope.index){snaImageGalleryContElem.find(elementId).slick('slickGoTo',parseInt(scope.index),true);snaImageGalleryContElem.find(subElementId).slick('slickGoTo',parseInt(scope.index),true);}
processDataForFullScreenViewer(scope.content,scope.content.id);$timeout(function(){snaImageGalleryContElem.children("#imageGalleryContainerDiv").css("visibility","visible");snaImageGalleryContElem.addClass("sna-initialized");$(window).trigger('resize');unblockUI($(element));},2000,false);},100,false);if(scope.index){scope.featuredImage=scope.content.images[scope.index];scope.currentImage=scope.index+1;}else{scope.featuredImage=scope.content.images[0];scope.currentImage=1;}
scope.imageCount=scope.content.images.length;});$rootScope.$watch('deviceType',function(newValue,oldValue){var deviceType=getDeviceType();scope.deviceType=deviceType;if(scope.$parent.imageCount){imageCount=scope.$parent.imageCount;}else if(deviceType=='DESKTOP'){imageCount=6;}else if(deviceType=='TABLET'){imageCount=4;}else if(deviceType=='MOBILE'){imageCount=1;}
if($rootScope.deviceType=='MOBILE'){showBullets=true;}
$timeout(function(){snaImageGalleryContElem.find(elementId+'.slick-initialized').length&&snaImageGalleryContElem.find(elementId).slick('unslick');if(!snaImageGalleryContElem.find(subElementId+'.slick-initialized').length){snaImageGalleryContElem.find(subElementId).slick({rtl:true,slidesToShow:1,slidesToScroll:1,asNavFor:elementId,arrows:false,fade:true});}
snaImageGalleryContElem.find(elementId).slick({rtl:true,dots:showBullets,autoplay:false,mobileFirst:true,slidesToShow:imageCount,slidesToScroll:1,infinite:true,asNavFor:subElementId,focusOnSelect:true,centerMode:false});if(deviceType=='MOBILE'){snaImageGalleryContElem.find(elementId).off('afterChange');snaImageGalleryContElem.find(subElementId).off('afterChange');snaImageGalleryContElem.find(elementId).on('afterChange',afterChangeHandler);}else{snaImageGalleryContElem.find(elementId).off('afterChange');snaImageGalleryContElem.find(subElementId).off('afterChange');snaImageGalleryContElem.find(subElementId).on('afterChange',afterChangeHandler);}},500);});scope.viewImage=function(image,index){scope.featuredImage=image;scope.currentImage=index+1;}
scope.goToLink=function(event,element,noFullScreenModal){var index;var onCloseFullScreenImageViewer;var onChangeScreenImageViewer;var callBacksForFullScreenImageViewer={};if((!!scope.triggerFullScreenSlideShowOnClick&&!noFullScreenModal)||(!!scope.triggerFullScreenSlideShowOnClick&&!!noFullScreenModal&&$rootScope.deviceType=='MOBILE')){index=$(event.currentTarget).data("image-index")||0;onCloseFullScreenImageViewer=function(callbackName,index,id){$rootScope[callbackName]=null;$("#imageGalleryCarouselDiv"+id+".slick-initialized").slick("slickGoTo",index,true);$("#imageGalleryCarouselSyncDiv"+id+".slick-initialized").slick("slickGoTo",index,true);}
onChangeScreenImageViewer=function(callbackName,galleryId,imageId,title){sendGAPageView(appConfig.webContext,'Image',galleryId,imageId,title);}
callBacksForFullScreenImageViewer={"onClose":onCloseFullScreenImageViewer,"onChange":onChangeScreenImageViewer};createFullScreenViewer({index:index},callBacksForFullScreenImageViewer);event&&event.preventDefault();return false;}
if(attrs.articleModal=='true'){$(event.currentTarget).attr('target','_blank');}
if($rootScope.deviceType!='MOBILE'&&element=='CAROUSEL'){event&&event.preventDefault();}
if(!scope.link&&(!scope.content||!scope.content.id||scope.content.mainMediaImageGallery)){event&&event.preventDefault();return;}else if(!scope.link){return;}
event&&event.preventDefault();if($rootScope.deviceType=='MOBILE'&&element=='CAROUSEL'){window.location.href=scope.link;}else if($rootScope.deviceType!='MOBILE'&&element=='FEATURED'){window.location.href=scope.link;}}
function processDataForFullScreenViewer(data,galleryId){var imageData=data.images;scope.fullScreenImageViewerData=[];scope.fullScreenImageViewerData=imageData.slice();galleryId=galleryId||1;var sharingBaseUrl='http://'+appConfig.sharingHost+'/image_gallery';for(var i=0;i<scope.fullScreenImageViewerData.length;i++){scope.fullScreenImageViewerData[i].w=imageWidthfoFullScreenViewer();scope.fullScreenImageViewerData[i].h=Math.round(imageWidthfoFullScreenViewer()*.5625);scope.fullScreenImageViewerData[i].title=scope.fullScreenImageViewerData[i].caption;scope.fullScreenImageViewerData[i].src=$rootScope.webHost+$rootScope.webContext+'/images'+$filter('imagefilter')(scope.fullScreenImageViewerData[i].imageUrl,scope.fullScreenImageViewerData[i].w,.5625);scope.fullScreenImageViewerData[i].pid=scope.fullScreenImageViewerData[i].id;scope.fullScreenImageViewerData[i].shortUrl=!!scope.fullScreenImageViewerData[i]&&!!scope.fullScreenImageViewerData[i].shareUrl&&encodeURI(scope.fullScreenImageViewerData[i].shareUrl);;scope.fullScreenImageViewerData[i].shareUrl=sharingBaseUrl+"/"+data.id+'/'+scope.fullScreenImageViewerData[i].id;scope.fullScreenImageViewerData[i].shareHeadline=data.headline;scope.fullScreenImageViewerData[i].shareSummary=scope.fullScreenImageViewerData[i].caption;}
scope.fullScreenImageViewerOptions=optionsForFullScreenViewer({"galleryUID":galleryId,"shareEl":(scope.content.mainMediaImageGallery?false:true)});}
function optionsForFullScreenViewer(options){var defaultOpt=scope.fullScreenImageViewerOptions||{index:0};options=options||{};options=$.extend({},defaultOpt,options);return options;}
function imageWidthfoFullScreenViewer(arguments){var width
switch(deviceType){case'DESKTOP':width=2000;break;case'TABLET':width=1600;break;case'MOBILE':width=1600;break;}
return width;}
function createFullScreenViewer(options,callBacks){scope.fullScreenImageViewerOptions=optionsForFullScreenViewer(options);var onCloseCallBack;var onChangeCallBack;$("sna-full-screen-image-viewer").each(function(index,el){$(this).remove();});onCloseCallBack=bindOnCloseEvent(scope.fullScreenImageViewerOptions,callBacks);onChangeCallBack=bindOnChangeEvent(scope.fullScreenImageViewerOptions,callBacks,scope.fullScreenImageViewerData[0]);var fullScreenImageViewerElem=angular.element('<sna-full-screen-image-viewer image-data=\''+JSON.stringify(scope.fullScreenImageViewerData)+'\' options=\''+JSON.stringify(scope.fullScreenImageViewerOptions)+'\'  on-close-callback=\''+onCloseCallBack+'\'  on-change-callback=\''+onChangeCallBack+'\'></sna-full-screen-image-viewer>');jQuery("body").append(fullScreenImageViewerElem);$compile(fullScreenImageViewerElem)($rootScope);}
function bindOnCloseEvent(options,callBacks){var onCloseCallBack;if((typeof options!='undefined')&&(typeof options.galleryUID!='undefined')&&(typeof callBacks.onClose!='undefined')){onCloseCallBack="onCloseFullScreenImageViewer"+options.galleryUID;$rootScope[onCloseCallBack]=null;$rootScope[onCloseCallBack]=callBacks.onClose;return onCloseCallBack;}else{return null;}}
function bindOnChangeEvent(options,callBacks,firstImageData){var onChangeCallBack;if((typeof options!='undefined')&&(typeof options.galleryUID!='undefined')&&(typeof callBacks.onChange!='undefined')){onChangeCallBack="onChangeFullScreenImageViewer"+options.galleryUID;$rootScope[onChangeCallBack]=null;$rootScope[onChangeCallBack]=callBacks.onChange;callBacks.onChange(onChangeCallBack,options.galleryUID,firstImageData.id,firstImageData.shareHeadline)
return onChangeCallBack;}else{return null;}}}
return{restrict:'E',transclude:true,scope:{content:'=content',isImageGallery:'=imageGallery',index:'=index',link:'=href',headline:'=headline',category:"=category",date:"=date",mode:"=mode",articleModal:'=',mainMediaImageGallery:'=',triggerFullScreenSlideShowOnClick:'@',viewportWidth:'@',bottomImgViewportWidth:'@',imageGalleryOnFullPage:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaImageGallery.html"}}]);'use strict';snaApp.directive("snaVideo",['$rootScope','$interval','$timeout','$http','appConfig','$log','$window','videoPlayer','$filter','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$window,videoPlayer,$filter,$sce){var controller=new ScrollMagic.Controller(),scrollUpScene,scrollDownScene,latestFlyingVideo,scrollUpSceneAutoplay,scrollDownSceneAutoplay,isIE=getIEVersion()>0,index=0,jwIconVolumeOverlay='#jw-icon-volume-overlay';function link(scope,element,attrs){var flyingout=false,player,scrollTop;scope.playerLoaded=false;scope.videoLoaded=false;scope.id=index++;var isNotSNAVideo=false;var nonSNAVideoPlainAbsUrl=false;if(scope.$eval(attrs.showcaption)){scope.showCaption=true;}
if(scope.$eval(attrs.isyoutube)){scope.isYoutube=true;}
if(scope.$eval(attrs.autoplay)&&(getIEVersion()==0||getIEVersion()>8)){$(element).addClass('autoplay');scope._autoplay=true;}
scope.$watch('content',function(newValue){if(!newValue||newValue.noWatch){return;}
if(isIE&&scope.content.videoUrl&&scope.content.videoUrl[0].url.indexOf('https://www.youtube.com/watch?v')==0){scope.flyout=false;}
try{jwplayer('videoPlayerContainer'+scope.id).remove();}catch(error){$log.debug("Error removing jwplayer",error);}
scope.playerLoaded=false;scope.videoLoaded=false;$(element).find('#videoImg').on('load',function(){$(element).find('#defaultImg').css('visibility','hidden');});setVideoThumbnail();if(!scope.postLoad||$rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!='undefined'&&$rootScope.device!='DESKTOP')){scope.postLoad=false;$timeout(scope.playVideo,1000);}else{scope.videoLoaded=true;}});scope.playVideo=function(event){event&&event.preventDefault();event&&event.stopPropagation();$rootScope.trackGAEvent('SNA_VIDEO',scope.content.headline);$(element).find(jwIconVolumeOverlay).hide();if(event&&!scope.videoLoaded){return;}
if(event){if(scope.videoLoaded){scope.playerLoaded=true;}}
if(scope.playerLoaded&&scope.videoLoaded&&!scope.postLoad){if(scope._autoplay){player.playOriginIsUser=true;player.autoplay=false;}
player.play(true);player.setMute(false);return;}
var urls=scope.content.videoUrl;var ua=navigator.userAgent.toLowerCase();var isAndroid=ua.indexOf("android")>-1&&ua.indexOf("iemobile")==-1;var isIe9=ua.indexOf("msie 9.0")>-1;var useJwPlayer=true;if(isAndroid){var match=ua.match(/android\s([0-9\.]*)/i);if(match){if(parseFloat(match[1])<4.1){useJwPlayer=false;}}else{useJwPlayer=true;}}
if(window.jwplayerVersion==8){window.jwplayer.key=appConfig.jwplayerKey8;scope.jwplayer8=true;}else{window.jwplayer.key=appConfig.jwplayerKey7;scope.jwplayer7=true;}
if(useJwPlayer){scope.tracksThumbnails=[];scope.playlistOffMuteControl=false;if(typeof scope.content.thumbnailUrl!=='undefined'){scope.tracksThumbnails=[{file:scope.content.thumbnailUrl,kind:"thumbnails"}];}else if(typeof scope.content.mediaAsset!=='undefined'&&typeof scope.content.mediaAsset.thumbnailUrl!=='undefined'){scope.tracksThumbnails=[{file:scope.content.mediaAsset.thumbnailUrl,kind:"thumbnails"}];}
var viewPortWidthObj;viewPortWidthObj={viewportWidth:null,noSidebar:false,maxWidthOfRoot:null,maxWidthLevel1:null}
viewPortWidthObj.viewportWidth=scope.viewportWidth;viewPortWidthObj.noSidebar=scope.noSidebar;viewPortWidthObj.maxWidthOfRoot=scope.maxWidthOfRoot;viewPortWidthObj.maxWidthLevel1=scope.maxWidthLevel1;player=videoPlayer.jwplayer('videoPlayerContainer'+scope.id,urls,isAndroid,attrs.autoPlay=="true"||scope.postLoad,isNotSNAVideo?nonSNAVideoPlainAbsUrl:scope.imageSrc,attrs.prerollTag,scope.isYoutube,scope.tracksThumbnails,scope.content.relatedVideos,scope.jwPlayerMediaId,scope.content.headline,scope.muted,scope.content.id,scope.content,scope.isVrSupportedPlayer,viewPortWidthObj);player.on('ready',function(){!!scope.playerReady&&scope.playerReady();scope.$applyAsync(function(){scope.videoLoaded=true;});if(scope._autoplay){player.playOriginIsUser=false;player.autoplay=true;createScenesAutoplay(element);}
var ctrlBarMOtarget,ctrlbarMutationobserver;if(scope.showNavArrowOnControlIsOn&&window.isMutationObserverSupported){ctrlBarMOtarget=element[0].querySelector("[id^='videoPlayerContainer']");ctrlbarMutationobserver=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.attributeName=='class'&&mutation.type=='attributes'&&(jQuery(mutation.target).is('.jw-flag-ads-vpaid:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jw-flag-user-inactive.jw-state-playing:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jw-flag-user-inactive.jw-state-buffering:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jwplayer.jw-flag-overlay-open-related'))){scope.showNavArrowOnControlIsOn({isVisible:false});}else{scope.showNavArrowOnControlIsOn({isVisible:true});}});});var config={attributes:true,childList:false,characterData:false}
ctrlbarMutationobserver.observe(ctrlBarMOtarget,config);}});player.on('mute',function(state){if(typeof state=='undefined'||typeof state.mute=='undefined'||player.getState().toLowerCase()=='paused'){return;}
if(scope._autoplay){if(state.mute&&!player.playOriginIsUser){$(element).find(jwIconVolumeOverlay).show();}else{$(element).find(jwIconVolumeOverlay).hide();}}});player.on('complete',function(){scope.videoComplete();$(element).find(jwIconVolumeOverlay).hide();if(!flyingout){destroyScenes();latestFlyingVideo=null;}});player.on('playlist',function(playList){if(typeof playList.playlist[0].image!='undefined'){scope.$applyAsync(function(){scope.imageSrc=playList.playlist[0].image;});}
$('.jw-nextup-close').on('click',function(){$(this).closest('.jw-nextup-container').addClass('jw-nextup-container-hidden');});});player.on('pause',function(state){if(scope._autoplay){if(typeof state!=='undefined'&&typeof state.pauseReason!=='undefined'&&state.pauseReason=='interaction'&&typeof state.newstate!=='undefined'&&state.newstate=='paused'){player.autoplay=false;$(element).find(jwIconVolumeOverlay).hide();}
if(typeof state!=='undefined'&&typeof state.pauseReason!=='undefined'&&state.pauseReason!='interaction'&&typeof state.newstate!=='undefined'&&state.newstate=='paused'){$(element).find(jwIconVolumeOverlay).hide();}}
scope.videoPause(state);if(!flyingout&&scope.flyout){if(player.autoplay&&!player.playOriginIsUser){return;}
destroyScenes();latestFlyingVideo=null;}});player.on('fullscreen',function(event){if(event.fullscreen){$("body").addClass('fullscreen-video');if($rootScope.device=='DESKTOP'){scrollTop=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;}}else{setTimeout(function(){$("body").removeClass('fullscreen-video');},1000);if(isChrome()){setTimeout(function(){if($rootScope.device=='DESKTOP'&&$rootScope.flyoutVideoPresent){document.body.scrollTop=scrollTop;}},1);}}});player.on('play',function(event){if(scope._autoplay){if(typeof event!=='undefined'&&typeof event.playReason!=='undefined'&&typeof player.playOriginIsUser!=='undefined'){if(player.playOriginIsUser||(event.playReason=='interaction')){$(element).find(jwIconVolumeOverlay).hide();player.setMute(false);player.autoplay=false;}else{$(element).find(jwIconVolumeOverlay).show();player.setMute(true);}}}else{if(player.getConfig().playReason=='autostart'&&!scope.playlistOffMuteControl){player.setMute(false);if(typeof player.getConfig()!=='undefined'&&'playlist'in player.getConfig()){scope.playlistOffMuteControl=true;}}}
if(this.snaPaused){this.snaPaused=false;return;}
scope.$applyAsync(function(){scope.playerLoaded=true;});scope.videoPlay();player.closeFlyout=scope.closeFlyout;if($rootScope.device!='DESKTOP'){scrollTop=parseInt(element.offset().top)-element[0].getBoundingClientRect().height/2;}
if(scope.flyout){if(player.autoplay&&!player.playOriginIsUser){return;}
if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){if(player.autoplay&&!player.playOriginIsUser){return;}
scrollDownLeave(latestFlyingVideo);destroyScenes();}});player.on('playlistItem',function(data){scope.playlistItemChange({data:data});});if(isIe9){scope.videoLoaded=true;scope.playerLoaded=true;}
if(attrs.autoPlay=="true"){if($rootScope.device=='DESKTOP'){scope.playerLoaded=true;}}}else{$.each(urls,function(index,obj){if(obj.platform=="MobileH264"){scope.androidVideoUrl=obj.url;}});scope.nativeAndroid=true;}
return false;};scope.closeFlyout=function(){if(!flyingout){return;}
flyingout=false;destroyScenes();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:'',width:''});video.removeClass('flyout-prepare');element.find('#flyoutButtonsDiv').hide();player.pause(true);if(player.getState().toLowerCase()=='buffering'){player.snaPaused=true;}};function setVideoThumbnail(){scope.imageSrc="";if(scope.content.mediaAsset.imageUrl.indexOf('http://')==0||scope.content.mediaAsset.imageUrl.indexOf('https://')==0){scope.imageSrc=$sce.trustAsResourceUrl(scope.content.mediaAsset.imageUrl);if(typeof $sce.valueOf(scope.imageSrc)=="string"){isNotSNAVideo=true;nonSNAVideoPlainAbsUrl=$sce.valueOf(scope.imageSrc)}}else if(scope.content.mediaAsset.imageUrl.indexOf("/"+$rootScope.webContext+"/images")==0){if(typeof scope.viewportWidth!="undefined"){scope.imageSrc=$filter('imageAdvFilter')(scope.content.mediaAsset.imageUrl,scope.viewportWidth,0.563,scope.noSidebar,scope.maxWidthOfRoot,scope.maxWidthLevel1,true);}else{scope.imageSrc=$filter('imagefilter')(scope.content.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}}else{if(typeof scope.viewportWidth!="undefined"){scope.imageSrc="/"+$rootScope.webContext+"/images"
+$filter('imageAdvFilter')(scope.content.mediaAsset.imageUrl,scope.viewportWidth,0.563,scope.noSidebar,scope.maxWidthOfRoot,scope.maxWidthLevel1,true);}else{scope.imageSrc="/"+$rootScope.webContext+"/images"+$filter('imagefilter')(scope.content.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}}}
function destroyScenes(){if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}}
function createScenesAutoplay(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
var autoplayDisabled=function(){return(typeof player!=='undefined'&&!player.autoplay)||player.playOriginIsUser;};$('<div id="jw-icon-volume-overlay">').html('<div class="jw-icon-volume-overlay-content"><svg xmlns="http://www.w3.org/2000/svg" class="jw-svg-icon jw-svg-icon-volume-0" '
+'viewBox="0 0 240 240"><path d="M116.4,42.8v154.5c0,2.8-1.7,3.6-3.8,1.7l-54.1-48.1H28.9c-2.8,0-5.2-2.3-5.2-5.2V94.2c0-2.8,2.3-5'
+'.2,5.2-5.2h29.6l54.1-48.1C114.6,39.1,116.4,39.9,116.4,42.8z M212.3,96.4l-14.6-14.6l-23.6,23.6l-23.6-23.6l-14.6,14.6l23.6,23.6l-'
+'23.6,23.6l14.6,14.6l23.6-23.6l23.6,23.6l14.6-14.6L188.7,120L212.3,96.4z"></path></svg></div>').on('click',function(event){event&&event.stopPropagation();if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'){window.activeYtPlayer.pauseVideo();}
if(window.activeJWPlayer&&window.activeJWPlayer.getState().toLowerCase()=='buffering'){window.activeJWPlayer.snaPaused=true;}
if(window.activeJWPlayer&&window.activeJWPlayer.id!=player.id){window.activeJWPlayer.pause(true);}
player.playOriginIsUser=true;player.autoplay=false;player.setMute(false);if(scope.flyout){if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);destroyScenes();}
window.activeJWPlayer=player;}).prependTo($(element).find('#videoWrapper'));scrollDownSceneAutoplay=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:1,}).on('enter',function(){if(autoplayDisabled()){return;}
$timeout(function(){player.setMute(true);player.play(true);scope.$applyAsync(function(){scope.playerLoaded=true;});},100);}).on('leave',function(){if(autoplayDisabled()){return;}
player.play(false);});scrollUpSceneAutoplay=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:0,}).on('enter',function(){if(autoplayDisabled()){return;}
$timeout(function(){player.setMute(true);player.play(false);},100);}).on('leave',function(){if(autoplayDisabled()){return;}
player.play(true);scope.$applyAsync(function(){scope.playerLoaded=true;});});controller.addScene(scrollUpSceneAutoplay);controller.addScene(scrollDownSceneAutoplay);}
function createScenes(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}
scrollDownScene=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:0,}).on('enter',function(){if(player.getFullscreen()){return;}else if(player.getState().toLowerCase()=='idle'||player.getState().toLowerCase()=='paused'){return;}
scrollDownEnter(element);flyingout=true;}).on('leave',function(){if(player.getFullscreen()){return;}
scrollDownLeave(element);flyingout=false;});scrollUpScene=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,duration:0,triggerHook:1,}).on('enter',function(){if(player.getFullscreen()||!flyingout){return;}
scrollUpEnter(element);flyingout=false;}).on('leave',function(){if(player.getFullscreen()){return;}else if(player.getState().toLowerCase()=='idle'||player.getState().toLowerCase()=='paused'){return;}
scrollUpLeave(element);flyingout=true;});controller.addScene(scrollUpScene);controller.addScene(scrollDownScene);}
function scrollDownEnter(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'100px',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0,"onComplete":function(){video.css({top:''});}});}
function scrollDownLeave(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video'),offset=element[0].getBoundingClientRect();if(offset.bottom<0){offset={bottom:$(window).height(),left:offset.left,right:offset.right,top:offset.top};}
video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}
function scrollUpLeave(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0});}
function scrollUpEnter(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video');video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}}
return{restrict:'E',scope:{content:'=content',videoComplete:'&videoComplete',videoPause:'&videoPause',videoPlay:'&videoPlay',flyout:'=flyout',autoplay:'=autoplay',postLoad:'=postload',contentUrl:'=contentUrl',playerReady:"&playerReady",jwPlayerMediaId:"=",playlistItemChange:"&",muted:"=",isVrSupportedPlayer:'@',viewportWidth:'@',noSidebar:'@',maxWidthOfRoot:'@',maxWidthLevel1:'@',showNavArrowOnControlIsOn:'&'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaVideo.html"}}]);loadJWPlayer();'use strict';snaApp.directive("snaVideoTeaser",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element){var vt=$(element).find('video');var videoTeaserFirstLoad=true;var videoTeaserUrl;var videoTeaserTimeout;if((typeof $rootScope.device!='undefined'&&$rootScope.device!='DESKTOP')||$rootScope.deviceType!='DESKTOP'){return;}else if(!vt||typeof scope.content.type=='undefined'){return;}else if(scope.content.type=='VIDEO'&&typeof scope.content.teaserUrl=='undefined'){return;}else if(scope.content.type!='VIDEO'&&typeof scope.content.mediaAsset=='undefined'){return;}else if(scope.content.type!='VIDEO'&&typeof scope.content.mediaAsset!='undefined'&&!('teaserUrl'in scope.content.mediaAsset)){return;}
try{if(scope.content.type=='VIDEO'){videoTeaserUrl=$sce.trustAsResourceUrl(scope.content.teaserUrl);}else{videoTeaserUrl=$sce.trustAsResourceUrl(scope.content.mediaAsset.teaserUrl);}}catch(error){$log.log(error.message);return;}
scope.videoTeaserUrl=videoTeaserUrl;if($(element).parents('.video-holder').length){$(element).parents('.video-holder').addClass('teaser-on');}
var playVideoTeaser=function(video){if(video&&video.paused){video.muted=true;video.play();}
$(element).find('.videoTeaserSlide').addClass('in');};scope.videoTeaserOnHover=function(event){event&&event.stopPropagation();$(element).parents('a').removeAttr('title');if(videoTeaserFirstLoad){videoTeaserTimeout=$timeout(function(){var source=document.createElement('source');$(source).attr('type','video/mp4');$(source).attr('src',videoTeaserUrl);vt[0].appendChild(source);if(typeof vt[0].load==="function"){vt[0].load();}
vt[0].addEventListener('canplay',function(){playVideoTeaser(vt[0]);videoTeaserFirstLoad=false;},true);},100);}else{playVideoTeaser(vt[0]);}};scope.videoTeaserOnLeave=function(event){event&&event.stopPropagation();$(element).find('.videoTeaserSlide').removeClass('in');vt[0].pause();$timeout.cancel(videoTeaserTimeout);};scope.videoTeaserOnClick=function(event){event&&vt[0].pause();}}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaVideoTeaser.html"}}]);snaApp.directive("snaCustomHtml",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){scope.customHtml=$sce.trustAsHtml(scope.content.freeText);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaCustomHtml.html"}}]);snaApp.directive("snaPoll",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){scope.component={title:" ",contents:[scope.content]};scope.hidePollImage=true;if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}else{scope.position='left';}
$(element).closest("p").addClass("inline-poll-parent").addClass(scope.position);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaPoll.html"}}]);snaApp.directive("snaPollApster",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){scope.component={title:" ",contents:[scope.content]};scope.embedCode=$sce.trustAsHtml(scope.content.freeText);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaPollApster.html"}}]);snaApp.directive("snaQuote",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}else{scope.position='left';}
$(element).closest("p").addClass("inline-quote-parent").addClass(scope.position);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaQuote.html"}}]);"use strict"
if('scrollRestoration'in window.history){window.history.scrollRestoration='manual';}
if(isSafari()){$(window).off("unload.movePageTop");$(window).on('unload.movePageTop',function(){$(window).scrollTop(0);});}
window.scroll(0,0);snaApp.controller("articleController",["$scope","$http","appConfig","$window","$log","$rootScope","$timeout","$q",function($scope,$http,appConfig,$window,$log,$rootScope,$timeout,$q){window.scroll(0,0);var contentBlock=$(window),articleLoadingInProgress,listenToBrowserNavButton,loadingInReadVideoAdInProgress=false,loadedArticleIds,viewedArticleIds,locationBaseUrl,articleInView,printTimerId,printInProcess,loadedArticlesPathObjArr,NO_OF_NEXT_AUTO_SCROLL_ARTICLES=3,NO_OF_NEXT_MANUAL_ARTICLES=5,MAX_NO_OF_AUTO_SCROLL_ARTICLES=appConfig.maxNoOfAutoScrollArticles,MAX_NO_OF_ARTICLE_IN_PAGE=50,client="web",popular_stories_content_type="ARTICLE",popular_stories_offset,lastPageScrollPos,currentPageScrollPos,NO_OF_POPULAR_ARTICLES_BELOW_EACH_ARTICLE=4,MAX_NO_OF_LOAD_MORE_CLICK_ALLOWED=(MAX_NO_OF_ARTICLE_IN_PAGE-MAX_NO_OF_AUTO_SCROLL_ARTICLES)/NO_OF_NEXT_MANUAL_ARTICLES,NO_OF_POPULAR_STORIES_INITIAL_LOAD=MAX_NO_OF_AUTO_SCROLL_ARTICLES*4+MAX_NO_OF_AUTO_SCROLL_ARTICLES,NO_OF_POPULAR_STORIES_MANUAL_LOAD=NO_OF_NEXT_MANUAL_ARTICLES*4+NO_OF_NEXT_MANUAL_ARTICLES,MAX_NO_POPULAR_STORIES=MAX_NO_OF_ARTICLE_IN_PAGE*4,no_of_Load_more_manual_click,scrollEventNameSpaceForArticleLoad="articleLoadScroll",scrollEventNameSpaceForArticleView="articleViewScroll",promiseForArticleLoad,popularContentLoadingInProgress,promiseForPopularContentLoad,ua=navigator.userAgent.toLowerCase(),currentArticleId;$scope.scrollLoadTriggerPointIndexFromLastArticle=2;$scope.isLowerVerIE=(getIEVersion()==9)||(getIEVersion()==10);$rootScope.showImageTeaserOnPage=true;$scope.flyout=true;$scope.maxNoOfAutoScrollArticles=MAX_NO_OF_AUTO_SCROLL_ARTICLES;if($rootScope.device=='DESKTOP'){$scope.prerollTag='https://pubads.g.doubleclick.net/gampad/ads?sz=610x343&iu=/13259764/sna_article_pre-roll&ciu_szs=610x343&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]';}
articlePageInit($scope.initData.id);function articlePageInit(articleId,manualInit,isBrowserHistoryNav){articleLoadingInProgress=false;listenToBrowserNavButton=true;viewedArticleIds=[];loadedArticleIds=[];locationBaseUrl=getLocationBaseURl()+'/';articleInView='';loadedArticlesPathObjArr={};popular_stories_offset=0;no_of_Load_more_manual_click=0;printInProcess=false;clearTimeout(printTimerId);$scope.articleListModal=[];$scope.loadArticlesFromTopicId=getTopicIdFromArticlestoBeLoaded();$scope.popularStories=[];$scope.firstArticle=null;unBindScrollForArticleView();unBindScrollForArticleLoad();unBindHistoryPopStateEvent();!!promiseForArticleLoad&&promiseForArticleLoad.resolve();!!promiseForPopularContentLoad&&promiseForPopularContentLoad.resolve();$(".article-load-more-btn").hide();$(".article-load-more-btn").removeClass('article-manual-load-more-btn');if($rootScope.deviceType=='MOBILE'){$scope.noOfPopularStoriesForEachArticle=2;}else{$scope.noOfPopularStoriesForEachArticle=4;}
blockUI(contentBlock);window.scroll(0,0);setTimeout(function(){window.scroll(0,0);},500);var firstArticleLoadUrlObj={};firstArticleLoadUrlObj.url=appConfig.apiBaseURL+'/rest/v2/article/'+articleId+'.json';firstArticleLoadUrlObj.paramObj={};firstArticleLoadUrlObj.paramObj["deviceType"]=$rootScope.deviceType;firstArticleLoadUrlObj.paramObj["client"]=client;if($scope.loadArticlesFromTopicId){firstArticleLoadUrlObj.paramObj["topicId"]=$scope.loadArticlesFromTopicId;}
var successCallBackForFirstArticleLoad=function(data){unblockUI(contentBlock);$scope.firstArticle=data;if($rootScope.device=='DESKTOP'){}
window.scroll(0,0);if(manualInit){manualArticlePageLoadCompleted(data);if(!isBrowserHistoryNav){setTimeout(function(){changeBrowserUrl(data);},50);}}else{setTimeout(function(){changeBrowserUrl(data,true);},50);}
currentArticleId=articleId;if((getIEVersion()!=10)&&(getIEVersion()!=11)){}
pushArticleDataToView([data]);menuSelection(data.section);articleLoadingInProgress=false;promiseForArticleLoad=false;articleInView=loadedArticlesPathObjArr[data.id];callApplyAsyncScope();setTimeout(function(){processPrint(data);},0);fetchNextArticleSet(NO_OF_NEXT_AUTO_SCROLL_ARTICLES);bindHistoryPopStateEvent();bindScrollForArticleView();bindScrollForArticleLoad();}
var failureCallBackForFirstArticleLoad=function(argument){unblockUI(contentBlock);articleLoadingInProgress=false;promiseForArticleLoad=false;}
watchForDeviceTypeChange();articleLoadingInProgress=true;promiseForArticleLoad=loadArticleDataFromServer(firstArticleLoadUrlObj,successCallBackForFirstArticleLoad,failureCallBackForFirstArticleLoad);fetchPopularStories(NO_OF_POPULAR_STORIES_INITIAL_LOAD,true);}
function watchForDeviceTypeChange(argument){$rootScope.$watch('deviceType',function(newValue,oldValue){if(newValue=='MOBILE'&&(oldValue=='DESKTOP'||oldValue=='TABLET')){$scope.noOfPopularStoriesForEachArticle=2;}else if(oldValue=='MOBILE'&&(newValue=='DESKTOP'||newValue=='TABLET')){$scope.noOfPopularStoriesForEachArticle=4;}});}
function processPrint(articleData){var searchQueryStringObj=getQueryStringArgs();var printParamInQueryString=searchQueryStringObj.printArticle;var printTimerId;if(printParamInQueryString){changeBrowserUrl(articleData,true);printInProcess=true;printArticle(printParamInQueryString);}}
function printArticle(printParamInQueryString){if(!printInProcess){return;}
var printArticleElem=document.querySelectorAll('.article-list-item[data-article-id="'+printParamInQueryString+'"]');var printArticleElemHeadline=document.querySelectorAll('.article-list-item[data-article-id="'+printParamInQueryString+'"] .article_headline');if(printArticleElem.length>0){printInProcess=false;debugger;$scope.$applyAsync(function(){requestAnimationFrame(function(){window.print();});})}else{printTimerId=setTimeout(function(){printArticle(printParamInQueryString);},300);}}
function fetchPopularStories(noOfStoriesToBeFetched,isInitialLoad){if(checkMaxPopularStoriesFetched()){return;}
if(!isInitialLoad){no_of_Load_more_manual_click++;}
var popularStoriesUrlObj={};popularStoriesUrlObj.url=appConfig.apiBaseURL+'/rest/v2/mostpopular.json';popularStoriesUrlObj.paramObj={};popularStoriesUrlObj.paramObj["contentType"]=popular_stories_content_type;popularStoriesUrlObj.paramObj["interval"]=2;popularStoriesUrlObj.paramObj["offset"]=popular_stories_offset;popularStoriesUrlObj.paramObj["pageSize"]=noOfStoriesToBeFetched;var successCallBackForPopularStoriesInitialLoad=function(data){if(data.contentItems&&data.contentItems.length>0){$scope.popularStories=$scope.popularStories.concat(data.contentItems);popular_stories_offset+=data.contentItems.length;}
popularContentLoadingInProgress=false;promiseForPopularContentLoad=false;}
var failureCallBackForPopularStoriesInitialLoad=function(){popularContentLoadingInProgress=false;promiseForPopularContentLoad=false;}
popularContentLoadingInProgress=true;promiseForPopularContentLoad=loadArticleDataFromServer(popularStoriesUrlObj,successCallBackForPopularStoriesInitialLoad,failureCallBackForPopularStoriesInitialLoad);}
function checkMaxPopularStoriesFetched(){if($scope.popularStories.length>=(MAX_NO_POPULAR_STORIES+(MAX_NO_OF_LOAD_MORE_CLICK_ALLOWED-no_of_Load_more_manual_click)*NO_OF_NEXT_MANUAL_ARTICLES)){return true;}
return false;}
$scope.popularStoriesForArticleFn=function(article,articleIndex){var popularStoriesForArticle=[];if(article.popularStoriesProcessed&&article.deviceType==$rootScope.deviceType&&article.popularStoriesProcessed.length==$scope.noOfPopularStoriesForEachArticle){return article.popularStoriesProcessed;}
popularStoriesForArticle=$scope.popularStories.slice((articleIndex*$scope.noOfPopularStoriesForEachArticle),((articleIndex*$scope.noOfPopularStoriesForEachArticle)+$scope.noOfPopularStoriesForEachArticle));for(var i=0;i<popularStoriesForArticle.length;i++){if(popularStoriesForArticle[i].id==article.id){$scope.popularStories.splice(((articleIndex*$scope.noOfPopularStoriesForEachArticle)+i),1);}}
popularStoriesForArticle=$scope.popularStories.slice((articleIndex*$scope.noOfPopularStoriesForEachArticle),((articleIndex*$scope.noOfPopularStoriesForEachArticle)+$scope.noOfPopularStoriesForEachArticle));article.popularStoriesProcessed=popularStoriesForArticle;article.deviceType=$rootScope.deviceType;return popularStoriesForArticle;}
function callApplyAsyncScope(){$scope.$applyAsync(function(){$(document).foundation({equalizer:{use_tallest:true,equalize_on_stack:true,check_window_height_width:true,}});registerMenuCloseEvent();bindMobileMenuEvent();});}
function bindScrollForArticleLoad(argument){if(isIEBrowser()&&getIEVersion()!=9&&getIEVersion()!=10){triggerFnBasedOnElemPosInScreenDebounce('.article-list-item-scroll',100,scrollEventNameSpaceForArticleLoad,triggerFetchArticleOnScroll,100,false);}else{triggerFnBasedOnElemPosInScreenRaff('.article-list-item-scroll',100,scrollEventNameSpaceForArticleLoad,triggerFetchArticleOnScroll,100,false);}}
function unBindScrollForArticleLoad(){$("body").off("."+scrollEventNameSpaceForArticleLoad);$(window).off("."+scrollEventNameSpaceForArticleLoad);}
function triggerFetchArticleOnScroll(){if($scope.articleListModal.length==MAX_NO_OF_AUTO_SCROLL_ARTICLES){unBindScrollForArticleLoad();$(".article-load-more-btn").show();$(".article-load-more-btn").addClass('article-manual-load-more-btn');return;}
fetchNextArticleSet(NO_OF_NEXT_AUTO_SCROLL_ARTICLES);}
$scope.loadMoreArticlesBtnFromDom=function(event){$(".article-load-more-btn").hide();fetchNextArticleSet(NO_OF_NEXT_MANUAL_ARTICLES);fetchPopularStories(NO_OF_POPULAR_STORIES_MANUAL_LOAD);}
var articleInView
function bindScrollForArticleView(){var scrollEventBindElem,heightOfScreen,articleItem,triggerPoint,scrollDirection;if(isIEBrowser()&&getIEVersion()!=9&&getIEVersion()!=10){scrollEventBindElem=$("body");}else{scrollEventBindElem=$(window);}
var isIE11AndAbove=(isIEBrowser()&&getIEVersion()!=9&&getIEVersion()!=10);scrollEventBindElem.on("scroll."+scrollEventNameSpaceForArticleView,function(e){var scrollDirection,articleBottomPos;var articleItemDomArr=document.querySelectorAll(".article-list-item");var firstArticle=document.querySelector('.article-list-item');heightOfScreen=document.documentElement.clientHeight;triggerPoint=(heightOfScreen/2);currentPageScrollPos=document.body.scrollTop||window.pageYOffset;if(isIEEdge()){currentPageScrollPos=-1*firstArticle.getBoundingClientRect().top;}
lastPageScrollPos=lastPageScrollPos||currentPageScrollPos;if(currentPageScrollPos>lastPageScrollPos){scrollDirection="scrollDown"}else if(currentPageScrollPos<lastPageScrollPos){scrollDirection="scrollUp";}
lastPageScrollPos=currentPageScrollPos;for(var i=0;i<articleItemDomArr.length;i++){articleItem={};articleItem.topPos=articleItemDomArr[i].getBoundingClientRect().top;articleItem.height=articleItemDomArr[i].getBoundingClientRect().height;if(scrollDirection=="scrollDown"){if(articleItem.topPos>0&&articleItem.topPos<triggerPoint){articleChangeInView($(articleItemDomArr[i]).data('article-id'));}}else if(scrollDirection=="scrollUp"){articleBottomPos=articleItem.topPos+articleItem.height;if(articleBottomPos<heightOfScreen&&articleBottomPos>triggerPoint){articleChangeInView($(articleItemDomArr[i]).data('article-id'));}}}})}
function scrollHandlerToMakeArticleView(argument){}
function unBindScrollForArticleView(){$("body").off("."+scrollEventNameSpaceForArticleView);$(window).off("."+scrollEventNameSpaceForArticleView);}
function loadArticleDataFromServer(urlObj,successCallBack,failureCallBack){var deferredObjForRequest=$q.defer();var promiseForRequest=deferredObjForRequest.promise;$http.get(urlObj.url,{params:urlObj.paramObj,timeout:promiseForRequest}).then(function(response){successCallBack(response.data);},function(){failureCallBack();$log.error("Error Fetching article data");});return deferredObjForRequest;}
function pushArticleDataToView(articleDataArr){articleMediaProcessing(articleDataArr);formatArticleSharingData(articleDataArr);pushObjToLoadedArticlesPathObjArr(articleDataArr);$scope.articleListModal=$scope.articleListModal.concat(articleDataArr);checkMaxNoOfArticleReached();}
function checkMaxNoOfArticleReached(argument){if($scope.articleListModal.length>=MAX_NO_OF_ARTICLE_IN_PAGE){$(".article-load-more-btn").hide();console.log("MAX No of Article per page Reached hide the load more");}}
function manualArticlePageLoadCompleted(articleData){var pageTitle=getPageTitle(articleData);document.title=pageTitle;sendGAPageView(appConfig.webContext,articleData.type.toLowerCase(),articleData.id,articleData.urlFriendlySuffix,pageTitle,articleData.sectionUrl);sendFBPixelPageView();}
function getPageTitle(articleData){return articleData.headline+' |    ';}
function articleMediaProcessing(articleDataArr){var articleData;for(var i=0;i<articleDataArr.length;i++){var articleData=articleDataArr[i];if(articleData.mediaAsset.type=='IMAGE_GALLERY'){articleData.imageGalleryContent={images:articleData.mediaAssets,id:articleData.id,mainMediaImageGallery:true};}else if(articleData.mediaAsset.type=='VIDEO'){articleData.videoContent={id:new Date().getTime(),mediaAsset:articleData.mediaAsset,videoUrl:articleData.mediaAsset.videoUrl,headline:articleData.mediaAsset.headline};}}}
function formatArticleSharingData(articleDataArr){var articleData;var sharingBaseUrl='https://'+appConfig.sharingHost;for(var i=0;i<articleDataArr.length;i++){var articleData=articleDataArr[i];articleData.Sheadline=articleData.headline;articleData.Surl=encodeURI(sharingBaseUrl+articleData.sectionUrl+"/"+articleData.id+'-'+articleData.urlFriendlySuffix);articleData.shareEmailUrl=encodeURI(sharingBaseUrl+articleData.sectionUrl+"/"+articleData.id+'/');articleData.shortUrl=!!articleData.shareUrl&&encodeURI(articleData.shareUrl);articleData.Ssummary=articleData.summary;articleData.shareMainMediaUrl=articleData.mediaAsset.imageUrl;}}
function pushObjToLoadedArticlesPathObjArr(articleDataArr){var articleData;for(var i=0;i<articleDataArr.length;i++){var articleData=articleDataArr[i];loadedArticlesPathObjArr[articleDataArr[i].id]={};loadedArticlesPathObjArr[articleDataArr[i].id]["id"]=articleData.id;loadedArticlesPathObjArr[articleDataArr[i].id]["urlFriendlySuffix"]=articleData.urlFriendlySuffix;loadedArticlesPathObjArr[articleDataArr[i].id]["type"]=articleData.type;loadedArticlesPathObjArr[articleDataArr[i].id]["pageTitle"]=getPageTitle(articleData);loadedArticlesPathObjArr[articleDataArr[i].id]["headline"]=articleData.headline;loadedArticlesPathObjArr[articleDataArr[i].id]["sectionUrl"]=articleData.sectionUrl;}}
function bindHistoryPopStateEvent(){if(historyEnabledBrowser()){window.addEventListener('popstate',articleHistoryPopstate,false);}}
function unBindHistoryPopStateEvent(){if(historyEnabledBrowser()){window.removeEventListener('popstate',articleHistoryPopstate,false);}}
function articleHistoryPopstate(e){if((!historyEnabledBrowser())||!e.state||!e.state.articleId||e.state.articleId==currentArticleId){return;}
var articleId=e.state.articleId;if(!!articleId){articlePageInit(articleId,true,true);}}
function fetchNextArticleSet(noOfArticlesToBeFetched){var lastLoadedArticle=$scope.articleListModal[$scope.articleListModal.length-1];var lastLoadedArticleId=!!lastLoadedArticle.id&&lastLoadedArticle.id;if(articleLoadingInProgress||!lastLoadedArticleId){return;}
var nextArticlesLoadUrlObj={};nextArticlesLoadUrlObj.url=appConfig.apiBaseURL+'/rest/v2/article/'+lastLoadedArticleId+'/previous.json';nextArticlesLoadUrlObj.paramObj={};nextArticlesLoadUrlObj.paramObj["pageSize"]=noOfArticlesToBeFetched;nextArticlesLoadUrlObj.paramObj["client"]=client;if($scope.loadArticlesFromTopicId){nextArticlesLoadUrlObj.paramObj["topicId"]=$scope.loadArticlesFromTopicId;}
var successCallbackForNextArticleSetLoad=function(data){articleLoadingInProgress=false;$(".article-list-ajax-loader").hide();if(typeof data.articles!="undefined"&&Array.isArray(data.articles)&&data.articles.length>0){$('.article-manual-load-more-btn.article-load-more-btn').show();pushArticleDataToView(data.articles);}else{}}
var failureCallbackForNextArticleSetLoad=function(data){articleLoadingInProgress=false;$(".article-list-ajax-loader").hide();$('.article-manual-load-more-btn.article-load-more-btn').show();}
articleLoadingInProgress=true;$(".article-list-ajax-loader").show();promiseForArticleLoad=loadArticleDataFromServer(nextArticlesLoadUrlObj,successCallbackForNextArticleSetLoad,failureCallbackForNextArticleSetLoad);}
$scope.openArticlePageFromDom=function(articleId){if(!articleId||articleLoadingInProgress){return;}
listenToBrowserNavButton=false;articlePageInit(articleId,true);}
$scope.mobileAdDataIsPresent=function(dataAvailable,siteId){if(dataAvailable){$('.article-mobile-ad-'+siteId).find('.article-mobile-ad-space-fill').show();}else{$('.article-mobile-ad-'+siteId).find('.article-mobile-ad-space-fill').hide();}}
window.addEventListener('orientationchange',function(){if($rootScope.device!='MOBILE'){}});function loadInreadVideoAd(){$timeout(function(){if(!loadingInReadVideoAdInProgress&&$('.teads-inread').length==0){loadingInReadVideoAdInProgress=true;window._ttf=window._ttf||[];_ttf.push({pid:28538,lang:"ar",slot:'.teads-inread-ad-article-body[itemprop="articleBody"] .body-div-for-inread > p:not(.inline-quote-parent):not(.inline-poll-parent)',format:"inread",components:{skip:{delay:0}},css:"margin: 0px 0px 20px;"});(function(d){var js,s=d.getElementsByTagName('script')[0];js=d.createElement('script');js.onload=function(){loadingInReadVideoAdInProgress=false;};js.async=true;js.src='//cdn.teads.tv/media/format.js';s.parentNode.insertBefore(js,s);})(window.document);}},3000,false);}
function getLocationBaseURl(){var locationBaseURl=window.location.protocol+"//";locationBaseURl+=window.location.hostname;locationBaseURl+=window.location.port&&window.location.port!=80&&window.location.port!=443?":"+window.location.port:'';return locationBaseURl;}
function menuSelection(sectionToBeSelectedInMenu){$rootScope.menuLocationUrl=locationBaseUrl+sectionToBeSelectedInMenu;}
function bindMobileMenuEvent(){$(document).on('open.fndtn.offcanvas','[data-offcanvas]',function(){articleChangeInView($('.article-list-item').eq(0).data('article-id'));}).on('close.fndtn.offcanvas','[data-offcanvas]',function(){});}
function articleChangeInView(articleId){if(articleId==articleInView["id"]){return;}
articleInView=loadedArticlesPathObjArr[articleId];sendGAManually(articleInView);changeBrowserUrl(articleInView,true);var pageTitle=getPageTitle(articleInView);document.title=pageTitle;currentArticleId=articleId;}
$scope.changePrintArticleCSS=function(contentId){var searchQueryStringObj=getQueryStringArgs();var newSearchQueryString='?';var queryStringValue;var queryString;if(!$.isEmptyObject(searchQueryStringObj)){for(queryString in searchQueryStringObj){if(queryString=='printArticle'){queryStringValue=contentId;}else{queryStringValue=searchQueryStringObj[queryString];}
newSearchQueryString=newSearchQueryString+queryString+'='+queryStringValue+'&';}}
if($.isEmptyObject(searchQueryStringObj)||!(searchQueryStringObj["printArticle"])){newSearchQueryString=newSearchQueryString+'printArticle='+contentId;}
var articleUrl=loadedArticlesPathObjArr[contentId].sectionUrl+'/';window.open(getLocationBaseURl()+articleUrl+contentId+"-"+encodeURI(loadedArticlesPathObjArr[contentId].urlFriendlySuffix)+newSearchQueryString,'_blank');}
function removePrintStyleElem(){var styleElem=document.getElementById('sna-print-article-css');if(styleElem){styleElem.parentNode.parentNode.removeChild(styleElem.parentNode);}}
function sendGAManually(articleData){if(!articleData.gaAlreadySent){articleData.gaAlreadySent=true;sendGAPageView(appConfig.webContext,articleData.type.toLowerCase(),articleData.id,articleData.urlFriendlySuffix,articleData.pageTitle,articleData.sectionUrl);}}
function changeBrowserUrl(articleData,replaceUrlInHistory){if(!historyEnabledBrowser()){return;}
var articleUrl=articleData.sectionUrl+'/';if(replaceUrlInHistory){history.replaceState({articleId:articleData.id},null,articleUrl+articleData.id+"-"+encodeURI(articleData.urlFriendlySuffix));}else{history.pushState({articleId:articleData.id},null,articleUrl+articleData.id+"-"+encodeURI(articleData.urlFriendlySuffix));}}
function getTopicIdFromArticlestoBeLoaded(){var queryStringParams=getQueryStringArgs();var topicIdInQueryString=typeof queryStringParams["topicId"]!='undefined'?queryStringParams["topicId"]:null;return topicIdInQueryString;}
function getQueryStringArgs(){var qs=(window.location.search.length>0?window.location.search.substring(1):""),args={},items=qs.length?qs.split("&"):[],item=null,name=null,value=null,i=0,len=items.length;for(i=0;i<len;i++){item=items[i].split("=");name=decodeURIComponent(item[0]);value=decodeURIComponent(item[1]);if(name.length){args[name]=value;}}
return args;}
function historyEnabledBrowser(argument){if(getIEVersion()==9){return false;}
return true;}
function injectStyles(rule,id){var div=$("<div />",{html:'&shy;<style id='+id+'>'+rule+'</style>'}).appendTo("body");div.hide();}}]);function showImage(){$('.main-image').css("visibility","visible");};'use strict'
snaApp.controller("pollsController",["$rootScope","$scope",'$element','$sce',function($rootScope,$scope,$element,$sce){$scope.polls=$scope.component.contents;if($scope.polls[0]!=='undefined'&&$scope.polls[0].type!=='undefined'){$scope.pollType=$scope.polls[0].type;}
if($scope.pollType=='POLL_APESTER'){$scope.pollEmbedCode=$sce.trustAsHtml($scope.polls[0].freeText);return;}
var pollWidgetDom=$element;if($scope.polls[0].freeText!=null&&$scope.polls[0].freeText!=''){var poll=$('<iframe name="poll_iframe" class="poll_frame" width="100%" scrolling="no" style="overflow:hidden;border-top: 0;"></iframe>');pollWidgetDom.find('#poll_wrapper').append(poll);var initScript='<script>';initScript+='setTimeout(function() {setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25);';initScript+='setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25);}, 500);window.stop && window.stop();';initScript+='if (navigator.userAgent && navigator.userAgent.match(/Windows Phone/i) || true) {'
initScript+='window.addEventListener("resize", function (event) {';initScript+='setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25)';initScript+='});}';initScript+='var insertListener = function(event){';initScript+='if (event.animationName == "nodeInserted") {';initScript+='setTimeout(function() { setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 50); }, 100);';initScript+='}};';initScript+='document.addEventListener("animationstart", insertListener, false); ';initScript+='document.addEventListener("MSAnimationStart", insertListener, false); ';initScript+='document.addEventListener("webkitAnimationStart", insertListener, false); ';initScript+='</script>';pollWidgetDom.find('#poll_wrapper iframe')[0].contentWindow.document.write('<body id="sna-poll" style="margin: 0;">'
+'<script src="'+$rootScope.appAssetsUrl+'/js/pollTheme/pollAnimation.js"></script>'
+$scope.polls[0].freeText+initScript+"</body>");pollWidgetDom.find('#poll_wrapper iframe')[0].contentWindow.setHeight=function(pollHeight){pollWidgetDom.find('#poll_wrapper iframe')[0].height=pollHeight;if(!(pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollStyle').length>0)){pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append('<style id="pollStyle"></style>');}
if(!(pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollIFrameHeight').length>0)){pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append("<style id='pollIFrameHeight'> @keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }   "
+"@-webkit-keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }  "
+"@-ms-keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }"
+".PDS_Poll  div.pds-question, .PDS_Poll  div.pds-answer, .PDS_Poll  "
+"div.pds-vote {animation-duration: 0.001s; animation-name: nodeInserted; -webkit-animation-duration: 0.001s; "
+"-webkit-animation-name: nodeInserted; -ms-animation-duration: 0.001s; -webkit-ms-name: nodeInserted;}</style>");}
resetPollStyle();}
window.addEventListener('orientationchange',function(){resetPollStyle();});if(navigator.userAgent&&navigator.userAgent.match(/Windows Phone/i)){$(window).on('resize',function(){resetPollStyle();});}
pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append('<style>body { font-family: HelveticaNeue, Helvetica, Arial, sans-serif;}</style>');var font='<style>\n@font-face {\n'
font+='font-family: "HelveticaNeue";\n';font+='src:    url("'+$rootScope.appAssetsUrl+'/styles/sna-font/HelveticaNeueW23forSKY-Reg_T02.woff2")  format("woff2"),\n';font+='        url("'+$rootScope.appAssetsUrl+'/styles/sna-font/HelveticaNeueW23forSKY-Reg_T02.woff")   format("woff");\n';font+='font-weight: 400;\n';font+='font-style: normal;\n';font+='}\n</style>'
pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append(font);}
function resetPollStyle(){var h3FontSize=$(".poll-widget .poll-headline").css("font-size");var h4FontSize=$(".poll-widget .poll-answer").css("font-size");var style='.pds-question-top { font-size:'+h3FontSize+' !important;}\n';style+='.pds-input-label { font-size:'+h4FontSize+' !important;}\n';style+='.pds-answer-text { font-size:'+h4FontSize+' !important;}\n';style+='.pds-vote-button { font-size:'+h4FontSize+' !important;}\n';style+='.pds-return-poll { font-size:'+h4FontSize+' !important;}\n';style+='.pds-return-poll {margin-top: 0 !important;}\n';style+='.pds-vote {margin-top: 10px !important;}\n'
pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollStyle').html(style);}}]);snaApp.config(function($locationProvider){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("msie 9.0")==-1){$locationProvider.html5Mode({enabled:true,requireBase:false,rewriteLinks:false});}});snaApp.controller("teaserController",["$scope","$http","appConfig","$window","$log","$location","$rootScope","$timeout","$interval","$sce","$filter",function($scope,$http,appConfig,$window,$log,$location,$rootScope,$timeout,$interval,$sce,$filter){$scope.hideTeaser=false;$scope.isTeaserVisible=true;$scope.isTeaserHavingData=false;var LastelemEvent;var isCarouselInit=false;var slickStartedPlaying;var clearRefreshTickerInterval;var timeForRefresh=900000;var initialTimeToLoadTeaserInPage=4000;var speedOfTeasers=6000;var isFirstTimeShow;var $arrow;function loadTeasers(isRefreshTeaser){$scope.isTeaserHavingData=false;$scope.hideTeaser=false;var articleIdsToExclude='';if(sessionStorage.getItem('alreadyReadArticleIds')){articleIdsToExclude=sessionStorage.getItem('alreadyReadArticleIds');}
if(isRefreshTeaser){$('.articleTeaserCont').clearQueue();$(".articleTeaserCont").animate({right:'-25rem'},500,function(){});}
$http.get(appConfig.apiBaseURL+'/rest/v2/teasers.json',{cache:false,params:{'idsToExclude':articleIdsToExclude}}).then(function(data,status,headers,config){var data=response.data;var absUrl=$location.absUrl();var currentArticleId=absUrl.match(/\/web\/article\/(\d+)\//)[1];var teaserDataList=data.contentItems;slickStartedPlaying=false;if(!isRefreshTeaser){$(".articleTeaserCont").css("right","-25rem");}
$scope.teasersList='';jQuery(".teaserBody").remove();if($(".teaserBodyCont.slick-initialized").length>0){$(".teaserBodyCont.slick-initialized").slick("unslick");}
if(data&&teaserDataList&&teaserDataList.length>0){teaserDataList=teaserDataList.filter(function(val){if(val.id==currentArticleId){return false;}else{return true;}});$scope.teasersList=teaserDataList;if(teaserDataList.length==1){$scope.isTeaserHavingData=true;slickStartedPlaying=true;setTimeout(function(){var $articleContent=$(".article-content");var $articleTags=$('.article-tags');$('.arrow.out').each(function(){if((!$arrow||$arrow.offset().top<=0)&&$(this).is(':visible')&&$(this).offset().top>0){$arrow=$(this);return;}});if(getIEVersion()==11||isIEEdge()){$("body").off("scroll.teaserScroll");$("body").on("scroll.teaserScroll",function(){showTeaser($articleTags,$arrow)});}else{$(window).off("scroll.teaserScroll");$(window).on("scroll.teaserScroll",function(){showTeaser($articleTags,$arrow)});}
$scope.isTeaserVisible=false;showTeaser($articleTags,$arrow,true);},200);}else if(teaserDataList.length>0){LastelemEvent&&LastelemEvent();LastelemEvent=$scope.$on('LastElem',function(event){$scope.isTeaserHavingData=true;setTimeout(function(){var $articleContent=$(".article-content");var $articleTags=$('.article-tags');$('.arrow.out').each(function(){if((!$arrow||$arrow.offset().top<=0)&&$(this).is(':visible')&&$(this).offset().top>0){$arrow=$(this);return;}});if(getIEVersion()==11||isIEEdge()){$("body").off("scroll.teaserScroll");$("body").on("scroll.teaserScroll",function(){showTeaser($articleTags,$arrow)});}else{$(window).off("scroll.teaserScroll");$(window).on("scroll.teaserScroll",function(){showTeaser($articleTags,$arrow)});}
$scope.isTeaserVisible=false;showTeaser($articleTags,$arrow,true);},200);});}}});}
function initTeaser(){if($rootScope.deviceType=='DESKTOP'){loadTeasers();if(clearRefreshTickerInterval){$interval.cancel(clearRefreshTickerInterval);}
clearRefreshTickerInterval=$interval(function(){loadTeasers(true);},timeForRefresh);}}
$rootScope.$on('$locationChangeSuccess',function(event){initTeaser();});$rootScope.$on('$locationChangeStart',function(event){});$scope.closeTeaser=function(){if($scope.isTeaserVisible){$scope.isTeaserVisible=false;$scope.hideTeaser=true;$(".articleTeaserCont").css("right","-25rem");}};function showTeaser($articleTags,$arrow,isFirstTimeLoad){if($scope.hideTeaser||!$scope.isTeaserHavingData){return;}
if(!$arrow){$('.arrow.out').each(function(){if((!$arrow||$arrow.offset().top<=0)&&$(this).is(':visible')&&$(this).offset().top>0){$arrow=$(this);return;}});}
if(!$arrow){return;}
articleTagOffset=$articleTags.offset().top;arrowOffset=$arrow.offset().top;arrowHeight=$arrow.height();if((arrowOffset>articleTagOffset-arrowHeight)&&!$scope.hideTeaser&&!$scope.isTeaserVisible){if(!slickStartedPlaying){slickStartedPlaying=true;$('.teaserBodyCont').slick({infinite:true,slidesToShow:1,slidesToScroll:1,autoplay:true,autoplaySpeed:speedOfTeasers,arrows:false,rtl:true,dots:false});}
$('.teaserBodyCont.slick-initialized').slick("slickPause");$scope.isTeaserVisible=true;$(".articleTeaserCont").animate({right:'0'},500,function(){$('.teaserBodyCont.slick-initialized').slick("slickPlay");$scope.$evalAsync(function($scope){$scope.isTeaserHavingData=true;$scope.isTeaserVisible=true;});});}else if((arrowOffset<=articleTagOffset-arrowHeight)&&!$scope.hideTeaser&&$scope.isTeaserVisible){$scope.isTeaserVisible=false;$('.teaserBodyCont.slick-initialized').slick("slickPause");$(".articleTeaserCont").animate({right:'-25rem'},500,function(){$scope.$evalAsync(function($scope){$scope.isTeaserVisible=false;});});}}
$scope.goToTeaserPage=function(teaserId){var url='/'+$rootScope.webContext+'/article/'+teaserId;$window.location.href=url;}
$(window).on('resize',function(){if($rootScope.deviceType!='DESKTOP'){$scope.$evalAsync(function($scope){$scope.isTeaserVisible=false;$scope.hideTeaser=true;$(".articleTeaserCont").css("right","-25rem");});}else if($rootScope.deviceType=='DESKTOP'){$scope.$evalAsync(function($scope){$scope.isTeaserVisible=false;$scope.hideTeaser=false;});$scope.isTeaserVisible=false;var $articleContent=$(".article-content");var $articleTags=$('.article-tags');$('.arrow.out').each(function(){if((!$arrow||$arrow.offset().top<=0)&&$(this).is(':visible')&&$(this).offset().top>0){$arrow=$(this);return;}});showTeaser($articleTags,$arrow);}});}]);snaApp.directive('myRepeatDirective',function(){return function(scope,element,attrs){if(scope.$last){scope.$emit('LastElem');}};});'use strict'
snaApp.directive("snaYoutubeVideo",['$rootScope','$interval','$timeout','$http','appConfig','$log','$window','videoPlayer','$filter','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$window,videoPlayer,$filter,$sce){var controller=new ScrollMagic.Controller(),scrollUpScene,scrollDownScene,latestFlyingVideo,fullScreen=false,isIE=getIEVersion()>0,index=0;function link(scope,element,attrs){var playerContElem=element.find('.yt-player-div')[0];var flyingout=false;var ytPlayer;scope.isIE11=getIEVersion()==11?true:false;var autoPlay=scope.autoPlay||false;function onPlayerReady(){if(scope.changeUrl){if(!$("#"+scope.modalContId).is(":visible")){return;}
ytPlayer.cueVideoById(scope.ytVideoId,0,"default");if(autoPlay&&$rootScope.device=='DESKTOP'){ytPlayer.playVideo();}}else{scope.$applyAsync(function(){ytPlayer.playerCustomReady=true;scope.playerCustomReady=ytPlayer.playerCustomReady;});}
scope.$applyAsync(function(){scope.videoLoaded=true;scope.playerLoaded=true;});}
function onStateChange(event){if(event.data==YT.PlayerState.PLAYING){ytPlayer.status='PLAYING';scope.$applyAsync(function(){ytPlayer.playerCustomReady=true;scope.playerCustomReady=ytPlayer.playerCustomReady;});if(scope.flyout){if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);destroyScenes();}
if(window.activeJWPlayer){window.activeJWPlayer.pause(true);window.activeJWPlayer.closeFlyout();}
typeof(playRadio)!='undefined'&&playRadio(true);if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'&&(window.activeYtPlayer!=ytPlayer)){window.activeYtPlayer.pauseVideo();}
window.activeYtPlayer=ytPlayer;ytPlayer.closeFlyout=scope.closeFlyout;}
if(event.data==YT.PlayerState.PAUSED){ytPlayer.status='PAUSED';}
if(event.data==YT.PlayerState.ENDED){ytPlayer.status='ENDED';}
if(event.data==YT.PlayerState.BUFFERING){ytPlayer.status='BUFFERING';}}
function ytPlayerFullScreenChangeEventHandler(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(fullscreenElement){ytPlayer.isFullscreen=true;}else{setTimeout(function(){ytPlayer.isFullscreen=false;},2000);}}
var ytPlayerCode=function(ytVideoId){if(playerContElem){if(scope.changeUrl){ytVideoId='';}else{ytVideoId=scope.ytVideoId||attrs.oneTimeBindYtVideoId;}
ytPlayer=new YT.Player(playerContElem,{width:playerContElem.clientWidth,videoId:ytVideoId,events:{'onReady':onPlayerReady,'onStateChange':onStateChange},playerVars:{rel:0}});ytPlayer.closeFlyout=scope.closeFlyout;$rootScope.activeYtPlayers.push(ytPlayer);ytPlayer.isFullscreen=false;if('onwebkitfullscreenchange'in document.createElement('div')){document.addEventListener("webkitfullscreenchange",ytPlayerFullScreenChangeEventHandler);}else if('onmozfullscreenchange'in document.createElement('div')){document.addEventListener("mozfullscreenchange",ytPlayerFullScreenChangeEventHandler);}else if('onfullscreenchange'in document.createElement('div')){document.addEventListener("fullscreenchange",ytPlayerFullScreenChangeEventHandler);}else{document.addEventListener("MSFullscreenChange",ytPlayerFullScreenChangeEventHandler);}}};var ytChangeVideo=function(ytVideoId){if(playerContElem){if(!ytPlayer){return;}
ytPlayer.loadVideoById(scope.ytVideoId,0,"default");}};var startWatchYtVideoId=function(){var watchForVideoID=scope.$watch('ytVideoId',function(newValue,oldValue){if(typeof newValue==="undefined"||(newValue==oldValue)){return;}
scope.ytVideoId=newValue;});}
if(scope.changeUrl){youtubePlayerInit(ytPlayerCode);startWatchYtVideoId();}else{youtubePlayerInit(ytPlayerCode);}
scope.closeFlyout=function(){if(!flyingout){return;}
flyingout=false;destroyScenes();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:'',width:''});video.removeClass('flyout-prepare');element.find('#flyoutButtonsDiv').hide();ytPlayer.pauseVideo();}
function destroyScenes(){if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}}
function createScenes(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}
scrollDownScene=new ScrollMagic.Scene({triggerElement:element[0],offset:-100,triggerHook:0,}).on('enter',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}else if(ytPlayer.status=='ENDED'||ytPlayer.status=='PAUSED'){return;}
scrollDownEnter(element);flyingout=true;}).on('leave',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}
scrollDownLeave(element);flyingout=false;});scrollUpScene=new ScrollMagic.Scene({triggerElement:element[0],offset:0,duration:0,triggerHook:1,}).on('enter',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||!flyingout||fullscreenElement){return;}
scrollUpEnter(element);scrollUpScene.offset(0);flyingout=false;}).on('leave',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}else if(ytPlayer.status=='ENDED'||ytPlayer.status=='PAUSED'){return;}
scrollUpLeave(element);scrollUpScene.offset(element.height()+100);flyingout=true;})
controller.addScene(scrollUpScene);controller.addScene(scrollDownScene);}
function scrollDownEnter(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'100px',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0,"onComplete":function(){video.css({top:''});}});}
function scrollDownLeave(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video'),offset=element[0].getBoundingClientRect();if(offset.bottom<0){offset={bottom:$(window).height(),left:offset.left,right:offset.right,top:offset.top};}
video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}
function scrollUpLeave(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0});}
function scrollUpEnter(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video');video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}}
return{restrict:'E',scope:{ytVideoId:'=ytVideoId',imageSrc:'=imageSrc',autoPlay:'=autoPlay',changeUrl:'=changeUrl',videoComplete:'&videoComplete',videoPause:'&videoPause',videoPlay:'&videoPlay',flyout:'=flyout',postLoad:'=postload',contentUrl:'=contentUrl',modalContId:'@modalContId',oneTimeBindYtVideoId:'@oneTimeBindYtVideoId'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaYoutubeVideo.html"}}]);'use strict';snaApp.directive("snaFullScreenImageViewer",['$rootScope','$interval','$timeout','$http','appConfig','$log','$location','$compile',function($rootScope,$interval,$timeout,$http,appConfig,$log,$location,$compile){var listenForBrowserHistoryChange;var unBindLocationChangeEvent;var options;function link(scope,element){var pswpElem=element.find(".pswp")[0];var defaultOptions={"closeOnScroll":false,"history":false,"galleryUID":1,"zoomEl":false,"shareEl":true,"preload":[2,1],"errorMsg":'<div class="pswp__error-msg">    <a href="%url%" target="_blank"></a> </div>',"timeToIdle":10000000,"clickToCloseNonZoomable":false,"shareButtons":[{id:'share',shareUrl:'{{shareUrl}}',shareHeadline:'{{shareHeadline}}',shortUrl:'{{shortUrl}}',shareSummary:'{{shareSummary}}',shareMainMediaUrl:'{{shareMainMediaUrl}}'},],"parseShareButtonOut":function(shareButtonData,shareButtonOut,shareObj){var snaShareEl;var newScope;newScope=$rootScope.$new();newScope.shareUrl=shareObj.shareUrl;newScope.shareHeadline=shareObj.shareHeadline;newScope.shortUrl=shareObj.shortUrl;newScope.shareSummary=shareObj.shareSummary;newScope.shareMainMediaUrl=shareObj.shareMainMediaUrl;newScope.hidePrint=true;snaShareEl=angular.element("<div class='pswp__share-tooltip--open-close-btn'><button class='pswp__button pswp__button--share ' title='open/close share'></button></div><sna-share share-url='shareUrl' share-headline='shareHeadline' short-url='shortUrl' share-summary='shareSummary' hide-print='hidePrint' share-main-media-url='{{shareMainMediaUrl}}'></sna-share>");$compile(snaShareEl)(newScope);return snaShareEl;}}
scope.imageData=JSON.parse(scope.imageData);scope.imageData=getImageDataForRTLSwipe(scope.imageData);scope.options=JSON.parse(scope.options);scope.options=$.extend({},defaultOptions,scope.options);scope.options.index=getCorrectIndexForRTL(scope.options.index,scope.imageData.length);options=scope.options;$rootScope.scrollPosBeforeFullScreenImageOpen=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;var gallery=new PhotoSwipe(pswpElem,PhotoSwipeUI_Default,scope.imageData,options);gallery.init();if($rootScope.device=="DESKTOP"){$("body").css("overflow-y","hidden");}
addOpenFullScreenViewerToHistory(scope,gallery);var indexIndicatorDOMElement=document.querySelectorAll('.pswp__counter')[0];gallery.ui.updateIndexIndicator=function(){var counterToShow;var counterInScreen=gallery.getCurrentIndex()+1;var totalItems=gallery.options.getNumItemsFn()
if(counterInScreen==1){counterToShow=counterInScreen;}else{counterToShow=(counterInScreen+((-1*(totalItems-1))+((totalItems-counterInScreen)*2)))+1;}
indexIndicatorDOMElement.innerHTML=(counterToShow)
+gallery.options.indexIndicatorSep
+gallery.options.getNumItemsFn();};gallery.ui.updateIndexIndicator();gallery.listen('close',function(){if($rootScope.device=="DESKTOP"){$("body").css("overflow-y","");}
var index;var totalItems=gallery.options.getNumItemsFn();index=gallery.getCurrentIndex();if(index==0){index=index;}else{index=(totalItems-index);}
if(typeof scope.onCloseCallback!="undefined"&&!!scope.onCloseCallback){$rootScope[scope.onCloseCallback](scope.onCloseCallback,index,JSON.parse(scope.options).galleryUID);}
var updateScrollafterPopstate=function(e){window.scrollTo(0,$rootScope.scrollPosBeforeFullScreenImageOpen);};window.addEventListener('scroll',updateScrollafterPopstate,'',true);if(isBrowserListeningHistory()){window.history.go(-1);stoplistenForBrowserUrlHistoryChange();}
setTimeout(function(){element.remove();},50);setTimeout(function(){window.removeEventListener('scroll',updateScrollafterPopstate);},500);});gallery.listen('afterChange',function(){if(typeof scope.onChangeCallback!="undefined"&&!!scope.onChangeCallback){$rootScope[scope.onChangeCallback](scope.onChangeCallback,JSON.parse(scope.options).galleryUID,gallery.currItem.id,gallery.currItem.shareHeadline);}});}
function getImageDataForRTLSwipe(imageData){if(imageData.length>1){var firstElTempArr;var tempArr;firstElTempArr=imageData.slice(0,1);tempArr=imageData.slice(1,imageData.length);tempArr=tempArr.reverse();imageData=firstElTempArr.concat(tempArr);}
return imageData;}
function getCorrectIndexForRTL(index,totalItems){if(index>0){index=totalItems-index;}
return index;}
function isHistoryEnabled(){if(Modernizr.history){return true;}
return false;}
function addOpenFullScreenViewerToHistory(scope,gallery){if(isHistoryEnabled()){scope.$applyAsync(function(){var path=$location.path();$location.path(path);$location.hash("fullScreenImageViewer"+options.galleryUID);$location.state({"fullScreenImageViewerOpen":true});setTimeout(function(){bindHistoryPopState(scope,gallery);},100)});}}
function bindHistoryPopState(scope,gallery){if(!isHistoryEnabled()){return;}
unBindLocationChangeEvent&&unBindLocationChangeEvent();startlistenForBrowserUrlHistoryChange();unBindLocationChangeEvent=scope.$on('$locationChangeSuccess',function(event,newUrl,oldUrl,newState,oldState){if(isBrowserListeningHistory()){historyPopState(oldState,gallery);}});}
function startlistenForBrowserUrlHistoryChange(){listenForBrowserHistoryChange=true;}
function stoplistenForBrowserUrlHistoryChange(){listenForBrowserHistoryChange=false;}
function isBrowserListeningHistory(){return listenForBrowserHistoryChange;}
function historyPopState(oldState,gallery){if(oldState.fullScreenImageViewerOpen){stoplistenForBrowserUrlHistoryChange();gallery.close();}}
return{restrict:'E',transclude:true,scope:{imageData:'@',galleryId:'@',options:'@',onCloseCallback:'@',onChangeCallback:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaFullScreenImageViewer.html"}}]);