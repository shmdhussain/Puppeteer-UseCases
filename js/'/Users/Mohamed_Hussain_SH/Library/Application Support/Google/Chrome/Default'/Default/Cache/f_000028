
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.ScrollMagic=t()}(this,function(){"use strict";var e=function(){};e.version="2.0.5",window.addEventListener("mousewheel",function(){});var t="data-scrollmagic-pin-spacer";e.Controller=function(r){var o,s,a="ScrollMagic.Controller",l="FORWARD",c="REVERSE",u="PAUSED",f=n.defaults,d=this,h=i.extend({},f,r),g=[],p=!1,v=0,m=u,w=!0,y=0,S=!0,b=function(){for(var e in h)f.hasOwnProperty(e)||delete h[e];if(h.container=i.get.elements(h.container)[0],!h.container)throw a+" init failed.";w=h.container===window||h.container===document.body||!document.body.contains(h.container),w&&(h.container=window),y=z(),h.container.addEventListener("resize",T),h.container.addEventListener("scroll",T),h.refreshInterval=parseInt(h.refreshInterval)||f.refreshInterval,E()},E=function(){h.refreshInterval>0&&(s=window.setTimeout(A,h.refreshInterval))},x=function(){return h.vertical?i.get.scrollTop(h.container):i.get.scrollLeft(h.container)},z=function(){return h.vertical?i.get.height(h.container):i.get.width(h.container)},C=this._setScrollPos=function(e){h.vertical?w?window.scrollTo(i.get.scrollLeft(),e):h.container.scrollTop=e:w?window.scrollTo(e,i.get.scrollTop()):h.container.scrollLeft=e},F=function(){if(S&&p){var e=i.type.Array(p)?p:g.slice(0);p=!1;var t=v;v=d.scrollPos();var n=v-t;0!==n&&(m=n>0?l:c),m===c&&e.reverse(),e.forEach(function(e){e.update(!0)})}},L=function(){o=i.rAF(F)},T=function(e){"resize"==e.type&&(y=z(),m=u),p!==!0&&(p=!0,L())},A=function(){if(!w&&y!=z()){var e;try{e=new Event("resize",{bubbles:!1,cancelable:!1})}catch(t){e=document.createEvent("Event"),e.initEvent("resize",!1,!1)}h.container.dispatchEvent(e)}g.forEach(function(e){e.refresh()}),E()};this._options=h;var O=function(e){if(e.length<=1)return e;var t=e.slice(0);return t.sort(function(e,t){return e.scrollOffset()>t.scrollOffset()?1:-1}),t};return this.addScene=function(t){if(i.type.Array(t))t.forEach(function(e){d.addScene(e)});else if(t instanceof e.Scene)if(t.controller()!==d)t.addTo(d);else if(g.indexOf(t)<0){g.push(t),g=O(g),t.on("shift.controller_sort",function(){g=O(g)});for(var n in h.globalSceneOptions)t[n]&&t[n].call(t,h.globalSceneOptions[n])}return d},this.removeScene=function(e){if(i.type.Array(e))e.forEach(function(e){d.removeScene(e)});else{var t=g.indexOf(e);t>-1&&(e.off("shift.controller_sort"),g.splice(t,1),e.remove())}return d},this.updateScene=function(t,n){return i.type.Array(t)?t.forEach(function(e){d.updateScene(e,n)}):n?t.update(!0):p!==!0&&t instanceof e.Scene&&(p=p||[],-1==p.indexOf(t)&&p.push(t),p=O(p),L()),d},this.update=function(e){return T({type:"resize"}),e&&F(),d},this.scrollTo=function(n,r){if(i.type.Number(n))C.call(h.container,n,r);else if(n instanceof e.Scene)n.controller()===d&&d.scrollTo(n.scrollOffset(),r);else if(i.type.Function(n))C=n;else{var o=i.get.elements(n)[0];if(o){for(;o.parentNode.hasAttribute(t);)o=o.parentNode;var s=h.vertical?"top":"left",a=i.get.offset(h.container),l=i.get.offset(o);w||(a[s]-=d.scrollPos()),d.scrollTo(l[s]-a[s],r)}}return d},this.scrollPos=function(e){return arguments.length?(i.type.Function(e)&&(x=e),d):x.call(d)},this.info=function(e){var t={size:y,vertical:h.vertical,scrollPos:v,scrollDirection:m,container:h.container,isDocument:w};return arguments.length?void 0!==t[e]?t[e]:void 0:t},this.loglevel=function(){return d},this.enabled=function(e){return arguments.length?(S!=e&&(S=!!e,d.updateScene(g,!0)),d):S},this.destroy=function(e){window.clearTimeout(s);for(var t=g.length;t--;)g[t].destroy(e);return h.container.removeEventListener("resize",T),h.container.removeEventListener("scroll",T),i.cAF(o),null},b(),d};var n={defaults:{container:window,vertical:!0,globalSceneOptions:{},loglevel:2,refreshInterval:100}};e.Controller.addOption=function(e,t){n.defaults[e]=t},e.Controller.extend=function(t){var n=this;e.Controller=function(){return n.apply(this,arguments),this.$super=i.extend({},this),t.apply(this,arguments)||this},i.extend(e.Controller,n),e.Controller.prototype=n.prototype,e.Controller.prototype.constructor=e.Controller},e.Scene=function(n){var o,s,a="BEFORE",l="DURING",c="AFTER",u=r.defaults,f=this,d=i.extend({},u,n),h=a,g=0,p={start:0,end:0},v=0,m=!0,w=function(){for(var e in d)u.hasOwnProperty(e)||delete d[e];for(var t in u)L(t);C()},y={};this.on=function(e,t){return i.type.Function(t)&&(e=e.trim().split(" "),e.forEach(function(e){var n=e.split("."),r=n[0],i=n[1];"*"!=r&&(y[r]||(y[r]=[]),y[r].push({namespace:i||"",callback:t}))})),f},this.off=function(e,t){return e?(e=e.trim().split(" "),e.forEach(function(e){var n=e.split("."),r=n[0],i=n[1]||"",o="*"===r?Object.keys(y):[r];o.forEach(function(e){for(var n=y[e]||[],r=n.length;r--;){var o=n[r];!o||i!==o.namespace&&"*"!==i||t&&t!=o.callback||n.splice(r,1)}n.length||delete y[e]})}),f):f},this.trigger=function(t,n){if(t){var r=t.trim().split("."),i=r[0],o=r[1],s=y[i];s&&s.forEach(function(t){o&&o!==t.namespace||t.callback.call(f,new e.Event(i,t.namespace,f,n))})}return f},f.on("change.internal",function(e){"loglevel"!==e.what&&"tweenChanges"!==e.what&&("triggerElement"===e.what?E():"reverse"===e.what&&f.update())}).on("shift.internal",function(){S(),f.update()}),this.addTo=function(t){return t instanceof e.Controller&&s!=t&&(s&&s.removeScene(f),s=t,C(),b(!0),E(!0),S(),s.info("container").addEventListener("resize",x),t.addScene(f),f.trigger("add",{controller:s}),f.update()),f},this.enabled=function(e){return arguments.length?(m!=e&&(m=!!e,f.update(!0)),f):m},this.remove=function(){if(s){s.info("container").removeEventListener("resize",x);var e=s;s=void 0,e.removeScene(f),f.trigger("remove")}return f},this.destroy=function(e){return f.trigger("destroy",{reset:e}),f.remove(),f.off("*.*"),null},this.update=function(e){if(s)if(e)if(s.enabled()&&m){var t,n=s.info("scrollPos");t=d.duration>0?(n-p.start)/(p.end-p.start):n>=p.start?1:0,f.trigger("update",{startPos:p.start,endPos:p.end,scrollPos:n}),f.progress(t)}else T&&h===l&&O(!0);else s.updateScene(f,!1);return f},this.refresh=function(){return b(),E(),f},this.progress=function(e){if(arguments.length){var t=!1,n=h,r=s?s.info("scrollDirection"):"PAUSED",i=d.reverse||e>=g;if(0===d.duration?(t=g!=e,g=1>e&&i?0:1,h=0===g?a:l):0>e&&h!==a&&i?(g=0,h=a,t=!0):e>=0&&1>e&&i?(g=e,h=l,t=!0):e>=1&&h!==c?(g=1,h=c,t=!0):h!==l||i||O(),t){var o={progress:g,state:h,scrollDirection:r},u=h!=n,p=function(e){f.trigger(e,o)};u&&n!==l&&(p("enter"),p(n===a?"start":"end")),p("progress"),u&&h!==l&&(p(h===a?"start":"end"),p("leave"))}return f}return g};var S=function(){p={start:v+d.offset},s&&d.triggerElement&&(p.start-=s.info("size")*d.triggerHook),p.end=p.start+d.duration},b=function(e){if(o){var t="duration";F(t,o.call(f))&&!e&&(f.trigger("change",{what:t,newval:d[t]}),f.trigger("shift",{reason:t}))}},E=function(e){var n=0,r=d.triggerElement;if(s&&r){for(var o=s.info(),a=i.get.offset(o.container),l=o.vertical?"top":"left";r.parentNode.hasAttribute(t);)r=r.parentNode;var c=i.get.offset(r);o.isDocument||(a[l]-=s.scrollPos()),n=c[l]-a[l]}var u=n!=v;v=n,u&&!e&&f.trigger("shift",{reason:"triggerElementPosition"})},x=function(){d.triggerHook>0&&f.trigger("shift",{reason:"containerResize"})},z=i.extend(r.validate,{duration:function(e){if(i.type.String(e)&&e.match(/^(\.|\d)*\d+%$/)){var t=parseFloat(e)/100;e=function(){return s?s.info("size")*t:0}}if(i.type.Function(e)){o=e;try{e=parseFloat(o())}catch(n){e=-1}}if(e=parseFloat(e),!i.type.Number(e)||0>e)throw o?(o=void 0,0):0;return e}}),C=function(e){e=arguments.length?[e]:Object.keys(z),e.forEach(function(e){var t;if(z[e])try{t=z[e](d[e])}catch(n){t=u[e]}finally{d[e]=t}})},F=function(e,t){var n=!1,r=d[e];return d[e]!=t&&(d[e]=t,C(e),n=r!=d[e]),n},L=function(e){f[e]||(f[e]=function(t){return arguments.length?("duration"===e&&(o=void 0),F(e,t)&&(f.trigger("change",{what:e,newval:d[e]}),r.shifts.indexOf(e)>-1&&f.trigger("shift",{reason:e})),f):d[e]})};this.controller=function(){return s},this.state=function(){return h},this.scrollOffset=function(){return p.start},this.triggerPosition=function(){var e=d.offset;return s&&(e+=d.triggerElement?v:s.info("size")*f.triggerHook()),e};var T,A;f.on("shift.internal",function(e){var t="duration"===e.reason;(h===c&&t||h===l&&0===d.duration)&&O(),t&&_()}).on("progress.internal",function(){O()}).on("add.internal",function(){_()}).on("destroy.internal",function(e){f.removePin(e.reset)});var O=function(e){if(T&&s){var t=s.info(),n=A.spacer.firstChild;if(e||h!==l){var r={position:A.inFlow?"relative":"absolute",top:0,left:0},o=i.css(n,"position")!=r.position;A.pushFollowers?d.duration>0&&(h===c&&0===parseFloat(i.css(A.spacer,"padding-top"))?o=!0:h===a&&0===parseFloat(i.css(A.spacer,"padding-bottom"))&&(o=!0)):r[t.vertical?"top":"left"]=d.duration*g,i.css(n,r),o&&_()}else{"fixed"!=i.css(n,"position")&&(i.css(n,{position:"fixed"}),_());var u=i.get.offset(A.spacer,!0),f=d.reverse||0===d.duration?t.scrollPos-p.start:Math.round(g*d.duration*10)/10;u[t.vertical?"top":"left"]+=f,i.css(A.spacer.firstChild,{top:u.top,left:u.left})}}},_=function(){if(T&&s&&A.inFlow){var e=h===l,t=s.info("vertical"),n=A.spacer.firstChild,r=i.isMarginCollapseType(i.css(A.spacer,"display")),o={};A.relSize.width||A.relSize.autoFullWidth?e?i.css(T,{width:i.get.width(A.spacer)}):i.css(T,{width:"100%"}):(o["min-width"]=i.get.width(t?T:n,!0,!0),o.width=e?o["min-width"]:"auto"),A.relSize.height?e?i.css(T,{height:i.get.height(A.spacer)-(A.pushFollowers?d.duration:0)}):i.css(T,{height:"100%"}):(o["min-height"]=i.get.height(t?n:T,!0,!r),o.height=e?o["min-height"]:"auto"),A.pushFollowers&&(o["padding"+(t?"Top":"Left")]=d.duration*g,o["padding"+(t?"Bottom":"Right")]=d.duration*(1-g)),i.css(A.spacer,o)}},N=function(){s&&T&&h===l&&!s.info("isDocument")&&O()},P=function(){s&&T&&h===l&&((A.relSize.width||A.relSize.autoFullWidth)&&i.get.width(window)!=i.get.width(A.spacer.parentNode)||A.relSize.height&&i.get.height(window)!=i.get.height(A.spacer.parentNode))&&_()},D=function(e){s&&T&&h===l&&!s.info("isDocument")&&(e.preventDefault(),s._setScrollPos(s.info("scrollPos")-((e.wheelDelta||e[s.info("vertical")?"wheelDeltaY":"wheelDeltaX"])/3||30*-e.detail)))};this.setPin=function(e,n){var r={pushFollowers:!0,spacerClass:"scrollmagic-pin-spacer"};if(n=i.extend({},r,n),e=i.get.elements(e)[0],!e)return f;if("fixed"===i.css(e,"position"))return f;if(T){if(T===e)return f;f.removePin()}T=e;var o=T.parentNode.style.display,s=["top","left","bottom","right","margin","marginLeft","marginRight","marginTop","marginBottom"];T.parentNode.style.display="none";var a="absolute"!=i.css(T,"position"),l=i.css(T,s.concat(["display"])),c=i.css(T,["width","height"]);T.parentNode.style.display=o,!a&&n.pushFollowers&&(n.pushFollowers=!1);var u=T.parentNode.insertBefore(document.createElement("div"),T),d=i.extend(l,{position:a?"relative":"absolute",boxSizing:"content-box",mozBoxSizing:"content-box",webkitBoxSizing:"content-box"});if(a||i.extend(d,i.css(T,["width","height"])),i.css(u,d),u.setAttribute(t,""),i.addClass(u,n.spacerClass),A={spacer:u,relSize:{width:"%"===c.width.slice(-1),height:"%"===c.height.slice(-1),autoFullWidth:"auto"===c.width&&a&&i.isMarginCollapseType(l.display)},pushFollowers:n.pushFollowers,inFlow:a},!T.___origStyle){T.___origStyle={};var h=T.style,g=s.concat(["width","height","position","boxSizing","mozBoxSizing","webkitBoxSizing"]);g.forEach(function(e){T.___origStyle[e]=h[e]||""})}return A.relSize.width&&i.css(u,{width:c.width}),A.relSize.height&&i.css(u,{height:c.height}),u.appendChild(T),i.css(T,{position:a?"relative":"absolute",margin:"auto",top:"auto",left:"auto",bottom:"auto",right:"auto"}),(A.relSize.width||A.relSize.autoFullWidth)&&i.css(T,{boxSizing:"border-box",mozBoxSizing:"border-box",webkitBoxSizing:"border-box"}),window.addEventListener("scroll",N),window.addEventListener("resize",N),window.addEventListener("resize",P),T.addEventListener("mousewheel",D),T.addEventListener("DOMMouseScroll",D),O(),f},this.removePin=function(e){if(T){if(h===l&&O(!0),e||!s){var n=A.spacer.firstChild;if(n.hasAttribute(t)){var r=A.spacer.style,o=["margin","marginLeft","marginRight","marginTop","marginBottom"];margins={},o.forEach(function(e){margins[e]=r[e]||""}),i.css(n,margins)}A.spacer.parentNode.insertBefore(n,A.spacer),A.spacer.parentNode.removeChild(A.spacer),T.parentNode.hasAttribute(t)||(i.css(T,T.___origStyle),delete T.___origStyle)}window.removeEventListener("scroll",N),window.removeEventListener("resize",N),window.removeEventListener("resize",P),T.removeEventListener("mousewheel",D),T.removeEventListener("DOMMouseScroll",D),T=void 0}return f};var R,k=[];return f.on("destroy.internal",function(e){f.removeClassToggle(e.reset)}),this.setClassToggle=function(e,t){var n=i.get.elements(e);return 0!==n.length&&i.type.String(t)?(k.length>0&&f.removeClassToggle(),R=t,k=n,f.on("enter.internal_class leave.internal_class",function(e){var t="enter"===e.type?i.addClass:i.removeClass;k.forEach(function(e){t(e,R)})}),f):f},this.removeClassToggle=function(e){return e&&k.forEach(function(e){i.removeClass(e,R)}),f.off("start.internal_class end.internal_class"),R=void 0,k=[],f},w(),f};var r={defaults:{duration:0,offset:0,triggerElement:void 0,triggerHook:.5,reverse:!0,loglevel:2},validate:{offset:function(e){if(e=parseFloat(e),!i.type.Number(e))throw 0;return e},triggerElement:function(e){if(e=e||void 0){var t=i.get.elements(e)[0];if(!t)throw 0;e=t}return e},triggerHook:function(e){var t={onCenter:.5,onEnter:1,onLeave:0};if(i.type.Number(e))e=Math.max(0,Math.min(parseFloat(e),1));else{if(!(e in t))throw 0;e=t[e]}return e},reverse:function(e){return!!e}},shifts:["duration","offset","triggerHook"]};e.Scene.addOption=function(e,t,n,i){e in r.defaults||(r.defaults[e]=t,r.validate[e]=n,i&&r.shifts.push(e))},e.Scene.extend=function(t){var n=this;e.Scene=function(){return n.apply(this,arguments),this.$super=i.extend({},this),t.apply(this,arguments)||this},i.extend(e.Scene,n),e.Scene.prototype=n.prototype,e.Scene.prototype.constructor=e.Scene},e.Event=function(e,t,n,r){r=r||{};for(var i in r)this[i]=r[i];return this.type=e,this.target=this.currentTarget=n,this.namespace=t||"",this.timeStamp=this.timestamp=Date.now(),this};var i=e._util=function(e){var t,n={},r=function(e){return parseFloat(e)||0},i=function(t){return t.currentStyle?t.currentStyle:e.getComputedStyle(t)},o=function(t,n,o,s){if(n=n===document?e:n,n===e)s=!1;else if(!f.DomElement(n))return 0;t=t.charAt(0).toUpperCase()+t.substr(1).toLowerCase();var a=(o?n["offset"+t]||n["outer"+t]:n["client"+t]||n["inner"+t])||0;if(o&&s){var l=i(n);a+="Height"===t?r(l.marginTop)+r(l.marginBottom):r(l.marginLeft)+r(l.marginRight)}return a},s=function(e){return e.replace(/^[^a-z]+([a-z])/g,"$1").replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})};n.extend=function(e){for(e=e||{},t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e},n.isMarginCollapseType=function(e){return["block","flex","list-item","table","-webkit-box"].indexOf(e)>-1};var a=0,l=["ms","moz","webkit","o"],c=e.requestAnimationFrame,u=e.cancelAnimationFrame;for(t=0;!c&&t<l.length;++t)c=e[l[t]+"RequestAnimationFrame"],u=e[l[t]+"CancelAnimationFrame"]||e[l[t]+"CancelRequestAnimationFrame"];c||(c=function(t){var n=(new Date).getTime(),r=Math.max(0,16-(n-a)),i=e.setTimeout(function(){t(n+r)},r);return a=n+r,i}),u||(u=function(t){e.clearTimeout(t)}),n.rAF=c.bind(e),n.cAF=u.bind(e);var f=n.type=function(e){return Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase()};f.String=function(e){return"string"===f(e)},f.Function=function(e){return"function"===f(e)},f.Array=function(e){return Array.isArray(e)},f.Number=function(e){return!f.Array(e)&&e-parseFloat(e)+1>=0},f.DomElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName};var d=n.get={};return d.elements=function(t){var n=[];if(f.String(t))try{t=document.querySelectorAll(t)}catch(r){return n}if("nodelist"===f(t)||f.Array(t))for(var i=0,o=n.length=t.length;o>i;i++){var s=t[i];n[i]=f.DomElement(s)?s:d.elements(s)}else(f.DomElement(t)||t===document||t===e)&&(n=[t]);return n},d.scrollTop=function(t){return t&&"number"==typeof t.scrollTop?t.scrollTop:e.pageYOffset||0},d.scrollLeft=function(t){return t&&"number"==typeof t.scrollLeft?t.scrollLeft:e.pageXOffset||0},d.width=function(e,t,n){return o("width",e,t,n)},d.height=function(e,t,n){return o("height",e,t,n)},d.offset=function(e,t){var n={top:0,left:0};if(e&&e.getBoundingClientRect){var r=e.getBoundingClientRect();n.top=r.top,n.left=r.left,t||(n.top+=d.scrollTop(),n.left+=d.scrollLeft())}return n},n.addClass=function(e,t){t&&(e.classList?e.classList.add(t):e.className+=" "+t)},n.removeClass=function(e,t){t&&(e.classList?e.classList.remove(t):e.className=e.className.replace(RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," "))},n.css=function(e,t){if(f.String(t))return i(e)[s(t)];if(f.Array(t)){var n={},r=i(e);return t.forEach(function(e){n[e]=r[s(e)]}),n}for(var o in t){var a=t[o];a==parseFloat(a)&&(a+="px"),e.style[s(o)]=a}},n}(window||{});return e});(function(root,factory){if(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.PhotoSwipe=factory();}})(this,function(){'use strict';var PhotoSwipe=function(template,UiClass,items,options){var framework={features:null,bind:function(target,type,listener,unbind){var methodName=(unbind?'remove':'add')+'EventListener';type=type.split(' ');for(var i=0;i<type.length;i++){if(type[i]){target[methodName](type[i],listener,false);}}},isArray:function(obj){return(obj instanceof Array);},createEl:function(classes,tag){var el=document.createElement(tag||'div');if(classes){el.className=classes;}
return el;},getScrollY:function(){var yOffset=window.pageYOffset;return yOffset!==undefined?yOffset:document.documentElement.scrollTop;},unbind:function(target,type,listener){framework.bind(target,type,listener,true);},removeClass:function(el,className){var reg=new RegExp('(\\s|^)'+className+'(\\s|$)');el.className=el.className.replace(reg,' ').replace(/^\s\s*/,'').replace(/\s\s*$/,'');},addClass:function(el,className){if(!framework.hasClass(el,className)){el.className+=(el.className?' ':'')+className;}},hasClass:function(el,className){return el.className&&new RegExp('(^|\\s)'+className+'(\\s|$)').test(el.className);},getChildByClass:function(parentEl,childClassName){var node=parentEl.firstChild;while(node){if(framework.hasClass(node,childClassName)){return node;}
node=node.nextSibling;}},arraySearch:function(array,value,key){var i=array.length;while(i--){if(array[i][key]===value){return i;}}
return-1;},extend:function(o1,o2,preventOverwrite){for(var prop in o2){if(o2.hasOwnProperty(prop)){if(preventOverwrite&&o1.hasOwnProperty(prop)){continue;}
o1[prop]=o2[prop];}}},easing:{sine:{out:function(k){return Math.sin(k*(Math.PI/2));},inOut:function(k){return-(Math.cos(Math.PI*k)-1)/2;}},cubic:{out:function(k){return--k*k*k+1;}}},detectFeatures:function(){if(framework.features){return framework.features;}
var helperEl=framework.createEl(),helperStyle=helperEl.style,vendor='',features={};features.oldIE=document.all&&!document.addEventListener;features.touch='ontouchstart'in window;if(window.requestAnimationFrame){features.raf=window.requestAnimationFrame;features.caf=window.cancelAnimationFrame;}
features.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled;if(!features.pointerEvent){var ua=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var v=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);if(v&&v.length>0){v=parseInt(v[1],10);if(v>=1&&v<8){features.isOldIOSPhone=true;}}}
var match=ua.match(/Android\s([0-9\.]*)/);var androidversion=match?match[1]:0;androidversion=parseFloat(androidversion);if(androidversion>=1){if(androidversion<4.4){features.isOldAndroid=true;}
features.androidVersion=androidversion;}
features.isMobileOpera=/opera mini|opera mobi/i.test(ua);}
var styleChecks=['transform','perspective','animationName'],vendors=['','webkit','Moz','ms','O'],styleCheckItem,styleName;for(var i=0;i<4;i++){vendor=vendors[i];for(var a=0;a<3;a++){styleCheckItem=styleChecks[a];styleName=vendor+(vendor?styleCheckItem.charAt(0).toUpperCase()+styleCheckItem.slice(1):styleCheckItem);if(!features[styleCheckItem]&&styleName in helperStyle){features[styleCheckItem]=styleName;}}
if(vendor&&!features.raf){vendor=vendor.toLowerCase();features.raf=window[vendor+'RequestAnimationFrame'];if(features.raf){features.caf=window[vendor+'CancelAnimationFrame']||window[vendor+'CancelRequestAnimationFrame'];}}}
if(!features.raf){var lastTime=0;features.raf=function(fn){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){fn(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};features.caf=function(id){clearTimeout(id);};}
features.svg=!!document.createElementNS&&!!document.createElementNS('http://www.w3.org/2000/svg','svg').createSVGRect;framework.features=features;return features;}};framework.detectFeatures();if(framework.features.oldIE){framework.bind=function(target,type,listener,unbind){type=type.split(' ');var methodName=(unbind?'detach':'attach')+'Event',evName,_handleEv=function(){listener.handleEvent.call(listener);};for(var i=0;i<type.length;i++){evName=type[i];if(evName){if(typeof listener==='object'&&listener.handleEvent){if(!unbind){listener['oldIE'+evName]=_handleEv;}else{if(!listener['oldIE'+evName]){return false;}}
target[methodName]('on'+evName,listener['oldIE'+evName]);}else{target[methodName]('on'+evName,listener);}}}};}
var self=this;var DOUBLE_TAP_RADIUS=25,NUM_HOLDERS=3;var _options={allowPanToNext:true,spacing:0.12,bgOpacity:1,mouseUsed:false,loop:true,pinchToClose:true,closeOnScroll:true,closeOnVerticalDrag:true,verticalDragRange:0.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:false,focus:true,escKey:true,arrowKeys:true,mainScrollEndFriction:0.35,panEndFriction:0.35,isClickableElement:function(el){return el.tagName==='A';},getDoubleTapZoom:function(isMouseClick,item){if(isMouseClick){return 1;}else{return item.initialZoomLevel<0.7?1:1.33;}},maxSpreadZoom:1.33,modal:true,scaleMode:'fit'};framework.extend(_options,options);var _getEmptyPoint=function(){return{x:0,y:0};};var _isOpen,_isDestroying,_closedByScroll,_currentItemIndex,_containerStyle,_containerShiftIndex,_currPanDist=_getEmptyPoint(),_startPanOffset=_getEmptyPoint(),_panOffset=_getEmptyPoint(),_upMoveEvents,_downEvents,_globalEventHandlers,_viewportSize={},_currZoomLevel,_startZoomLevel,_translatePrefix,_translateSufix,_updateSizeInterval,_itemsNeedUpdate,_currPositionIndex=0,_offset={},_slideSize=_getEmptyPoint(),_itemHolders,_prevItemIndex,_indexDiff=0,_dragStartEvent,_dragMoveEvent,_dragEndEvent,_dragCancelEvent,_transformKey,_pointerEventEnabled,_isFixedPosition=true,_likelyTouchDevice,_modules=[],_requestAF,_cancelAF,_initalClassName,_initalWindowScrollY,_oldIE,_currentWindowScrollY,_features,_windowVisibleSize={},_renderMaxResolution=false,_orientationChangeTimeout,_registerModule=function(name,module){framework.extend(self,module.publicMethods);_modules.push(name);},_getLoopedId=function(index){var numSlides=_getNumItems();if(index>numSlides-1){return index-numSlides;}else if(index<0){return numSlides+index;}
return index;},_listeners={},_listen=function(name,fn){if(!_listeners[name]){_listeners[name]=[];}
return _listeners[name].push(fn);},_shout=function(name){var listeners=_listeners[name];if(listeners){var args=Array.prototype.slice.call(arguments);args.shift();for(var i=0;i<listeners.length;i++){listeners[i].apply(self,args);}}},_getCurrentTime=function(){return new Date().getTime();},_applyBgOpacity=function(opacity){_bgOpacity=opacity;self.bg.style.opacity=opacity*_options.bgOpacity;},_applyZoomTransform=function(styleObj,x,y,zoom,item){if(!_renderMaxResolution||(item&&item!==self.currItem)){zoom=zoom/(item?item.fitRatio:self.currItem.fitRatio);}
styleObj[_transformKey]=_translatePrefix+x+'px, '+y+'px'+_translateSufix+' scale('+zoom+')';},_applyCurrentZoomPan=function(allowRenderResolution){if(_currZoomElementStyle){if(allowRenderResolution){if(_currZoomLevel>self.currItem.fitRatio){if(!_renderMaxResolution){_setImageSize(self.currItem,false,true);_renderMaxResolution=true;}}else{if(_renderMaxResolution){_setImageSize(self.currItem);_renderMaxResolution=false;}}}
_applyZoomTransform(_currZoomElementStyle,_panOffset.x,_panOffset.y,_currZoomLevel);}},_applyZoomPanToItem=function(item){if(item.container){_applyZoomTransform(item.container.style,item.initialPosition.x,item.initialPosition.y,item.initialZoomLevel,item);}},_setTranslateX=function(x,elStyle){elStyle[_transformKey]=_translatePrefix+x+'px, 0px'+_translateSufix;},_moveMainScroll=function(x,dragging){if(!_options.loop&&dragging){var newSlideIndexOffset=_currentItemIndex+(_slideSize.x*_currPositionIndex-x)/_slideSize.x,delta=Math.round(x-_mainScrollPos.x);if((newSlideIndexOffset<0&&delta>0)||(newSlideIndexOffset>=_getNumItems()-1&&delta<0)){x=_mainScrollPos.x+delta*_options.mainScrollEndFriction;}}
_mainScrollPos.x=x;_setTranslateX(x,_containerStyle);},_calculatePanOffset=function(axis,zoomLevel){var m=_midZoomPoint[axis]-_offset[axis];return _startPanOffset[axis]+_currPanDist[axis]+m-m*(zoomLevel/_startZoomLevel);},_equalizePoints=function(p1,p2){p1.x=p2.x;p1.y=p2.y;if(p2.id){p1.id=p2.id;}},_roundPoint=function(p){p.x=Math.round(p.x);p.y=Math.round(p.y);},_mouseMoveTimeout=null,_onFirstMouseMove=function(){if(_mouseMoveTimeout){framework.unbind(document,'mousemove',_onFirstMouseMove);framework.addClass(template,'pswp--has_mouse');_options.mouseUsed=true;_shout('mouseUsed');}
_mouseMoveTimeout=setTimeout(function(){_mouseMoveTimeout=null;},100);},_bindEvents=function(){framework.bind(document,'keydown',self);if(_features.transform){framework.bind(self.scrollWrap,'click',self);}
if(!_options.mouseUsed){framework.bind(document,'mousemove',_onFirstMouseMove);}
framework.bind(window,'resize scroll orientationchange',self);_shout('bindEvents');},_unbindEvents=function(){framework.unbind(window,'resize scroll orientationchange',self);framework.unbind(window,'scroll',_globalEventHandlers.scroll);framework.unbind(document,'keydown',self);framework.unbind(document,'mousemove',_onFirstMouseMove);if(_features.transform){framework.unbind(self.scrollWrap,'click',self);}
if(_isDragging){framework.unbind(window,_upMoveEvents,self);}
clearTimeout(_orientationChangeTimeout);_shout('unbindEvents');},_calculatePanBounds=function(zoomLevel,update){var bounds=_calculateItemSize(self.currItem,_viewportSize,zoomLevel);if(update){_currPanBounds=bounds;}
return bounds;},_getMinZoomLevel=function(item){if(!item){item=self.currItem;}
return item.initialZoomLevel;},_getMaxZoomLevel=function(item){if(!item){item=self.currItem;}
return item.w>0?_options.maxSpreadZoom:1;},_modifyDestPanOffset=function(axis,destPanBounds,destPanOffset,destZoomLevel){if(destZoomLevel===self.currItem.initialZoomLevel){destPanOffset[axis]=self.currItem.initialPosition[axis];return true;}else{destPanOffset[axis]=_calculatePanOffset(axis,destZoomLevel);if(destPanOffset[axis]>destPanBounds.min[axis]){destPanOffset[axis]=destPanBounds.min[axis];return true;}else if(destPanOffset[axis]<destPanBounds.max[axis]){destPanOffset[axis]=destPanBounds.max[axis];return true;}}
return false;},_setupTransforms=function(){if(_transformKey){var allow3dTransform=_features.perspective&&!_likelyTouchDevice;_translatePrefix='translate'+(allow3dTransform?'3d(':'(');_translateSufix=_features.perspective?', 0px)':')';return;}
_transformKey='left';framework.addClass(template,'pswp--ie');_setTranslateX=function(x,elStyle){elStyle.left=x+'px';};_applyZoomPanToItem=function(item){var zoomRatio=item.fitRatio>1?1:item.fitRatio,s=item.container.style,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+'px';s.height=h+'px';s.left=item.initialPosition.x+'px';s.top=item.initialPosition.y+'px';};_applyCurrentZoomPan=function(){if(_currZoomElementStyle){var s=_currZoomElementStyle,item=self.currItem,zoomRatio=item.fitRatio>1?1:item.fitRatio,w=zoomRatio*item.w,h=zoomRatio*item.h;s.width=w+'px';s.height=h+'px';s.left=_panOffset.x+'px';s.top=_panOffset.y+'px';}};},_onKeyDown=function(e){var keydownAction='';if(_options.escKey&&e.keyCode===27){keydownAction='close';}else if(_options.arrowKeys){if(e.keyCode===37){keydownAction='prev';}else if(e.keyCode===39){keydownAction='next';}}
if(keydownAction){if(!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!e.metaKey){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}
self[keydownAction]();}}},_onGlobalClick=function(e){if(!e){return;}
if(_moved||_zoomStarted||_mainScrollAnimating||_verticalDragInitiated){e.preventDefault();e.stopPropagation();}},_updatePageScrollOffset=function(){self.setScrollOffset(0,framework.getScrollY());};var _animations={},_numAnimations=0,_stopAnimation=function(name){if(_animations[name]){if(_animations[name].raf){_cancelAF(_animations[name].raf);}
_numAnimations--;delete _animations[name];}},_registerStartAnimation=function(name){if(_animations[name]){_stopAnimation(name);}
if(!_animations[name]){_numAnimations++;_animations[name]={};}},_stopAllAnimations=function(){for(var prop in _animations){if(_animations.hasOwnProperty(prop)){_stopAnimation(prop);}}},_animateProp=function(name,b,endProp,d,easingFn,onUpdate,onComplete){var startAnimTime=_getCurrentTime(),t;_registerStartAnimation(name);var animloop=function(){if(_animations[name]){t=_getCurrentTime()-startAnimTime;if(t>=d){_stopAnimation(name);onUpdate(endProp);if(onComplete){onComplete();}
return;}
onUpdate((endProp-b)*easingFn(t/d)+b);_animations[name].raf=_requestAF(animloop);}};animloop();};var publicMethods={shout:_shout,listen:_listen,viewportSize:_viewportSize,options:_options,isMainScrollAnimating:function(){return _mainScrollAnimating;},getZoomLevel:function(){return _currZoomLevel;},getCurrentIndex:function(){return _currentItemIndex;},isDragging:function(){return _isDragging;},isZooming:function(){return _isZooming;},setScrollOffset:function(x,y){_offset.x=x;_currentWindowScrollY=_offset.y=y;_shout('updateScrollOffset',_offset);},applyZoomPan:function(zoomLevel,panX,panY,allowRenderResolution){_panOffset.x=panX;_panOffset.y=panY;_currZoomLevel=zoomLevel;_applyCurrentZoomPan(allowRenderResolution);},init:function(){if(_isOpen||_isDestroying){return;}
var i;self.framework=framework;self.template=template;self.bg=framework.getChildByClass(template,'pswp__bg');_initalClassName=template.className;_isOpen=true;_features=framework.detectFeatures();_requestAF=_features.raf;_cancelAF=_features.caf;_transformKey=_features.transform;_oldIE=_features.oldIE;self.scrollWrap=framework.getChildByClass(template,'pswp__scroll-wrap');self.container=framework.getChildByClass(self.scrollWrap,'pswp__container');_containerStyle=self.container.style;self.itemHolders=_itemHolders=[{el:self.container.children[0],wrap:0,index:-1},{el:self.container.children[1],wrap:0,index:-1},{el:self.container.children[2],wrap:0,index:-1}];_itemHolders[0].el.style.display=_itemHolders[2].el.style.display='none';_setupTransforms();_globalEventHandlers={resize:self.updateSize,orientationchange:function(){clearTimeout(_orientationChangeTimeout);_orientationChangeTimeout=setTimeout(function(){if(_viewportSize.x!==self.scrollWrap.clientWidth){self.updateSize();}},500);},scroll:_updatePageScrollOffset,keydown:_onKeyDown,click:_onGlobalClick};var oldPhone=_features.isOldIOSPhone||_features.isOldAndroid||_features.isMobileOpera;if(!_features.animationName||!_features.transform||oldPhone){_options.showAnimationDuration=_options.hideAnimationDuration=0;}
for(i=0;i<_modules.length;i++){self['init'+_modules[i]]();}
if(UiClass){var ui=self.ui=new UiClass(self,framework);ui.init();}
_shout('firstUpdate');_currentItemIndex=_currentItemIndex||_options.index||0;if(isNaN(_currentItemIndex)||_currentItemIndex<0||_currentItemIndex>=_getNumItems()){_currentItemIndex=0;}
self.currItem=_getItemAt(_currentItemIndex);if(_features.isOldIOSPhone||_features.isOldAndroid){_isFixedPosition=false;}
template.setAttribute('aria-hidden','false');if(_options.modal){if(!_isFixedPosition){template.style.position='absolute';template.style.top=framework.getScrollY()+'px';}else{template.style.position='fixed';}}
if(_currentWindowScrollY===undefined){_shout('initialLayout');_currentWindowScrollY=_initalWindowScrollY=framework.getScrollY();}
var rootClasses='pswp--open ';if(_options.mainClass){rootClasses+=_options.mainClass+' ';}
if(_options.showHideOpacity){rootClasses+='pswp--animate_opacity ';}
rootClasses+=_likelyTouchDevice?'pswp--touch':'pswp--notouch';rootClasses+=_features.animationName?' pswp--css_animation':'';rootClasses+=_features.svg?' pswp--svg':'';framework.addClass(template,rootClasses);self.updateSize();_containerShiftIndex=-1;_indexDiff=null;for(i=0;i<NUM_HOLDERS;i++){_setTranslateX((i+_containerShiftIndex)*_slideSize.x,_itemHolders[i].el.style);}
if(!_oldIE){framework.bind(self.scrollWrap,_downEvents,self);}
_listen('initialZoomInEnd',function(){self.setContent(_itemHolders[0],_currentItemIndex-1);self.setContent(_itemHolders[2],_currentItemIndex+1);_itemHolders[0].el.style.display=_itemHolders[2].el.style.display='block';if(_options.focus){template.focus();}
_bindEvents();});self.setContent(_itemHolders[1],_currentItemIndex);self.updateCurrItem();_shout('afterInit');if(!_isFixedPosition){_updateSizeInterval=setInterval(function(){if(!_numAnimations&&!_isDragging&&!_isZooming&&(_currZoomLevel===self.currItem.initialZoomLevel)){self.updateSize();}},1000);}
framework.addClass(template,'pswp--visible');},close:function(){if(!_isOpen){return;}
_isOpen=false;_isDestroying=true;_shout('close');_unbindEvents();_showOrHide(self.currItem,null,true,self.destroy);},destroy:function(){_shout('destroy');if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout);}
template.setAttribute('aria-hidden','true');template.className=_initalClassName;if(_updateSizeInterval){clearInterval(_updateSizeInterval);}
framework.unbind(self.scrollWrap,_downEvents,self);framework.unbind(window,'scroll',self);_stopDragUpdateLoop();_stopAllAnimations();_listeners=null;},panTo:function(x,y,force){if(!force){if(x>_currPanBounds.min.x){x=_currPanBounds.min.x;}else if(x<_currPanBounds.max.x){x=_currPanBounds.max.x;}
if(y>_currPanBounds.min.y){y=_currPanBounds.min.y;}else if(y<_currPanBounds.max.y){y=_currPanBounds.max.y;}}
_panOffset.x=x;_panOffset.y=y;_applyCurrentZoomPan();},handleEvent:function(e){e=e||window.event;if(_globalEventHandlers[e.type]){_globalEventHandlers[e.type](e);}},goTo:function(index){index=_getLoopedId(index);var diff=index-_currentItemIndex;_indexDiff=diff;_currentItemIndex=index;self.currItem=_getItemAt(_currentItemIndex);_currPositionIndex-=diff;_moveMainScroll(_slideSize.x*_currPositionIndex);_stopAllAnimations();_mainScrollAnimating=false;self.updateCurrItem();},next:function(){self.goTo(_currentItemIndex+1);},prev:function(){self.goTo(_currentItemIndex-1);},updateCurrZoomItem:function(emulateSetContent){if(emulateSetContent){_shout('beforeChange',0);}
if(_itemHolders[1].el.children.length){var zoomElement=_itemHolders[1].el.children[0];if(framework.hasClass(zoomElement,'pswp__zoom-wrap')){_currZoomElementStyle=zoomElement.style;}else{_currZoomElementStyle=null;}}else{_currZoomElementStyle=null;}
_currPanBounds=self.currItem.bounds;_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;if(emulateSetContent){_shout('afterChange');}},invalidateCurrItems:function(){_itemsNeedUpdate=true;for(var i=0;i<NUM_HOLDERS;i++){if(_itemHolders[i].item){_itemHolders[i].item.needsUpdate=true;}}},updateCurrItem:function(beforeAnimation){if(_indexDiff===0){return;}
var diffAbs=Math.abs(_indexDiff),tempHolder;if(beforeAnimation&&diffAbs<2){return;}
self.currItem=_getItemAt(_currentItemIndex);_renderMaxResolution=false;_shout('beforeChange',_indexDiff);if(diffAbs>=NUM_HOLDERS){_containerShiftIndex+=_indexDiff+(_indexDiff>0?-NUM_HOLDERS:NUM_HOLDERS);diffAbs=NUM_HOLDERS;}
for(var i=0;i<diffAbs;i++){if(_indexDiff>0){tempHolder=_itemHolders.shift();_itemHolders[NUM_HOLDERS-1]=tempHolder;_containerShiftIndex++;_setTranslateX((_containerShiftIndex+2)*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex-diffAbs+i+1+1);}else{tempHolder=_itemHolders.pop();_itemHolders.unshift(tempHolder);_containerShiftIndex--;_setTranslateX(_containerShiftIndex*_slideSize.x,tempHolder.el.style);self.setContent(tempHolder,_currentItemIndex+diffAbs-i-1-1);}}
if(_currZoomElementStyle&&Math.abs(_indexDiff)===1){var prevItem=_getItemAt(_prevItemIndex);if(prevItem.initialZoomLevel!==_currZoomLevel){_calculateItemSize(prevItem,_viewportSize);_setImageSize(prevItem);_applyZoomPanToItem(prevItem);}}
_indexDiff=0;self.updateCurrZoomItem();_prevItemIndex=_currentItemIndex;_shout('afterChange');},updateSize:function(force){if(!_isFixedPosition&&_options.modal){var windowScrollY=framework.getScrollY();if(_currentWindowScrollY!==windowScrollY){template.style.top=windowScrollY+'px';_currentWindowScrollY=windowScrollY;}
if(!force&&_windowVisibleSize.x===window.innerWidth&&_windowVisibleSize.y===window.innerHeight){return;}
_windowVisibleSize.x=window.innerWidth;_windowVisibleSize.y=window.innerHeight;template.style.height=_windowVisibleSize.y+'px';}
_viewportSize.x=self.scrollWrap.clientWidth;_viewportSize.y=self.scrollWrap.clientHeight;_updatePageScrollOffset();_slideSize.x=_viewportSize.x+Math.round(_viewportSize.x*_options.spacing);_slideSize.y=_viewportSize.y;_moveMainScroll(_slideSize.x*_currPositionIndex);_shout('beforeResize');if(_containerShiftIndex!==undefined){var holder,item,hIndex;for(var i=0;i<NUM_HOLDERS;i++){holder=_itemHolders[i];_setTranslateX((i+_containerShiftIndex)*_slideSize.x,holder.el.style);hIndex=_currentItemIndex+i-1;if(_options.loop&&_getNumItems()>2){hIndex=_getLoopedId(hIndex);}
item=_getItemAt(hIndex);if(item&&(_itemsNeedUpdate||item.needsUpdate||!item.bounds)){self.cleanSlide(item);self.setContent(holder,hIndex);if(i===1){self.currItem=item;self.updateCurrZoomItem(true);}
item.needsUpdate=false;}else if(holder.index===-1&&hIndex>=0){self.setContent(holder,hIndex);}
if(item&&item.container){_calculateItemSize(item,_viewportSize);_setImageSize(item);_applyZoomPanToItem(item);}}
_itemsNeedUpdate=false;}
_startZoomLevel=_currZoomLevel=self.currItem.initialZoomLevel;_currPanBounds=self.currItem.bounds;if(_currPanBounds){_panOffset.x=_currPanBounds.center.x;_panOffset.y=_currPanBounds.center.y;_applyCurrentZoomPan(true);}
_shout('resize');},zoomTo:function(destZoomLevel,centerPoint,speed,easingFn,updateFn){if(centerPoint){_startZoomLevel=_currZoomLevel;_midZoomPoint.x=Math.abs(centerPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(centerPoint.y)-_panOffset.y;_equalizePoints(_startPanOffset,_panOffset);}
var destPanBounds=_calculatePanBounds(destZoomLevel,false),destPanOffset={};_modifyDestPanOffset('x',destPanBounds,destPanOffset,destZoomLevel);_modifyDestPanOffset('y',destPanBounds,destPanOffset,destZoomLevel);var initialZoomLevel=_currZoomLevel;var initialPanOffset={x:_panOffset.x,y:_panOffset.y};_roundPoint(destPanOffset);var onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=destPanOffset.x;_panOffset.y=destPanOffset.y;}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(destPanOffset.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(destPanOffset.y-initialPanOffset.y)*now+initialPanOffset.y;}
if(updateFn){updateFn(now);}
_applyCurrentZoomPan(now===1);};if(speed){_animateProp('customZoomTo',0,1,speed,easingFn||framework.easing.sine.inOut,onUpdate);}else{onUpdate(1);}}};var MIN_SWIPE_DISTANCE=30,DIRECTION_CHECK_OFFSET=10;var _gestureStartTime,_gestureCheckSpeedTime,p={},p2={},delta={},_currPoint={},_startPoint={},_currPointers=[],_startMainScrollPos={},_releaseAnimData,_posPoints=[],_tempPoint={},_isZoomingIn,_verticalDragInitiated,_oldAndroidTouchEndTimeout,_currZoomedItemIndex=0,_centerPoint=_getEmptyPoint(),_lastReleaseTime=0,_isDragging,_isMultitouch,_zoomStarted,_moved,_dragAnimFrame,_mainScrollShifted,_currentPoints,_isZooming,_currPointsDistance,_startPointsDistance,_currPanBounds,_mainScrollPos=_getEmptyPoint(),_currZoomElementStyle,_mainScrollAnimating,_midZoomPoint=_getEmptyPoint(),_currCenterPoint=_getEmptyPoint(),_direction,_isFirstMove,_opacityChanged,_bgOpacity,_wasOverInitialZoom,_isEqualPoints=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y;},_isNearbyPoints=function(touch0,touch1){return Math.abs(touch0.x-touch1.x)<DOUBLE_TAP_RADIUS&&Math.abs(touch0.y-touch1.y)<DOUBLE_TAP_RADIUS;},_calculatePointsDistance=function(p1,p2){_tempPoint.x=Math.abs(p1.x-p2.x);_tempPoint.y=Math.abs(p1.y-p2.y);return Math.sqrt(_tempPoint.x*_tempPoint.x+_tempPoint.y*_tempPoint.y);},_stopDragUpdateLoop=function(){if(_dragAnimFrame){_cancelAF(_dragAnimFrame);_dragAnimFrame=null;}},_dragUpdateLoop=function(){if(_isDragging){_dragAnimFrame=_requestAF(_dragUpdateLoop);_renderMovement();}},_canPan=function(){return!(_options.scaleMode==='fit'&&_currZoomLevel===self.currItem.initialZoomLevel);},_closestElement=function(el,fn){if(!el||el===document){return false;}
if(el.getAttribute('class')&&el.getAttribute('class').indexOf('pswp__scroll-wrap')>-1){return false;}
if(fn(el)){return el;}
return _closestElement(el.parentNode,fn);},_preventObj={},_preventDefaultEventBehaviour=function(e,isDown){_preventObj.prevent=!_closestElement(e.target,_options.isClickableElement);_shout('preventDragEvent',e,isDown,_preventObj);return _preventObj.prevent;},_convertTouchToPoint=function(touch,p){p.x=touch.pageX;p.y=touch.pageY;p.id=touch.identifier;return p;},_findCenterOfPoints=function(p1,p2,pCenter){pCenter.x=(p1.x+p2.x)*0.5;pCenter.y=(p1.y+p2.y)*0.5;},_pushPosPoint=function(time,x,y){if(time-_gestureCheckSpeedTime>50){var o=_posPoints.length>2?_posPoints.shift():{};o.x=x;o.y=y;_posPoints.push(o);_gestureCheckSpeedTime=time;}},_calculateVerticalDragOpacityRatio=function(){var yOffset=_panOffset.y-self.currItem.initialPosition.y;return 1-Math.abs(yOffset/(_viewportSize.y/2));},_ePoint1={},_ePoint2={},_tempPointsArr=[],_tempCounter,_getTouchPoints=function(e){while(_tempPointsArr.length>0){_tempPointsArr.pop();}
if(!_pointerEventEnabled){if(e.type.indexOf('touch')>-1){if(e.touches&&e.touches.length>0){_tempPointsArr[0]=_convertTouchToPoint(e.touches[0],_ePoint1);if(e.touches.length>1){_tempPointsArr[1]=_convertTouchToPoint(e.touches[1],_ePoint2);}}}else{_ePoint1.x=e.pageX;_ePoint1.y=e.pageY;_ePoint1.id='';_tempPointsArr[0]=_ePoint1;}}else{_tempCounter=0;_currPointers.forEach(function(p){if(_tempCounter===0){_tempPointsArr[0]=p;}else if(_tempCounter===1){_tempPointsArr[1]=p;}
_tempCounter++;});}
return _tempPointsArr;},_panOrMoveMainScroll=function(axis,delta){var panFriction,overDiff=0,newOffset=_panOffset[axis]+delta[axis],startOverDiff,dir=delta[axis]>0,newMainScrollPosition=_mainScrollPos.x+delta.x,mainScrollDiff=_mainScrollPos.x-_startMainScrollPos.x,newPanPos,newMainScrollPos;if(newOffset>_currPanBounds.min[axis]||newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;}else{panFriction=1;}
newOffset=_panOffset[axis]+delta[axis]*panFriction;if(_options.allowPanToNext||_currZoomLevel===self.currItem.initialZoomLevel){if(!_currZoomElementStyle){newMainScrollPos=newMainScrollPosition;}else if(_direction==='h'&&axis==='x'&&!_zoomStarted){if(dir){if(newOffset>_currPanBounds.min[axis]){panFriction=_options.panEndFriction;overDiff=_currPanBounds.min[axis]-newOffset;startOverDiff=_currPanBounds.min[axis]-_startPanOffset[axis];}
if((startOverDiff<=0||mainScrollDiff<0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff<0&&newMainScrollPosition>_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x;}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset;}}}else{if(newOffset<_currPanBounds.max[axis]){panFriction=_options.panEndFriction;overDiff=newOffset-_currPanBounds.max[axis];startOverDiff=_startPanOffset[axis]-_currPanBounds.max[axis];}
if((startOverDiff<=0||mainScrollDiff>0)&&_getNumItems()>1){newMainScrollPos=newMainScrollPosition;if(mainScrollDiff>0&&newMainScrollPosition<_startMainScrollPos.x){newMainScrollPos=_startMainScrollPos.x;}}else{if(_currPanBounds.min.x!==_currPanBounds.max.x){newPanPos=newOffset;}}}}
if(axis==='x'){if(newMainScrollPos!==undefined){_moveMainScroll(newMainScrollPos,true);if(newMainScrollPos===_startMainScrollPos.x){_mainScrollShifted=false;}else{_mainScrollShifted=true;}}
if(_currPanBounds.min.x!==_currPanBounds.max.x){if(newPanPos!==undefined){_panOffset.x=newPanPos;}else if(!_mainScrollShifted){_panOffset.x+=delta.x*panFriction;}}
return newMainScrollPos!==undefined;}}
if(!_mainScrollAnimating){if(!_mainScrollShifted){if(_currZoomLevel>self.currItem.fitRatio){_panOffset[axis]+=delta[axis]*panFriction;}}}},_onDragStart=function(e){if(e.type==='mousedown'&&e.button>0){return;}
if(_initialZoomRunning){e.preventDefault();return;}
if(_oldAndroidTouchEndTimeout&&e.type==='mousedown'){return;}
if(_preventDefaultEventBehaviour(e,true)){e.preventDefault();}
_shout('pointerDown');if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex<0){pointerIndex=_currPointers.length;}
_currPointers[pointerIndex]={x:e.pageX,y:e.pageY,id:e.pointerId};}
var startPointsList=_getTouchPoints(e),numPoints=startPointsList.length;_currentPoints=null;_stopAllAnimations();if(!_isDragging||numPoints===1){_isDragging=_isFirstMove=true;framework.bind(window,_upMoveEvents,self);_isZoomingIn=_wasOverInitialZoom=_opacityChanged=_verticalDragInitiated=_mainScrollShifted=_moved=_isMultitouch=_zoomStarted=false;_direction=null;_shout('firstTouchStart',startPointsList);_equalizePoints(_startPanOffset,_panOffset);_currPanDist.x=_currPanDist.y=0;_equalizePoints(_currPoint,startPointsList[0]);_equalizePoints(_startPoint,_currPoint);_startMainScrollPos.x=_slideSize.x*_currPositionIndex;_posPoints=[{x:_currPoint.x,y:_currPoint.y}];_gestureCheckSpeedTime=_gestureStartTime=_getCurrentTime();_calculatePanBounds(_currZoomLevel,true);_stopDragUpdateLoop();_dragUpdateLoop();}
if(!_isZooming&&numPoints>1&&!_mainScrollAnimating&&!_mainScrollShifted){_startZoomLevel=_currZoomLevel;_zoomStarted=false;_isZooming=_isMultitouch=true;_currPanDist.y=_currPanDist.x=0;_equalizePoints(_startPanOffset,_panOffset);_equalizePoints(p,startPointsList[0]);_equalizePoints(p2,startPointsList[1]);_findCenterOfPoints(p,p2,_currCenterPoint);_midZoomPoint.x=Math.abs(_currCenterPoint.x)-_panOffset.x;_midZoomPoint.y=Math.abs(_currCenterPoint.y)-_panOffset.y;_currPointsDistance=_startPointsDistance=_calculatePointsDistance(p,p2);}},_onDragMove=function(e){e.preventDefault();if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex>-1){var p=_currPointers[pointerIndex];p.x=e.pageX;p.y=e.pageY;}}
if(_isDragging){var touchesList=_getTouchPoints(e);if(!_direction&&!_moved&&!_isZooming){if(_mainScrollPos.x!==_slideSize.x*_currPositionIndex){_direction='h';}else{var diff=Math.abs(touchesList[0].x-_currPoint.x)-Math.abs(touchesList[0].y-_currPoint.y);if(Math.abs(diff)>=DIRECTION_CHECK_OFFSET){_direction=diff>0?'h':'v';_currentPoints=touchesList;}}}else{_currentPoints=touchesList;}}},_renderMovement=function(){if(!_currentPoints){return;}
var numPoints=_currentPoints.length;if(numPoints===0){return;}
_equalizePoints(p,_currentPoints[0]);delta.x=p.x-_currPoint.x;delta.y=p.y-_currPoint.y;if(_isZooming&&numPoints>1){_currPoint.x=p.x;_currPoint.y=p.y;if(!delta.x&&!delta.y&&_isEqualPoints(_currentPoints[1],p2)){return;}
_equalizePoints(p2,_currentPoints[1]);if(!_zoomStarted){_zoomStarted=true;_shout('zoomGestureStarted');}
var pointsDistance=_calculatePointsDistance(p,p2);var zoomLevel=_calculateZoomLevel(pointsDistance);if(zoomLevel>self.currItem.initialZoomLevel+self.currItem.initialZoomLevel/15){_wasOverInitialZoom=true;}
var zoomFriction=1,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(zoomLevel<minZoomLevel){if(_options.pinchToClose&&!_wasOverInitialZoom&&_startZoomLevel<=self.currItem.initialZoomLevel){var minusDiff=minZoomLevel-zoomLevel;var percent=1-minusDiff/(minZoomLevel/1.2);_applyBgOpacity(percent);_shout('onPinchClose',percent);_opacityChanged=true;}else{zoomFriction=(minZoomLevel-zoomLevel)/minZoomLevel;if(zoomFriction>1){zoomFriction=1;}
zoomLevel=minZoomLevel-zoomFriction*(minZoomLevel/3);}}else if(zoomLevel>maxZoomLevel){zoomFriction=(zoomLevel-maxZoomLevel)/(minZoomLevel*6);if(zoomFriction>1){zoomFriction=1;}
zoomLevel=maxZoomLevel+zoomFriction*minZoomLevel;}
if(zoomFriction<0){zoomFriction=0;}
_currPointsDistance=pointsDistance;_findCenterOfPoints(p,p2,_centerPoint);_currPanDist.x+=_centerPoint.x-_currCenterPoint.x;_currPanDist.y+=_centerPoint.y-_currCenterPoint.y;_equalizePoints(_currCenterPoint,_centerPoint);_panOffset.x=_calculatePanOffset('x',zoomLevel);_panOffset.y=_calculatePanOffset('y',zoomLevel);_isZoomingIn=zoomLevel>_currZoomLevel;_currZoomLevel=zoomLevel;_applyCurrentZoomPan();}else{if(!_direction){return;}
if(_isFirstMove){_isFirstMove=false;if(Math.abs(delta.x)>=DIRECTION_CHECK_OFFSET){delta.x-=_currentPoints[0].x-_startPoint.x;}
if(Math.abs(delta.y)>=DIRECTION_CHECK_OFFSET){delta.y-=_currentPoints[0].y-_startPoint.y;}}
_currPoint.x=p.x;_currPoint.y=p.y;if(delta.x===0&&delta.y===0){return;}
if(_direction==='v'&&_options.closeOnVerticalDrag){if(!_canPan()){_currPanDist.y+=delta.y;_panOffset.y+=delta.y;var opacityRatio=_calculateVerticalDragOpacityRatio();_verticalDragInitiated=true;_shout('onVerticalDrag',opacityRatio);_applyBgOpacity(opacityRatio);_applyCurrentZoomPan();return;}}
_pushPosPoint(_getCurrentTime(),p.x,p.y);_moved=true;_currPanBounds=self.currItem.bounds;var mainScrollChanged=_panOrMoveMainScroll('x',delta);if(!mainScrollChanged){_panOrMoveMainScroll('y',delta);_roundPoint(_panOffset);_applyCurrentZoomPan();}}},_onDragRelease=function(e){if(_features.isOldAndroid){if(_oldAndroidTouchEndTimeout&&e.type==='mouseup'){return;}
if(e.type.indexOf('touch')>-1){clearTimeout(_oldAndroidTouchEndTimeout);_oldAndroidTouchEndTimeout=setTimeout(function(){_oldAndroidTouchEndTimeout=0;},600);}}
_shout('pointerUp');if(_preventDefaultEventBehaviour(e,false)){e.preventDefault();}
var releasePoint;if(_pointerEventEnabled){var pointerIndex=framework.arraySearch(_currPointers,e.pointerId,'id');if(pointerIndex>-1){releasePoint=_currPointers.splice(pointerIndex,1)[0];if(navigator.pointerEnabled){releasePoint.type=e.pointerType||'mouse';}else{var MSPOINTER_TYPES={4:'mouse',2:'touch',3:'pen'};releasePoint.type=MSPOINTER_TYPES[e.pointerType];if(!releasePoint.type){releasePoint.type=e.pointerType||'mouse';}}}}
var touchList=_getTouchPoints(e),gestureType,numPoints=touchList.length;if(e.type==='mouseup'){numPoints=0;}
if(numPoints===2){_currentPoints=null;return true;}
if(numPoints===1){_equalizePoints(_startPoint,touchList[0]);}
if(numPoints===0&&!_direction&&!_mainScrollAnimating){if(!releasePoint){if(e.type==='mouseup'){releasePoint={x:e.pageX,y:e.pageY,type:'mouse'};}else if(e.changedTouches&&e.changedTouches[0]){releasePoint={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,type:'touch'};}}
_shout('touchRelease',e,releasePoint);}
var releaseTimeDiff=-1;if(numPoints===0){_isDragging=false;framework.unbind(window,_upMoveEvents,self);_stopDragUpdateLoop();if(_isZooming){releaseTimeDiff=0;}else if(_lastReleaseTime!==-1){releaseTimeDiff=_getCurrentTime()-_lastReleaseTime;}}
_lastReleaseTime=numPoints===1?_getCurrentTime():-1;if(releaseTimeDiff!==-1&&releaseTimeDiff<150){gestureType='zoom';}else{gestureType='swipe';}
if(_isZooming&&numPoints<2){_isZooming=false;if(numPoints===1){gestureType='zoomPointerUp';}
_shout('zoomGestureEnded');}
_currentPoints=null;if(!_moved&&!_zoomStarted&&!_mainScrollAnimating&&!_verticalDragInitiated){return;}
_stopAllAnimations();if(!_releaseAnimData){_releaseAnimData=_initDragReleaseAnimationData();}
_releaseAnimData.calculateSwipeSpeed('x');if(_verticalDragInitiated){var opacityRatio=_calculateVerticalDragOpacityRatio();if(opacityRatio<_options.verticalDragRange){self.close();}else{var initalPanY=_panOffset.y,initialBgOpacity=_bgOpacity;_animateProp('verticalDrag',0,1,300,framework.easing.cubic.out,function(now){_panOffset.y=(self.currItem.initialPosition.y-initalPanY)*now+initalPanY;_applyBgOpacity((1-initialBgOpacity)*now+initialBgOpacity);_applyCurrentZoomPan();});_shout('onVerticalDrag',1);}
return;}
if((_mainScrollShifted||_mainScrollAnimating)&&numPoints===0){var itemChanged=_finishSwipeMainScrollGesture(gestureType,_releaseAnimData);if(itemChanged){return;}
gestureType='zoomPointerUp';}
if(_mainScrollAnimating){return;}
if(gestureType!=='swipe'){_completeZoomGesture();return;}
if(!_mainScrollShifted&&_currZoomLevel>self.currItem.fitRatio){_completePanGesture(_releaseAnimData);}},_initDragReleaseAnimationData=function(){var lastFlickDuration,tempReleasePos;var s={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(axis){if(_posPoints.length>1){lastFlickDuration=_getCurrentTime()-_gestureCheckSpeedTime+50;tempReleasePos=_posPoints[_posPoints.length-2][axis];}else{lastFlickDuration=_getCurrentTime()-_gestureStartTime;tempReleasePos=_startPoint[axis];}
s.lastFlickOffset[axis]=_currPoint[axis]-tempReleasePos;s.lastFlickDist[axis]=Math.abs(s.lastFlickOffset[axis]);if(s.lastFlickDist[axis]>20){s.lastFlickSpeed[axis]=s.lastFlickOffset[axis]/lastFlickDuration;}else{s.lastFlickSpeed[axis]=0;}
if(Math.abs(s.lastFlickSpeed[axis])<0.1){s.lastFlickSpeed[axis]=0;}
s.slowDownRatio[axis]=0.95;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];s.speedDecelerationRatio[axis]=1;},calculateOverBoundsAnimOffset:function(axis,speed){if(!s.backAnimStarted[axis]){if(_panOffset[axis]>_currPanBounds.min[axis]){s.backAnimDestination[axis]=_currPanBounds.min[axis];}else if(_panOffset[axis]<_currPanBounds.max[axis]){s.backAnimDestination[axis]=_currPanBounds.max[axis];}
if(s.backAnimDestination[axis]!==undefined){s.slowDownRatio[axis]=0.7;s.slowDownRatioReverse[axis]=1-s.slowDownRatio[axis];if(s.speedDecelerationRatioAbs[axis]<0.05){s.lastFlickSpeed[axis]=0;s.backAnimStarted[axis]=true;_animateProp('bounceZoomPan'+axis,_panOffset[axis],s.backAnimDestination[axis],speed||300,framework.easing.sine.out,function(pos){_panOffset[axis]=pos;_applyCurrentZoomPan();});}}}},calculateAnimOffset:function(axis){if(!s.backAnimStarted[axis]){s.speedDecelerationRatio[axis]=s.speedDecelerationRatio[axis]*(s.slowDownRatio[axis]+
s.slowDownRatioReverse[axis]-
s.slowDownRatioReverse[axis]*s.timeDiff/10);s.speedDecelerationRatioAbs[axis]=Math.abs(s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]);s.distanceOffset[axis]=s.lastFlickSpeed[axis]*s.speedDecelerationRatio[axis]*s.timeDiff;_panOffset[axis]+=s.distanceOffset[axis];}},panAnimLoop:function(){if(_animations.zoomPan){_animations.zoomPan.raf=_requestAF(s.panAnimLoop);s.now=_getCurrentTime();s.timeDiff=s.now-s.lastNow;s.lastNow=s.now;s.calculateAnimOffset('x');s.calculateAnimOffset('y');_applyCurrentZoomPan();s.calculateOverBoundsAnimOffset('x');s.calculateOverBoundsAnimOffset('y');if(s.speedDecelerationRatioAbs.x<0.05&&s.speedDecelerationRatioAbs.y<0.05){_panOffset.x=Math.round(_panOffset.x);_panOffset.y=Math.round(_panOffset.y);_applyCurrentZoomPan();_stopAnimation('zoomPan');return;}}}};return s;},_completePanGesture=function(animData){animData.calculateSwipeSpeed('y');_currPanBounds=self.currItem.bounds;animData.backAnimDestination={};animData.backAnimStarted={};if(Math.abs(animData.lastFlickSpeed.x)<=0.05&&Math.abs(animData.lastFlickSpeed.y)<=0.05){animData.speedDecelerationRatioAbs.x=animData.speedDecelerationRatioAbs.y=0;animData.calculateOverBoundsAnimOffset('x');animData.calculateOverBoundsAnimOffset('y');return true;}
_registerStartAnimation('zoomPan');animData.lastNow=_getCurrentTime();animData.panAnimLoop();},_finishSwipeMainScrollGesture=function(gestureType,_releaseAnimData){var itemChanged;if(!_mainScrollAnimating){_currZoomedItemIndex=_currentItemIndex;}
var itemsDiff;if(gestureType==='swipe'){var totalShiftDist=_currPoint.x-_startPoint.x,isFastLastFlick=_releaseAnimData.lastFlickDist.x<10;if(totalShiftDist>MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x>20)){itemsDiff=-1;}else if(totalShiftDist<-MIN_SWIPE_DISTANCE&&(isFastLastFlick||_releaseAnimData.lastFlickOffset.x<-20)){itemsDiff=1;}}
var nextCircle;if(itemsDiff){_currentItemIndex+=itemsDiff;if(_currentItemIndex<0){_currentItemIndex=_options.loop?_getNumItems()-1:0;nextCircle=true;}else if(_currentItemIndex>=_getNumItems()){_currentItemIndex=_options.loop?0:_getNumItems()-1;nextCircle=true;}
if(!nextCircle||_options.loop){_indexDiff+=itemsDiff;_currPositionIndex-=itemsDiff;itemChanged=true;}}
var animateToX=_slideSize.x*_currPositionIndex;var animateToDist=Math.abs(animateToX-_mainScrollPos.x);var finishAnimDuration;if(!itemChanged&&animateToX>_mainScrollPos.x!==_releaseAnimData.lastFlickSpeed.x>0){finishAnimDuration=333;}else{finishAnimDuration=Math.abs(_releaseAnimData.lastFlickSpeed.x)>0?animateToDist/Math.abs(_releaseAnimData.lastFlickSpeed.x):333;finishAnimDuration=Math.min(finishAnimDuration,400);finishAnimDuration=Math.max(finishAnimDuration,250);}
if(_currZoomedItemIndex===_currentItemIndex){itemChanged=false;}
_mainScrollAnimating=true;_shout('mainScrollAnimStart');_animateProp('mainScroll',_mainScrollPos.x,animateToX,finishAnimDuration,framework.easing.cubic.out,_moveMainScroll,function(){_stopAllAnimations();_mainScrollAnimating=false;_currZoomedItemIndex=-1;if(itemChanged||_currZoomedItemIndex!==_currentItemIndex){self.updateCurrItem();}
_shout('mainScrollAnimComplete');});if(itemChanged){self.updateCurrItem(true);}
return itemChanged;},_calculateZoomLevel=function(touchesDistance){return 1/_startPointsDistance*touchesDistance*_startZoomLevel;},_completeZoomGesture=function(){var destZoomLevel=_currZoomLevel,minZoomLevel=_getMinZoomLevel(),maxZoomLevel=_getMaxZoomLevel();if(_currZoomLevel<minZoomLevel){destZoomLevel=minZoomLevel;}else if(_currZoomLevel>maxZoomLevel){destZoomLevel=maxZoomLevel;}
var destOpacity=1,onUpdate,initialOpacity=_bgOpacity;if(_opacityChanged&&!_isZoomingIn&&!_wasOverInitialZoom&&_currZoomLevel<minZoomLevel){self.close();return true;}
if(_opacityChanged){onUpdate=function(now){_applyBgOpacity((destOpacity-initialOpacity)*now+initialOpacity);};}
self.zoomTo(destZoomLevel,0,200,framework.easing.cubic.out,onUpdate);return true;};_registerModule('Gestures',{publicMethods:{initGestures:function(){var addEventNames=function(pref,down,move,up,cancel){_dragStartEvent=pref+down;_dragMoveEvent=pref+move;_dragEndEvent=pref+up;if(cancel){_dragCancelEvent=pref+cancel;}else{_dragCancelEvent='';}};_pointerEventEnabled=_features.pointerEvent;if(_pointerEventEnabled&&_features.touch){_features.touch=false;}
if(_pointerEventEnabled){if(navigator.pointerEnabled){addEventNames('pointer','down','move','up','cancel');}else{addEventNames('MSPointer','Down','Move','Up','Cancel');}}else if(_features.touch){addEventNames('touch','start','move','end','cancel');_likelyTouchDevice=true;}else{addEventNames('mouse','down','move','up');}
_upMoveEvents=_dragMoveEvent+' '+_dragEndEvent+' '+_dragCancelEvent;_downEvents=_dragStartEvent;if(_pointerEventEnabled&&!_likelyTouchDevice){_likelyTouchDevice=(navigator.maxTouchPoints>1)||(navigator.msMaxTouchPoints>1);}
self.likelyTouchDevice=_likelyTouchDevice;_globalEventHandlers[_dragStartEvent]=_onDragStart;_globalEventHandlers[_dragMoveEvent]=_onDragMove;_globalEventHandlers[_dragEndEvent]=_onDragRelease;if(_dragCancelEvent){_globalEventHandlers[_dragCancelEvent]=_globalEventHandlers[_dragEndEvent];}
if(_features.touch){_downEvents+=' mousedown';_upMoveEvents+=' mousemove mouseup';_globalEventHandlers.mousedown=_globalEventHandlers[_dragStartEvent];_globalEventHandlers.mousemove=_globalEventHandlers[_dragMoveEvent];_globalEventHandlers.mouseup=_globalEventHandlers[_dragEndEvent];}
if(!_likelyTouchDevice){_options.allowPanToNext=false;}}}});var _showOrHideTimeout,_showOrHide=function(item,img,out,completeFn){if(_showOrHideTimeout){clearTimeout(_showOrHideTimeout);}
_initialZoomRunning=true;_initialContentSet=true;var thumbBounds;if(item.initialLayout){thumbBounds=item.initialLayout;item.initialLayout=null;}else{thumbBounds=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex);}
var duration=out?_options.hideAnimationDuration:_options.showAnimationDuration;var onComplete=function(){_stopAnimation('initialZoom');if(!out){_applyBgOpacity(1);if(img){img.style.display='block';}
framework.addClass(template,'pswp--animated-in');_shout('initialZoom'+(out?'OutEnd':'InEnd'));}else{self.template.removeAttribute('style');self.bg.removeAttribute('style');}
if(completeFn){completeFn();}
_initialZoomRunning=false;};if(!duration||!thumbBounds||thumbBounds.x===undefined){_shout('initialZoom'+(out?'Out':'In'));_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();template.style.opacity=out?0:1;_applyBgOpacity(1);if(duration){setTimeout(function(){onComplete();},duration);}else{onComplete();}
return;}
var startAnimation=function(){var closeWithRaf=_closedByScroll,fadeEverything=!self.currItem.src||self.currItem.loadError||_options.showHideOpacity;if(item.miniImg){item.miniImg.style.webkitBackfaceVisibility='hidden';}
if(!out){_currZoomLevel=thumbBounds.w/item.w;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_initalWindowScrollY;self[fadeEverything?'template':'bg'].style.opacity=0.001;_applyCurrentZoomPan();}
_registerStartAnimation('initialZoom');if(out&&!closeWithRaf){framework.removeClass(template,'pswp--animated-in');}
if(fadeEverything){if(out){framework[(closeWithRaf?'remove':'add')+'Class'](template,'pswp--animate_opacity');}else{setTimeout(function(){framework.addClass(template,'pswp--animate_opacity');},30);}}
_showOrHideTimeout=setTimeout(function(){_shout('initialZoom'+(out?'Out':'In'));if(!out){_currZoomLevel=item.initialZoomLevel;_equalizePoints(_panOffset,item.initialPosition);_applyCurrentZoomPan();_applyBgOpacity(1);if(fadeEverything){template.style.opacity=1;}else{_applyBgOpacity(1);}
_showOrHideTimeout=setTimeout(onComplete,duration+20);}else{var destZoomLevel=thumbBounds.w/item.w,initialPanOffset={x:_panOffset.x,y:_panOffset.y},initialZoomLevel=_currZoomLevel,initalBgOpacity=_bgOpacity,onUpdate=function(now){if(now===1){_currZoomLevel=destZoomLevel;_panOffset.x=thumbBounds.x;_panOffset.y=thumbBounds.y-_currentWindowScrollY;}else{_currZoomLevel=(destZoomLevel-initialZoomLevel)*now+initialZoomLevel;_panOffset.x=(thumbBounds.x-initialPanOffset.x)*now+initialPanOffset.x;_panOffset.y=(thumbBounds.y-_currentWindowScrollY-initialPanOffset.y)*now+initialPanOffset.y;}
_applyCurrentZoomPan();if(fadeEverything){template.style.opacity=1-now;}else{_applyBgOpacity(initalBgOpacity-now*initalBgOpacity);}};if(closeWithRaf){_animateProp('initialZoom',0,1,duration,framework.easing.cubic.out,onUpdate,onComplete);}else{onUpdate(1);_showOrHideTimeout=setTimeout(onComplete,duration+20);}}},out?25:90);};startAnimation();};var _items,_tempPanAreaSize={},_imagesToAppendPool=[],_initialContentSet,_initialZoomRunning,_controllerDefaultOptions={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:false,preload:[1,1],getNumItemsFn:function(){return _items.length;}};var _getItemAt,_getNumItems,_initialIsLoop,_getZeroBounds=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}};},_calculateSingleItemPanBounds=function(item,realPanElementW,realPanElementH){var bounds=item.bounds;bounds.center.x=Math.round((_tempPanAreaSize.x-realPanElementW)/2);bounds.center.y=Math.round((_tempPanAreaSize.y-realPanElementH)/2)+item.vGap.top;bounds.max.x=(realPanElementW>_tempPanAreaSize.x)?Math.round(_tempPanAreaSize.x-realPanElementW):bounds.center.x;bounds.max.y=(realPanElementH>_tempPanAreaSize.y)?Math.round(_tempPanAreaSize.y-realPanElementH)+item.vGap.top:bounds.center.y;bounds.min.x=(realPanElementW>_tempPanAreaSize.x)?0:bounds.center.x;bounds.min.y=(realPanElementH>_tempPanAreaSize.y)?item.vGap.top:bounds.center.y;},_calculateItemSize=function(item,viewportSize,zoomLevel){if(item.src&&!item.loadError){var isInitial=!zoomLevel;if(isInitial){if(!item.vGap){item.vGap={top:0,bottom:0};}
_shout('parseVerticalMargin',item);}
_tempPanAreaSize.x=viewportSize.x;_tempPanAreaSize.y=viewportSize.y-item.vGap.top-item.vGap.bottom;if(isInitial){var hRatio=_tempPanAreaSize.x/item.w;var vRatio=_tempPanAreaSize.y/item.h;item.fitRatio=hRatio<vRatio?hRatio:vRatio;var scaleMode=_options.scaleMode;if(scaleMode==='orig'){zoomLevel=1;}else if(scaleMode==='fit'){zoomLevel=item.fitRatio;}
if(zoomLevel>1){zoomLevel=1;}
item.initialZoomLevel=zoomLevel;if(!item.bounds){item.bounds=_getZeroBounds();}}
if(!zoomLevel){return;}
_calculateSingleItemPanBounds(item,item.w*zoomLevel,item.h*zoomLevel);if(isInitial&&zoomLevel===item.initialZoomLevel){item.initialPosition=item.bounds.center;}
return item.bounds;}else{item.w=item.h=0;item.initialZoomLevel=item.fitRatio=1;item.bounds=_getZeroBounds();item.initialPosition=item.bounds.center;return item.bounds;}},_appendImage=function(index,item,baseDiv,img,preventAnimation,keepPlaceholder){if(item.loadError){return;}
if(img){item.imageAppended=true;_setImageSize(item,img,(item===self.currItem&&_renderMaxResolution));baseDiv.appendChild(img);if(keepPlaceholder){setTimeout(function(){if(item&&item.loaded&&item.placeholder){item.placeholder.style.display='none';item.placeholder=null;}},500);}}},_preloadImage=function(item){item.loading=true;item.loaded=false;var img=item.img=framework.createEl('pswp__img','img');var onComplete=function(){item.loading=false;item.loaded=true;if(item.loadComplete){item.loadComplete(item);}else{item.img=null;}
img.onload=img.onerror=null;img=null;};img.onload=onComplete;img.onerror=function(){item.loadError=true;onComplete();};img.src=item.src;return img;},_checkForError=function(item,cleanUp){if(item.src&&item.loadError&&item.container){if(cleanUp){item.container.innerHTML='';}
item.container.innerHTML=_options.errorMsg.replace('%url%',item.src);return true;}},_setImageSize=function(item,img,maxRes){if(!item.src){return;}
if(!img){img=item.container.lastChild;}
var w=maxRes?item.w:Math.round(item.w*item.fitRatio),h=maxRes?item.h:Math.round(item.h*item.fitRatio);if(item.placeholder&&!item.loaded){item.placeholder.style.width=w+'px';item.placeholder.style.height=h+'px';}
img.style.width=w+'px';img.style.height=h+'px';},_appendImagesPool=function(){if(_imagesToAppendPool.length){var poolItem;for(var i=0;i<_imagesToAppendPool.length;i++){poolItem=_imagesToAppendPool[i];if(poolItem.holder.index===poolItem.index){_appendImage(poolItem.index,poolItem.item,poolItem.baseDiv,poolItem.img,false,poolItem.clearPlaceholder);}}
_imagesToAppendPool=[];}};_registerModule('Controller',{publicMethods:{lazyLoadItem:function(index){index=_getLoopedId(index);var item=_getItemAt(index);if(!item||((item.loaded||item.loading)&&!_itemsNeedUpdate)){return;}
_shout('gettingData',index,item);if(!item.src){return;}
_preloadImage(item);},initController:function(){framework.extend(_options,_controllerDefaultOptions,true);self.items=_items=items;_getItemAt=self.getItemAt;_getNumItems=_options.getNumItemsFn;_initialIsLoop=_options.loop;if(_getNumItems()<3){_options.loop=false;}
_listen('beforeChange',function(diff){var p=_options.preload,isNext=diff===null?true:(diff>=0),preloadBefore=Math.min(p[0],_getNumItems()),preloadAfter=Math.min(p[1],_getNumItems()),i;for(i=1;i<=(isNext?preloadAfter:preloadBefore);i++){self.lazyLoadItem(_currentItemIndex+i);}
for(i=1;i<=(isNext?preloadBefore:preloadAfter);i++){self.lazyLoadItem(_currentItemIndex-i);}});_listen('initialLayout',function(){self.currItem.initialLayout=_options.getThumbBoundsFn&&_options.getThumbBoundsFn(_currentItemIndex);});_listen('mainScrollAnimComplete',_appendImagesPool);_listen('initialZoomInEnd',_appendImagesPool);_listen('destroy',function(){var item;for(var i=0;i<_items.length;i++){item=_items[i];if(item.container){item.container=null;}
if(item.placeholder){item.placeholder=null;}
if(item.img){item.img=null;}
if(item.preloader){item.preloader=null;}
if(item.loadError){item.loaded=item.loadError=false;}}
_imagesToAppendPool=null;});},getItemAt:function(index){if(index>=0){return _items[index]!==undefined?_items[index]:false;}
return false;},allowProgressiveImg:function(){return _options.forceProgressiveLoading||!_likelyTouchDevice||_options.mouseUsed||screen.width>1200;},setContent:function(holder,index){if(_options.loop){index=_getLoopedId(index);}
var prevItem=self.getItemAt(holder.index);if(prevItem){prevItem.container=null;}
var item=self.getItemAt(index),img;if(!item){holder.el.innerHTML='';return;}
_shout('gettingData',index,item);holder.index=index;holder.item=item;var baseDiv=item.container=framework.createEl('pswp__zoom-wrap');if(!item.src&&item.html){if(item.html.tagName){baseDiv.appendChild(item.html);}else{baseDiv.innerHTML=item.html;}}
_checkForError(item);_calculateItemSize(item,_viewportSize);if(item.src&&!item.loadError&&!item.loaded){item.loadComplete=function(item){if(!_isOpen){return;}
if(holder&&holder.index===index){if(_checkForError(item,true)){item.loadComplete=item.img=null;_calculateItemSize(item,_viewportSize);_applyZoomPanToItem(item);if(holder.index===_currentItemIndex){self.updateCurrZoomItem();}
return;}
if(!item.imageAppended){if(_features.transform&&(_mainScrollAnimating||_initialZoomRunning)){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder,clearPlaceholder:true});}else{_appendImage(index,item,baseDiv,item.img,_mainScrollAnimating||_initialZoomRunning,true);}}else{if(!_initialZoomRunning&&item.placeholder){item.placeholder.style.display='none';item.placeholder=null;}}}
item.loadComplete=null;item.img=null;_shout('imageLoadComplete',index,item);};if(framework.features.transform){var placeholderClassName='pswp__img pswp__img--placeholder';placeholderClassName+=(item.msrc?'':' pswp__img--placeholder--blank');var placeholder=framework.createEl(placeholderClassName,item.msrc?'img':'');if(item.msrc){placeholder.src=item.msrc;}
_setImageSize(item,placeholder);baseDiv.appendChild(placeholder);item.placeholder=placeholder;}
if(!item.loading){_preloadImage(item);}
if(self.allowProgressiveImg()){if(!_initialContentSet&&_features.transform){_imagesToAppendPool.push({item:item,baseDiv:baseDiv,img:item.img,index:index,holder:holder});}else{_appendImage(index,item,baseDiv,item.img,true,true);}}}else if(item.src&&!item.loadError){img=framework.createEl('pswp__img','img');img.style.opacity=1;img.src=item.src;_setImageSize(item,img);_appendImage(index,item,baseDiv,img,true);}
if(!_initialContentSet&&index===_currentItemIndex){_currZoomElementStyle=baseDiv.style;_showOrHide(item,(img||item.img));}else{_applyZoomPanToItem(item);}
holder.el.innerHTML='';holder.el.appendChild(baseDiv);},cleanSlide:function(item){if(item.img){item.img.onload=item.img.onerror=null;}
item.loaded=item.loading=item.img=item.imageAppended=false;}}});var tapTimer,tapReleasePoint={},_dispatchTapEvent=function(origEvent,releasePoint,pointerType){var e=document.createEvent('CustomEvent'),eDetail={origEvent:origEvent,target:origEvent.target,releasePoint:releasePoint,pointerType:pointerType||'touch'};e.initCustomEvent('pswpTap',true,true,eDetail);origEvent.target.dispatchEvent(e);};_registerModule('Tap',{publicMethods:{initTap:function(){_listen('firstTouchStart',self.onTapStart);_listen('touchRelease',self.onTapRelease);_listen('destroy',function(){tapReleasePoint={};tapTimer=null;});},onTapStart:function(touchList){if(touchList.length>1){clearTimeout(tapTimer);tapTimer=null;}},onTapRelease:function(e,releasePoint){if(!releasePoint){return;}
if(!_moved&&!_isMultitouch&&!_numAnimations){var p0=releasePoint;if(tapTimer){clearTimeout(tapTimer);tapTimer=null;if(_isNearbyPoints(p0,tapReleasePoint)){_shout('doubleTap',p0);return;}}
if(releasePoint.type==='mouse'){_dispatchTapEvent(e,releasePoint,'mouse');return;}
var clickedTagName=e.target.tagName.toUpperCase();if(clickedTagName==='BUTTON'||framework.hasClass(e.target,'pswp__single-tap')){_dispatchTapEvent(e,releasePoint);return;}
_equalizePoints(tapReleasePoint,p0);tapTimer=setTimeout(function(){_dispatchTapEvent(e,releasePoint);tapTimer=null;},300);}}}});var _wheelDelta;_registerModule('DesktopZoom',{publicMethods:{initDesktopZoom:function(){if(_oldIE){return;}
if(_likelyTouchDevice){_listen('mouseUsed',function(){self.setupDesktopZoom();});}else{self.setupDesktopZoom(true);}},setupDesktopZoom:function(onInit){_wheelDelta={};var events='wheel mousewheel DOMMouseScroll';_listen('bindEvents',function(){framework.bind(template,events,self.handleMouseWheel);});_listen('unbindEvents',function(){if(_wheelDelta){framework.unbind(template,events,self.handleMouseWheel);}});self.mouseZoomedIn=false;var hasDraggingClass,updateZoomable=function(){if(self.mouseZoomedIn){framework.removeClass(template,'pswp--zoomed-in');self.mouseZoomedIn=false;}
if(_currZoomLevel<1){framework.addClass(template,'pswp--zoom-allowed');}else{framework.removeClass(template,'pswp--zoom-allowed');}
removeDraggingClass();},removeDraggingClass=function(){if(hasDraggingClass){framework.removeClass(template,'pswp--dragging');hasDraggingClass=false;}};_listen('resize',updateZoomable);_listen('afterChange',updateZoomable);_listen('pointerDown',function(){if(self.mouseZoomedIn){hasDraggingClass=true;framework.addClass(template,'pswp--dragging');}});_listen('pointerUp',removeDraggingClass);if(!onInit){updateZoomable();}},handleMouseWheel:function(e){if(_currZoomLevel<=self.currItem.fitRatio){if(_options.modal){if(!_options.closeOnScroll||_numAnimations||_isDragging){e.preventDefault();}else if(_transformKey&&Math.abs(e.deltaY)>2){_closedByScroll=true;self.close();}}
return true;}
e.stopPropagation();_wheelDelta.x=0;if('deltaX'in e){if(e.deltaMode===1){_wheelDelta.x=e.deltaX*18;_wheelDelta.y=e.deltaY*18;}else{_wheelDelta.x=e.deltaX;_wheelDelta.y=e.deltaY;}}else if('wheelDelta'in e){if(e.wheelDeltaX){_wheelDelta.x=-0.16*e.wheelDeltaX;}
if(e.wheelDeltaY){_wheelDelta.y=-0.16*e.wheelDeltaY;}else{_wheelDelta.y=-0.16*e.wheelDelta;}}else if('detail'in e){_wheelDelta.y=e.detail;}else{return;}
_calculatePanBounds(_currZoomLevel,true);var newPanX=_panOffset.x-_wheelDelta.x,newPanY=_panOffset.y-_wheelDelta.y;if(_options.modal||(newPanX<=_currPanBounds.min.x&&newPanX>=_currPanBounds.max.x&&newPanY<=_currPanBounds.min.y&&newPanY>=_currPanBounds.max.y)){e.preventDefault();}
self.panTo(newPanX,newPanY);},toggleDesktopZoom:function(centerPoint){centerPoint=centerPoint||{x:_viewportSize.x/2+_offset.x,y:_viewportSize.y/2+_offset.y};var doubleTapZoomLevel=_options.getDoubleTapZoom(true,self.currItem);var zoomOut=_currZoomLevel===doubleTapZoomLevel;self.mouseZoomedIn=!zoomOut;self.zoomTo(zoomOut?self.currItem.initialZoomLevel:doubleTapZoomLevel,centerPoint,333);framework[(!zoomOut?'add':'remove')+'Class'](template,'pswp--zoomed-in');}}});var _historyDefaultOptions={history:true,galleryUID:1};var _historyUpdateTimeout,_hashChangeTimeout,_hashAnimCheckTimeout,_hashChangedByScript,_hashChangedByHistory,_hashReseted,_initialHash,_historyChanged,_closedFromURL,_urlChangedOnce,_windowLoc,_supportsPushState,_getHash=function(){return _windowLoc.hash.substring(1);},_cleanHistoryTimeouts=function(){if(_historyUpdateTimeout){clearTimeout(_historyUpdateTimeout);}
if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout);}},_parseItemIndexFromURL=function(){var hash=_getHash(),params={};if(hash.length<5){return params;}
var i,vars=hash.split('&');for(i=0;i<vars.length;i++){if(!vars[i]){continue;}
var pair=vars[i].split('=');if(pair.length<2){continue;}
params[pair[0]]=pair[1];}
if(_options.galleryPIDs){var searchfor=params.pid;params.pid=0;for(i=0;i<_items.length;i++){if(_items[i].pid===searchfor){params.pid=i;break;}}}else{params.pid=parseInt(params.pid,10)-1;}
if(params.pid<0){params.pid=0;}
return params;},_updateHash=function(){if(_hashAnimCheckTimeout){clearTimeout(_hashAnimCheckTimeout);}
if(_numAnimations||_isDragging){_hashAnimCheckTimeout=setTimeout(_updateHash,500);return;}
if(_hashChangedByScript){clearTimeout(_hashChangeTimeout);}else{_hashChangedByScript=true;}
var pid=(_currentItemIndex+1);var item=_getItemAt(_currentItemIndex);if(item.hasOwnProperty('pid')){pid=item.pid;}
var newHash=_initialHash+'&'+'gid='+_options.galleryUID+'&'+'pid='+pid;if(!_historyChanged){if(_windowLoc.hash.indexOf(newHash)===-1){_urlChangedOnce=true;}}
var newURL=_windowLoc.href.split('#')[0]+'#'+newHash;if(_supportsPushState){if('#'+newHash!==window.location.hash){history[_historyChanged?'replaceState':'pushState']('',document.title,newURL);}}else{if(_historyChanged){_windowLoc.replace(newURL);}else{_windowLoc.hash=newHash;}}
_historyChanged=true;_hashChangeTimeout=setTimeout(function(){_hashChangedByScript=false;},60);};_registerModule('History',{publicMethods:{initHistory:function(){framework.extend(_options,_historyDefaultOptions,true);if(!_options.history){return;}
_windowLoc=window.location;_urlChangedOnce=false;_closedFromURL=false;_historyChanged=false;_initialHash=_getHash();_supportsPushState=('pushState'in history);if(_initialHash.indexOf('gid=')>-1){_initialHash=_initialHash.split('&gid=')[0];_initialHash=_initialHash.split('?gid=')[0];}
_listen('afterChange',self.updateURL);_listen('unbindEvents',function(){framework.unbind(window,'hashchange',self.onHashChange);});var returnToOriginal=function(){_hashReseted=true;if(!_closedFromURL){if(_urlChangedOnce){history.back();}else{if(_initialHash){_windowLoc.hash=_initialHash;}else{if(_supportsPushState){history.pushState('',document.title,_windowLoc.pathname+_windowLoc.search);}else{_windowLoc.hash='';}}}}
_cleanHistoryTimeouts();};_listen('unbindEvents',function(){if(_closedByScroll){returnToOriginal();}});_listen('destroy',function(){if(!_hashReseted){returnToOriginal();}});_listen('firstUpdate',function(){_currentItemIndex=_parseItemIndexFromURL().pid;});var index=_initialHash.indexOf('pid=');if(index>-1){_initialHash=_initialHash.substring(0,index);if(_initialHash.slice(-1)==='&'){_initialHash=_initialHash.slice(0,-1);}}
setTimeout(function(){if(_isOpen){framework.bind(window,'hashchange',self.onHashChange);}},40);},onHashChange:function(){if(_getHash()===_initialHash){_closedFromURL=true;self.close();return;}
if(!_hashChangedByScript){_hashChangedByHistory=true;self.goTo(_parseItemIndexFromURL().pid);_hashChangedByHistory=false;}},updateURL:function(){_cleanHistoryTimeouts();if(_hashChangedByHistory){return;}
if(!_historyChanged){_updateHash();}else{_historyUpdateTimeout=setTimeout(_updateHash,800);}}}});framework.extend(self,publicMethods);};return PhotoSwipe;});(function(root,factory){if(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.PhotoSwipeUI_Default=factory();}})(this,function(){'use strict';var PhotoSwipeUI_Default=function(pswp,framework){var ui=this;var _overlayUIUpdated=false,_controlsVisible=true,_fullscrenAPI,_controls,_captionContainer,_fakeCaptionContainer,_indexIndicator,_shareButton,_shareModal,_shareModalHidden=true,_initalCloseOnScrollValue,_isIdle,_listen,_loadingIndicator,_loadingIndicatorHidden,_loadingIndicatorTimeout,_galleryHasOneSlide,_options,_defaultUIOptions={barsSize:{top:44,bottom:'auto'},closeElClasses:['item','caption','zoom-wrap','ui','top-bar'],timeToIdle:4000,timeToIdleOutside:1000,loadingIndicatorDelay:1000,addCaptionHTMLFn:function(item,captionEl){if(!item.title){captionEl.children[0].innerHTML='';return false;}
captionEl.children[0].innerHTML=item.title;return true;},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:'facebook',label:'Share on Facebook',url:'https://www.facebook.com/sharer/sharer.php?u={{url}}'},{id:'twitter',label:'Tweet',url:'https://twitter.com/intent/tweet?text={{text}}&url={{url}}'},{id:'pinterest',label:'Pin it',url:'http://www.pinterest.com/pin/create/button/'+'?url={{url}}&media={{image_url}}&description={{text}}'},{id:'download',label:'Download image',url:'{{raw_image_url}}',download:true}],getImageURLForShare:function(){return pswp.currItem.src||'';},getPageURLForShare:function(){return window.location.href;},getTextForShare:function(){return pswp.currItem.title||'';},getShareUrl:function(){return(pswp.currItem.shareUrl+'/')||'';},getShareHeadline:function(){return pswp.currItem.shareHeadline||'';},getShortUrl:function(){return pswp.currItem.shortUrl||'';},getShareSummary:function(){return pswp.currItem.shareSummary||'';},getShareMainMediaUrl:function(){return pswp.currItem.imageUrl||'';},indexIndicatorSep:' / ',fitControlsWidth:1200},_blockControlsTap,_blockControlsTapTimeout;var _onControlsTap=function(e){if(_blockControlsTap){return true;}
e=e||window.event;if(_options.timeToIdle&&_options.mouseUsed&&!_isIdle){_onIdleMouseMove();}
var target=e.target||e.srcElement,uiElement,clickedClass=target.getAttribute('class')||'',found;for(var i=0;i<_uiElements.length;i++){uiElement=_uiElements[i];if(uiElement.onTap&&clickedClass.indexOf('pswp__'+uiElement.name)>-1){uiElement.onTap();found=true;}}
if(found){if(e.stopPropagation){e.stopPropagation();}
_blockControlsTap=true;var tapDelay=framework.features.isOldAndroid?600:30;_blockControlsTapTimeout=setTimeout(function(){_blockControlsTap=false;},tapDelay);}},_fitControlsInViewport=function(){return!pswp.likelyTouchDevice||_options.mouseUsed||screen.width>_options.fitControlsWidth;},_togglePswpClass=function(el,cName,add){framework[(add?'add':'remove')+'Class'](el,'pswp__'+cName);},_countNumItems=function(){var hasOneSlide=(_options.getNumItemsFn()===1);if(hasOneSlide!==_galleryHasOneSlide){_togglePswpClass(_controls,'ui--one-slide',hasOneSlide);_galleryHasOneSlide=hasOneSlide;}},_toggleShareModalClass=function(){_togglePswpClass(_shareModal,'share-modal--hidden',_shareModalHidden);},_toggleShareModal=function(){_shareModalHidden=!_shareModalHidden;if(!_shareModalHidden){_toggleShareModalClass();setTimeout(function(){if(!_shareModalHidden){framework.addClass(_shareModal,'pswp__share-modal--fade-in');}},30);}else{framework.removeClass(_shareModal,'pswp__share-modal--fade-in');setTimeout(function(){if(_shareModalHidden){_toggleShareModalClass();}},300);}
if(!_shareModalHidden){_updateShareURLs();}
return false;},_openWindowPopup=function(e){e=e||window.event;var target=e.target||e.srcElement;pswp.shout('shareLinkClick',e,target);if(!target.href){return false;}
if(target.hasAttribute('download')){return true;}
window.open(target.href,'pswp_share','scrollbars=yes,resizable=yes,toolbar=no,'+'location=yes,width=550,height=420,top=100,left='+
(window.screen?Math.round(screen.width/2-275):100));if(!_shareModalHidden){_toggleShareModal();}
return false;},_updateShareURLs=function(){var shareButtonOut='',shareButtonData,shareURL,image_url,page_url,share_text;var shareObj={},shareUrl,shareHeadline,shortUrl,shareSummary,shareMainMediaUrl;for(var i=0;i<_options.shareButtons.length;i++){shareButtonData=_options.shareButtons[i];image_url=_options.getImageURLForShare(shareButtonData);page_url=_options.getPageURLForShare(shareButtonData);share_text=_options.getTextForShare(shareButtonData);shareUrl=_options.getShareUrl(shareButtonData);shareHeadline=_options.getShareHeadline(shareButtonData);shortUrl=_options.getShortUrl(shareButtonData);shareSummary=_options.getShareSummary(shareButtonData);shareMainMediaUrl=_options.getShareMainMediaUrl(shareButtonData);shareObj.shareUrl=shareURL=shareButtonData.shareUrl.replace('{{shareUrl}}',shareUrl);shareObj.shareHeadline=shareHeadline=shareButtonData.shareHeadline.replace('{{shareHeadline}}',shareHeadline);shareObj.shortUrl=shortUrl=shareButtonData.shortUrl.replace('{{shortUrl}}',shortUrl);shareObj.shareSummary=shareSummary=shareButtonData.shareSummary.replace('{{shareSummary}}',shareSummary);shareObj.shareMainMediaUrl=shareMainMediaUrl=shareButtonData.shareMainMediaUrl.replace('{{shareMainMediaUrl}}',shareMainMediaUrl);if(_options.parseShareButtonOut){shareButtonOut=_options.parseShareButtonOut(shareButtonData,shareButtonOut,shareObj);}}
jQuery(_shareModal.children[0]).empty()
jQuery(_shareModal.children[0]).append(shareButtonOut)},_hasCloseClass=function(target){for(var i=0;i<_options.closeElClasses.length;i++){if(framework.hasClass(target,'pswp__'+_options.closeElClasses[i])){return true;}}},_idleInterval,_idleTimer,_idleIncrement=0,_onIdleMouseMove=function(){clearTimeout(_idleTimer);_idleIncrement=0;if(_isIdle){ui.setIdle(false);}},_onMouseLeaveWindow=function(e){e=e?e:window.event;var from=e.relatedTarget||e.toElement;if(!from||from.nodeName==='HTML'){clearTimeout(_idleTimer);_idleTimer=setTimeout(function(){ui.setIdle(true);},_options.timeToIdleOutside);}},_setupFullscreenAPI=function(){if(_options.fullscreenEl&&!framework.features.isOldAndroid){if(!_fullscrenAPI){_fullscrenAPI=ui.getFullscreenAPI();}
if(_fullscrenAPI){framework.bind(document,_fullscrenAPI.eventK,ui.updateFullscreen);ui.updateFullscreen();framework.addClass(pswp.template,'pswp--supports-fs');}else{framework.removeClass(pswp.template,'pswp--supports-fs');}}},_setupLoadingIndicator=function(){if(_options.preloaderEl){_toggleLoadingIndicator(true);_listen('beforeChange',function(){clearTimeout(_loadingIndicatorTimeout);_loadingIndicatorTimeout=setTimeout(function(){if(pswp.currItem&&pswp.currItem.loading){if(!pswp.allowProgressiveImg()||(pswp.currItem.img&&!pswp.currItem.img.naturalWidth)){_toggleLoadingIndicator(false);}}else{_toggleLoadingIndicator(true);}},_options.loadingIndicatorDelay);});_listen('imageLoadComplete',function(index,item){if(pswp.currItem===item){_toggleLoadingIndicator(true);}});}},_toggleLoadingIndicator=function(hide){if(_loadingIndicatorHidden!==hide){_togglePswpClass(_loadingIndicator,'preloader--active',!hide);_loadingIndicatorHidden=hide;}},_applyNavBarGaps=function(item){var gap=item.vGap;if(_fitControlsInViewport()){var bars=_options.barsSize;if(_options.captionEl&&bars.bottom==='auto'){if(!_fakeCaptionContainer){_fakeCaptionContainer=framework.createEl('pswp__caption pswp__caption--fake');_fakeCaptionContainer.appendChild(framework.createEl('pswp__caption__center'));_controls.insertBefore(_fakeCaptionContainer,_captionContainer);framework.addClass(_controls,'pswp__ui--fit');}
if(_options.addCaptionHTMLFn(item,_fakeCaptionContainer,true)){var captionSize=_fakeCaptionContainer.clientHeight;gap.bottom=parseInt(captionSize,10)||44;}else{gap.bottom=bars.top;}}else{gap.bottom=bars.bottom==='auto'?0:bars.bottom;}
gap.top=bars.top;}else{gap.top=gap.bottom=0;}},_setupIdle=function(){if(_options.timeToIdle){_listen('mouseUsed',function(){framework.bind(document,'mousemove',_onIdleMouseMove);framework.bind(document,'mouseout',_onMouseLeaveWindow);_idleInterval=setInterval(function(){_idleIncrement++;if(_idleIncrement===2){ui.setIdle(true);}},_options.timeToIdle/2);});}},_setupHidingControlsDuringGestures=function(){_listen('onVerticalDrag',function(now){if(_controlsVisible&&now<0.95){ui.hideControls();}else if(!_controlsVisible&&now>=0.95){ui.showControls();}});var pinchControlsHidden;_listen('onPinchClose',function(now){if(_controlsVisible&&now<0.9){ui.hideControls();pinchControlsHidden=true;}else if(pinchControlsHidden&&!_controlsVisible&&now>0.9){ui.showControls();}});_listen('zoomGestureEnded',function(){pinchControlsHidden=false;if(pinchControlsHidden&&!_controlsVisible){ui.showControls();}});};var _uiElements=[{name:'caption',option:'captionEl',onInit:function(el){_captionContainer=el;}},{name:'share-modal',option:'shareEl',onInit:function(el){_shareModal=el;},onTap:function(){_toggleShareModal();}},{name:'button--share',option:'shareEl',onInit:function(el){_shareButton=el;},onTap:function(){_toggleShareModal();}},{name:'button--zoom',option:'zoomEl',onTap:pswp.toggleDesktopZoom},{name:'counter',option:'counterEl',onInit:function(el){_indexIndicator=el;}},{name:'button--close',option:'closeEl',onTap:pswp.close},{name:'button--arrow--left',option:'arrowEl',onTap:pswp.prev},{name:'button--arrow--right',option:'arrowEl',onTap:pswp.next},{name:'button--fs',option:'fullscreenEl',onTap:function(){if(_fullscrenAPI.isFullscreen()){_fullscrenAPI.exit();}else{_fullscrenAPI.enter();}}},{name:'preloader',option:'preloaderEl',onInit:function(el){_loadingIndicator=el;}}];var _setupUIElements=function(){var item,classAttr,uiElement;var loopThroughChildElements=function(sChildren){if(!sChildren){return;}
var l=sChildren.length;for(var i=0;i<l;i++){item=sChildren[i];classAttr=item.className;for(var a=0;a<_uiElements.length;a++){uiElement=_uiElements[a];if(classAttr.indexOf('pswp__'+uiElement.name)>-1){if(_options[uiElement.option]){framework.removeClass(item,'pswp__element--disabled');if(uiElement.onInit){uiElement.onInit(item);}}else{framework.addClass(item,'pswp__element--disabled');}}}}};loopThroughChildElements(_controls.children);var topBar=framework.getChildByClass(_controls,'pswp__top-bar');if(topBar){loopThroughChildElements(topBar.children);}};ui.init=function(){framework.extend(pswp.options,_defaultUIOptions,true);_options=pswp.options;_controls=framework.getChildByClass(pswp.scrollWrap,'pswp__ui');_listen=pswp.listen;_setupHidingControlsDuringGestures();_listen('beforeChange',ui.update);_listen('doubleTap',function(point){var initialZoomLevel=pswp.currItem.initialZoomLevel;if(pswp.getZoomLevel()!==initialZoomLevel){pswp.zoomTo(initialZoomLevel,point,333);}else{if($(pswp.container).next(".pswp__ui").find(".pswp__share-modal").is(":visible")){return;}
pswp.zoomTo(_options.getDoubleTapZoom(false,pswp.currItem),point,333);}});_listen('preventDragEvent',function(e,isDown,preventObj){var t=e.target||e.srcElement;if(t&&t.getAttribute('class')&&e.type.indexOf('mouse')>-1&&(t.getAttribute('class').indexOf('__caption')>0||(/(SMALL|STRONG|EM)/i).test(t.tagName))){preventObj.prevent=false;}});_listen('bindEvents',function(){framework.bind(_controls,'pswpTap click',_onControlsTap);framework.bind(pswp.scrollWrap,'pswpTap',ui.onGlobalTap);if(!pswp.likelyTouchDevice){framework.bind(pswp.scrollWrap,'mouseover',ui.onMouseOver);}});_listen('unbindEvents',function(){if(!_shareModalHidden){_toggleShareModal();}
if(_idleInterval){clearInterval(_idleInterval);}
framework.unbind(document,'mouseout',_onMouseLeaveWindow);framework.unbind(document,'mousemove',_onIdleMouseMove);framework.unbind(_controls,'pswpTap click',_onControlsTap);framework.unbind(pswp.scrollWrap,'pswpTap',ui.onGlobalTap);framework.unbind(pswp.scrollWrap,'mouseover',ui.onMouseOver);if(_fullscrenAPI){framework.unbind(document,_fullscrenAPI.eventK,ui.updateFullscreen);if(_fullscrenAPI.isFullscreen()){_options.hideAnimationDuration=0;_fullscrenAPI.exit();}
_fullscrenAPI=null;}});_listen('destroy',function(){if(_options.captionEl){if(_fakeCaptionContainer){_controls.removeChild(_fakeCaptionContainer);}
framework.removeClass(_captionContainer,'pswp__caption--empty');}
if(_shareModal){_shareModal.children[0].onclick=null;}
framework.removeClass(_controls,'pswp__ui--over-close');framework.addClass(_controls,'pswp__ui--hidden');ui.setIdle(false);});if(!_options.showAnimationDuration){framework.removeClass(_controls,'pswp__ui--hidden');}
_listen('initialZoomIn',function(){if(_options.showAnimationDuration){framework.removeClass(_controls,'pswp__ui--hidden');}});_listen('initialZoomOut',function(){framework.addClass(_controls,'pswp__ui--hidden');});_listen('parseVerticalMargin',_applyNavBarGaps);_setupUIElements();if(_options.shareEl&&_shareButton&&_shareModal){_shareModalHidden=true;}
_countNumItems();_setupIdle();_setupFullscreenAPI();_setupLoadingIndicator();};ui.setIdle=function(isIdle){_isIdle=isIdle;_togglePswpClass(_controls,'ui--idle',isIdle);};ui.update=function(){if(_controlsVisible&&pswp.currItem){ui.updateIndexIndicator();if(_options.captionEl){_options.addCaptionHTMLFn(pswp.currItem,_captionContainer);_togglePswpClass(_captionContainer,'caption--empty',!pswp.currItem.title);}
_overlayUIUpdated=true;}else{_overlayUIUpdated=false;}
if(!_shareModalHidden){_toggleShareModal();}
_countNumItems();};ui.updateFullscreen=function(e){if(e){setTimeout(function(){pswp.setScrollOffset(0,framework.getScrollY());},50);}
framework[(_fullscrenAPI.isFullscreen()?'add':'remove')+'Class'](pswp.template,'pswp--fs');};ui.updateIndexIndicator=function(){if(_options.counterEl){_indexIndicator.innerHTML=(pswp.getCurrentIndex()+1)+
_options.indexIndicatorSep+
_options.getNumItemsFn();}};ui.onGlobalTap=function(e){e=e||window.event;var target=e.target||e.srcElement;if(_blockControlsTap){return;}
if(e.detail&&e.detail.pointerType==='mouse'){if(_hasCloseClass(target)){pswp.close();return;}
if(framework.hasClass(target,'pswp__img')){if(pswp.getZoomLevel()===1&&pswp.getZoomLevel()<=pswp.currItem.fitRatio){if(_options.clickToCloseNonZoomable){pswp.close();}}else{pswp.toggleDesktopZoom(e.detail.releasePoint);}}}else{if(_options.tapToToggleControls){if(_controlsVisible){ui.hideControls();}else{ui.showControls();}}
if(_options.tapToClose&&(framework.hasClass(target,'pswp__img')||_hasCloseClass(target))){pswp.close();return;}}};ui.onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement;_togglePswpClass(_controls,'ui--over-close',_hasCloseClass(target));};ui.hideControls=function(){framework.addClass(_controls,'pswp__ui--hidden');_controlsVisible=false;};ui.showControls=function(){_controlsVisible=true;if(!_overlayUIUpdated){ui.update();}
framework.removeClass(_controls,'pswp__ui--hidden');};ui.supportsFullscreen=function(){var d=document;return!!(d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.msExitFullscreen);};ui.getFullscreenAPI=function(){var dE=document.documentElement,api,tF='fullscreenchange';if(dE.requestFullscreen){api={enterK:'requestFullscreen',exitK:'exitFullscreen',elementK:'fullscreenElement',eventK:tF};}else if(dE.mozRequestFullScreen){api={enterK:'mozRequestFullScreen',exitK:'mozCancelFullScreen',elementK:'mozFullScreenElement',eventK:'moz'+tF};}else if(dE.webkitRequestFullscreen){api={enterK:'webkitRequestFullscreen',exitK:'webkitExitFullscreen',elementK:'webkitFullscreenElement',eventK:'webkit'+tF};}else if(dE.msRequestFullscreen){api={enterK:'msRequestFullscreen',exitK:'msExitFullscreen',elementK:'msFullscreenElement',eventK:'MSFullscreenChange'};}
if(api){api.enter=function(){_initalCloseOnScrollValue=_options.closeOnScroll;_options.closeOnScroll=false;if(this.enterK==='webkitRequestFullscreen'){pswp.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT);}else{return pswp.template[this.enterK]();}};api.exit=function(){_options.closeOnScroll=_initalCloseOnScrollValue;return document[this.exitK]();};api.isFullscreen=function(){return document[this.elementK];};}
return api;};};return PhotoSwipeUI_Default;});"use strict"
snaApp.factory('videoPlayer',['$rootScope','appConfig','$http','$log','$sce','$filter','getDeviceOSService',function($rootScope,appConfig,$http,$log,$sce,$filter,getDeviceOSService){var make360VideoSameDomain=function(_360Videourl){_360Videourl=_360Videourl.replace(/^(https?)(\:\/\/.+\.com)/ig,function(){if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
var changedDomain=window.location.origin;return changedDomain;});return _360Videourl;};var videoPlayer=new function(){this.jwplayer=function(elementId,urls,isAndroid,autoStart,image,adTag,isYotube,tracksThumbnails,relatedVideos,jwPlayerMediaId,videoTitle,muted,videoId,currentVideoObj,isVrSupportedPlayer,viewportWidthObj){if(isVrSupportedPlayer&&currentVideoObj.is360Video){var isVrVideoSupported=true;}
var srcUrls=[];for(var i=0;i<urls.length;i++){if(isVrVideoSupported&&currentVideoObj.is360Video){urls[i].url=make360VideoSameDomain(urls[i].url);}
srcUrls.push({file:urls[i].url});}
var tracks=[];if(tracksThumbnails&&tracksThumbnails.length>0){tracks=tracksThumbnails;if(document.location.protocol=='https:'&&typeof tracks[0].file!="undefined"){tracks[0].file=tracks[0].file.replace("http://","https://");}}
var _muted=muted||false;var repeat=false;var playlist=[{id:videoId,title:videoTitle,sources:srcUrls,image:image,tracks:tracks,mediaid:jwPlayerMediaId}];if(isVrVideoSupported&&window.jwplayerVersion==8){playlist[0].stereomode='monoscopic';}
if(isVrVideoSupported){relatedVideos=relatedVideos.filter(function(video){if(!video.is360Video){return false;}
return true;});}else if(isVrSupportedPlayer&&!currentVideoObj.is360Video){relatedVideos=relatedVideos.filter(function(video){if(video.is360Video){return false;}
return true;});}
if(typeof relatedVideos!=='undefined'&&relatedVideos.length>0&&(getIEVersion()==0||getIEVersion()>9)){var relatedVideosList;repeat=true;relatedVideosList=relatedVideos.map(function(video){var srcUrlsRelated=[];for(var i=0;i<video.videoUrl.length;i++){if(isVrVideoSupported&&video.is360Video){video.videoUrl[i].url=make360VideoSameDomain(video.videoUrl[i].url);}
srcUrlsRelated.push({file:video.videoUrl[i].url})}
var imageSrc='';if(lodash.get(viewportWidthObj,"viewportWidth",false)){imageSrc="/"+$rootScope.webContext+"/images"+$filter('imageAdvFilter')(video.mediaAsset.imageUrl,viewportWidthObj.viewportWidth,0.563,lodash.get(viewportWidthObj,"noSidebar",false),lodash.get(viewportWidthObj,"maxWidthOfRoot",null),lodash.get(viewportWidthObj,"maxWidthLevel1",null));}else{imageSrc="/"+$rootScope.webContext+"/images"+$filter('imagefilter')(video.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}
var videoItem={id:video.id,title:video.headline,sources:srcUrlsRelated,image:imageSrc,mediaid:video.jwPlayerMediaId,tracks:[{file:(document.location.protocol=='https:'&&typeof video.thumbnailUrl!="undefined"?video.thumbnailUrl.replace("http://","https://"):video.thumbnailUrl),kind:"thumbnails"}],videoObj:video};if(isVrVideoSupported&&video.is360Video&&window.jwplayerVersion==8){videoItem.stereomode='monoscopic';}
return videoItem;});if(typeof relatedVideosList!=='undefined'&&relatedVideosList.length>0){playlist[0].videoObj=currentVideoObj;playlist=playlist.concat(relatedVideosList);}}
var setup={primary:getIEVersion()==9?"flash":"html5",autostart:autoStart,repeat:repeat,mute:_muted,width:'100%',height:'100%',stretching:'uniform',androidhls:!!isAndroid,localization:{nextUp:' ',},"hlshtml":true,"skin":{"url":$rootScope.appAssetsUrl+"/styles/jw-skin-sna.css","name":"seven sna"},ga:{label:"title"},}
if(isYotube){setup.playlist=[{id:videoId,title:videoTitle,image:image,file:srcUrls[0].file,tracks:tracks,mediaid:jwPlayerMediaId}];}else{setup.playlist=playlist;}
if(isVrSupportedPlayer&&currentVideoObj.is360Video&&window.jwplayerVersion==7){setup.plugins={};setup.plugins[$rootScope.appAssetsUrl+'/js/lib/jwplayer-7.8.7/plugins/vr/vr.js']={}}
if(isVrVideoSupported&&((getDeviceOSService.isWindows&&isFirefox())||(isAndroidOS()&&isFirefox()))){setup.autostart=false;$(".win-and-ff-360-banner").show();}else{$(".win-and-ff-360-banner").hide();}
var player=jwplayer(elementId).setup(setup);player.on('pause',function(){this.pause(true);});player.on('play',function(event){if(event&&event.playReason=='interaction'){this.autoplay=false;}
if(this&&this.autoplay){return;}
if(this.snaPaused){this.pause(true);return;}else if(window.activeJWPlayer&&this&&window.activeJWPlayer.id!=this.id){if(window.activeJWPlayer.getState().toLowerCase()=='buffering'){window.activeJWPlayer.snaPaused=true;}
window.activeJWPlayer.pause(true);}
if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'){window.activeYtPlayer.pauseVideo();typeof window.activeYtPlayer.closeFlyout!='undefined'&&window.activeYtPlayer.closeFlyout();}
window.activeJWPlayer=this;typeof(playRadio)!='undefined'&&window.playRadio(true);if(isVrVideoSupported&&$rootScope.device=='DESKTOP'){if(isChrome()||isSafari()){$("#"+elementId+" .jw-media canvas").css("cursor","-webkit-grab")}else{$("#"+elementId+" .jw-media canvas").css("cursor","grab")}}});player.on('error',function(event){$log.error("Error playing video",event.message);});player.on('setupError',function(event){$log.error("Error setup player",event.message);});player.on('adPlay',function(){if(window.activeJWPlayer&&this&&window.activeJWPlayer.id!=this.id){window.activeJWPlayer.pause(true);}
window.activeJWPlayer=this;typeof(playRadio)!='undefined'&&window.playRadio(true);});player.on('adError',function(error){$log.error("Error loading ad",error.message);});if(typeof(screen)!='undefined'&&screen.unlockOrientation){player.on('fullscreen',function(event){if(event.fullscreen){screen.unlockOrientation();}else{screen.lockOrientation('portrait');}});}
return player;};}()
return videoPlayer;}]);'use strict'
snaApp.directive('bindHtmlCompile',['$compile',function($compile){return{restrict:'A',link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.bindHtmlCompile);},function(value){element.html(value);removeLastEmptyParagraphInArticleBody();$compile(element.contents())(scope);});function removeLastEmptyParagraphInArticleBody(){if(attrs.bindHtmlContentType=='article'){var lastParaEl=element.find("> p:last-child");var lastParaContent;if(lastParaEl&&lastParaEl.length>0){lastParaContent=lastParaEl.html().trim();var lastParaContentMatchForEmptyStrings=lastParaContent.match(/^(&nbsp;)*$/g);if(lastParaContentMatchForEmptyStrings&&lastParaContentMatchForEmptyStrings.length>0){lastParaEl.remove();}}}}}};}]);snaApp.directive("sna",['$rootScope','$interval','$timeout','$http','appConfig','$log',function($rootScope,$interval,$timeout,$http,appConfig,$log){function link(scope,element,attrs){var inlineItems=scope.$parent.inlineItems||[],inlineItem,allowPosition=scope.$parent.allowPosition,articleModal=scope.$parent.articleModal;if(typeof scope.$parent.article!="undefined"&&typeof scope.$parent.article.inlineItems!="undefined"&&Array.isArray(scope.$parent.article.inlineItems)&&scope.$parent.article.inlineItems.length>0){inlineItems=scope.$parent.article.inlineItems;}
for(var i=0;i<inlineItems.length;i++){if(attrs.refid==inlineItems[i].id){scope.inlineItem=inlineItems[i];inlineItem=inlineItems[i];break}}
var viewportWidth="";var bottomImgViewportWidth="";var nosidebar="false";var setImageGalleryViewportWidth=function(){if((!attrs.reftype.toLowerCase()=='image_gallery')||(!attrs.reftype.toLowerCase()=='video')||(!attrs.reftype.toLowerCase()=='image_set')){return;}
if(typeof scope.$parent.article!="undefined"&&location.pathname.split("/")[2].toLowerCase()=="article"){viewportWidth="[ [1, 0.66], [1, 0.83], [1, 1] ]";bottomImgViewportWidth="[ [.66, .16], [.83, .25], [1, 1] ]";}else if(typeof scope.$parent.blog!="undefined"){viewportWidth="[ [.66, 1], [.83, 1], [1, 1] ]";bottomImgViewportWidth="[ [.66, .16], [.83, .25], [1, 1] ]";}else if(typeof scope.$parent.staticPage!="undefined"){viewportWidth="[ [.75], [.66], [1] ]";bottomImgViewportWidth="[ [.75, .16], [.66, .25], [1, 1] ]";}else if(typeof scope.$parent.article!="undefined"&&location.pathname.split("/")[2].toLowerCase()=="timeline"){viewportWidth="[ [1, 0.583], [1, 0.66], [1, 1] ]";bottomImgViewportWidth="[ [.583, .16], [.66, .25], [1, 1] ]";nosidebar="true";}}
setImageGalleryViewportWidth();var flyout=scope.$parent.flyout||false;scope.flyout=flyout;if(attrs.reftype.toLowerCase()=='image_set'){scope.contentHtml="<sna-image content='inlineItem' viewport-width='{{"+viewportWidth+"}}' refid='"+attrs.refid+"'"+(allowPosition?" position='"+attrs.position+"'":"")+"></sna-image>";}else if(attrs.reftype.toLowerCase()=='video'){if(flyout){scope.contentHtml='<img src="/static/web-rev/img/default_img.jpg" style="width: 100%"/>'+'<img class="main-image article-image" data-ng-src="{{\'/web/images\' + inlineItem.mediaAsset.imageUrl | imageAdvFilter:'+viewportWidth+':0.563:'+nosidebar+'}}" style="width: 100%;position: absolute; top: 0; left:0;height: 100%" onload="showImage();" />'+"<sna-video image-gallery-on-full-page='{{"+nosidebar+"}}'  viewport-width='{{"+viewportWidth+"}}' jw-player-media-id='inlineItem.jwPlayerMediaId' autoplay='true' postLoad='false' flyout='true' content='inlineItem' refid='"+attrs.refid+"' "+(scope.$parent.prerollTag?"preroll-tag='"+scope.$parent.prerollTag+"'":"")+'></sna-video>';}else{scope.contentHtml="<sna-video image-gallery-on-full-page='{{"+nosidebar+"}}'  viewport-width='{{"+viewportWidth+"}}' jw-player-media-id='inlineItem.jwPlayerMediaId' autoplay='true' postLoad='false' flyout='"+flyout+"' content='inlineItem' refid='"+attrs.refid+"' "+(scope.$parent.prerollTag?"preroll-tag='"+scope.$parent.prerollTag+"'":"")+"></sna-video>";}}else if(attrs.reftype.toLowerCase()=='image_gallery'){scope.contentHtml="<sna-image-gallery image-gallery-on-full-page='{{"+nosidebar+"}}' bottom-img-viewport-width='{{"+bottomImgViewportWidth+"}}' viewport-width='{{"+viewportWidth+"}}' image-gallery='true' content='inlineItem' refid='"+attrs.refid+"' article-modal='"+articleModal+"' trigger-full-screen-slide-show-on-click='true'></sna-image-gallery>";}else if(attrs.reftype.toLowerCase()=='custom_html'){scope.contentHtml="<sna-custom-html content='inlineItem' refid='"+attrs.refid+"'></sna-custom-html>";}else if(attrs.reftype.toLowerCase()=='poll'){scope.contentHtml="<sna-poll content='inlineItem' refid='"+attrs.refid+"' position='"+attrs.position+"'></sna-poll>";}else if(attrs.reftype.toLowerCase()=='poll_apester'){scope.contentHtml="<sna-poll-apster content='inlineItem' refid='"+attrs.refid+"'></sna-poll-apster>";}else if(attrs.reftype.toLowerCase()=='quote'){scope.contentHtml="<sna-quote content='inlineItem' refid='"+attrs.refid+"' position='"+attrs.position+"'></sna-quote>";}else if(attrs.reftype.toLowerCase()=='youtube_video'&&!!getVideoIdFromYoutubeUrl(inlineItem.url)){scope.contentHtml="<sna-youtube-video content='inlineItem' flyout='false' one-time-bind-yt-video-id='"+getVideoIdFromYoutubeUrl(inlineItem.url)+"'></sna-youtube-video>";}}
return{restrict:'E',scope:{refid:"=refid"},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaBase.html"}}]);function getVideoIdFromYoutubeUrl(url){var regExp=/https?:\/\/www.youtube.com\/watch\?v=((?=\S)[^\&#]+)&*(\S)*/i;var result=!!regExp.exec(url)&&regExp.exec(url)[1];return result;};snaApp.directive("snaImage",['$rootScope','$interval','$timeout','$http','appConfig','$log',function($rootScope,$interval,$timeout,$http,appConfig,$log){function link(scope,element,attrs){scope.$watch("content",function(content){if(!content){return}
if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}})}
return{restrict:'E',scope:{content:'=content',viewportWidth:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaImage.html"}}]);snaApp.directive("snaImageGallery",['$rootScope','$interval','$timeout','$http','appConfig','$log','$filter','$compile',function($rootScope,$interval,$timeout,$http,appConfig,$log,$filter,$compile){function link(scope,element,attrs){var imageCount=6,subElementId,showBullets=false,elementId,afterChangeHandler,currentSlideElement,currentSlideHref,currentSlideImageId,snaImageGalleryContElem;snaImageGalleryContElem=element;scope.deviceType=$rootScope.deviceType;scope.webContext=appConfig.webContext;if(scope.$parent.imageCount){imageCount=scope.$parent.imageCount;}else if($rootScope.deviceType=='TABLET'){imageCount=4;}else if($rootScope.deviceType=='MOBILE'){imageCount=1;}
if($rootScope.deviceType=='MOBILE'){showBullets=true;}
afterChangeHandler=function(slick,currentSlide){if(typeof scope.content.type==='undefined'||scope.content.type===''){return;}
currentSlideElement=snaImageGalleryContElem.find(elementId).find("[data-slick-index='"+currentSlide.slickCurrentSlide()+"']");currentSlideHref=snaImageGalleryContElem.find(currentSlideElement).find('[data-ng-href]').attr('data-ng-href');currentSlideImageId=currentSlideHref.split("/").pop();if(!scope.content.mainMediaImageGallery){sendGAPageView(appConfig.webContext,'Image',scope.content.id,currentSlideImageId,scope.content.headline);sendFBPixelPageView();}}
scope.$watch('content',function(value){if(!scope.content){return}
blockUI($(element),true);elementId='#imageGalleryCarouselDiv'+(scope.content.id?scope.content.id:'');subElementId='#imageGalleryCarouselSyncDiv'+(scope.content.id?scope.content.id:'');$timeout(function(){snaImageGalleryContElem.find(subElementId).show();if(!snaImageGalleryContElem.find(subElementId+'.slick-initialized').length){snaImageGalleryContElem.find(subElementId).slick({rtl:true,slidesToShow:1,slidesToScroll:1,asNavFor:elementId,arrows:false,fade:true})}
if(!snaImageGalleryContElem.find(elementId+'.slick-initialized').length){snaImageGalleryContElem.find(elementId).slick({rtl:true,dots:showBullets,autoplay:false,mobileFirst:true,slidesToShow:imageCount,slidesToScroll:1,infinite:true,asNavFor:subElementId,focusOnSelect:true,centerMode:false});}
if(scope.index){snaImageGalleryContElem.find(elementId).slick('slickGoTo',parseInt(scope.index),true);snaImageGalleryContElem.find(subElementId).slick('slickGoTo',parseInt(scope.index),true);}
processDataForFullScreenViewer(scope.content,scope.content.id);$timeout(function(){snaImageGalleryContElem.children("#imageGalleryContainerDiv").css("visibility","visible");snaImageGalleryContElem.addClass("sna-initialized");$(window).trigger('resize');unblockUI($(element));},2000,false);},100,false);if(scope.index){scope.featuredImage=scope.content.images[scope.index];scope.currentImage=scope.index+1;}else{scope.featuredImage=scope.content.images[0];scope.currentImage=1;}
scope.imageCount=scope.content.images.length;});$rootScope.$watch('deviceType',function(newValue,oldValue){var deviceType=getDeviceType();scope.deviceType=deviceType;if(scope.$parent.imageCount){imageCount=scope.$parent.imageCount;}else if(deviceType=='DESKTOP'){imageCount=6;}else if(deviceType=='TABLET'){imageCount=4;}else if(deviceType=='MOBILE'){imageCount=1;}
if($rootScope.deviceType=='MOBILE'){showBullets=true;}
$timeout(function(){snaImageGalleryContElem.find(elementId+'.slick-initialized').length&&snaImageGalleryContElem.find(elementId).slick('unslick');if(!snaImageGalleryContElem.find(subElementId+'.slick-initialized').length){snaImageGalleryContElem.find(subElementId).slick({rtl:true,slidesToShow:1,slidesToScroll:1,asNavFor:elementId,arrows:false,fade:true});}
snaImageGalleryContElem.find(elementId).slick({rtl:true,dots:showBullets,autoplay:false,mobileFirst:true,slidesToShow:imageCount,slidesToScroll:1,infinite:true,asNavFor:subElementId,focusOnSelect:true,centerMode:false});if(deviceType=='MOBILE'){snaImageGalleryContElem.find(elementId).off('afterChange');snaImageGalleryContElem.find(subElementId).off('afterChange');snaImageGalleryContElem.find(elementId).on('afterChange',afterChangeHandler);}else{snaImageGalleryContElem.find(elementId).off('afterChange');snaImageGalleryContElem.find(subElementId).off('afterChange');snaImageGalleryContElem.find(subElementId).on('afterChange',afterChangeHandler);}},500);});scope.viewImage=function(image,index){scope.featuredImage=image;scope.currentImage=index+1;}
scope.goToLink=function(event,element,noFullScreenModal){var index;var onCloseFullScreenImageViewer;var onChangeScreenImageViewer;var callBacksForFullScreenImageViewer={};if((!!scope.triggerFullScreenSlideShowOnClick&&!noFullScreenModal)||(!!scope.triggerFullScreenSlideShowOnClick&&!!noFullScreenModal&&$rootScope.deviceType=='MOBILE')){index=$(event.currentTarget).data("image-index")||0;onCloseFullScreenImageViewer=function(callbackName,index,id){$rootScope[callbackName]=null;$("#imageGalleryCarouselDiv"+id+".slick-initialized").slick("slickGoTo",index,true);$("#imageGalleryCarouselSyncDiv"+id+".slick-initialized").slick("slickGoTo",index,true);}
onChangeScreenImageViewer=function(callbackName,galleryId,imageId,title){sendGAPageView(appConfig.webContext,'Image',galleryId,imageId,title);}
callBacksForFullScreenImageViewer={"onClose":onCloseFullScreenImageViewer,"onChange":onChangeScreenImageViewer};createFullScreenViewer({index:index},callBacksForFullScreenImageViewer);event&&event.preventDefault();return false;}
if(attrs.articleModal=='true'){$(event.currentTarget).attr('target','_blank');}
if($rootScope.deviceType!='MOBILE'&&element=='CAROUSEL'){event&&event.preventDefault();}
if(!scope.link&&(!scope.content||!scope.content.id||scope.content.mainMediaImageGallery)){event&&event.preventDefault();return;}else if(!scope.link){return;}
event&&event.preventDefault();if($rootScope.deviceType=='MOBILE'&&element=='CAROUSEL'){window.location.href=scope.link;}else if($rootScope.deviceType!='MOBILE'&&element=='FEATURED'){window.location.href=scope.link;}}
function processDataForFullScreenViewer(data,galleryId){var imageData=data.images;scope.fullScreenImageViewerData=[];scope.fullScreenImageViewerData=imageData.slice();galleryId=galleryId||1;var sharingBaseUrl='http://'+appConfig.sharingHost+'/image_gallery';for(var i=0;i<scope.fullScreenImageViewerData.length;i++){scope.fullScreenImageViewerData[i].w=imageWidthfoFullScreenViewer();scope.fullScreenImageViewerData[i].h=Math.round(imageWidthfoFullScreenViewer()*.5625);scope.fullScreenImageViewerData[i].title=scope.fullScreenImageViewerData[i].caption;scope.fullScreenImageViewerData[i].src=$rootScope.webHost+$rootScope.webContext+'/images'+$filter('imagefilter')(scope.fullScreenImageViewerData[i].imageUrl,scope.fullScreenImageViewerData[i].w,.5625);scope.fullScreenImageViewerData[i].pid=scope.fullScreenImageViewerData[i].id;scope.fullScreenImageViewerData[i].shortUrl=!!scope.fullScreenImageViewerData[i]&&!!scope.fullScreenImageViewerData[i].shareUrl&&encodeURI(scope.fullScreenImageViewerData[i].shareUrl);;scope.fullScreenImageViewerData[i].shareUrl=sharingBaseUrl+"/"+data.id+'/'+scope.fullScreenImageViewerData[i].id;scope.fullScreenImageViewerData[i].shareHeadline=data.headline;scope.fullScreenImageViewerData[i].shareSummary=scope.fullScreenImageViewerData[i].caption;}
scope.fullScreenImageViewerOptions=optionsForFullScreenViewer({"galleryUID":galleryId,"shareEl":(scope.content.mainMediaImageGallery?false:true)});}
function optionsForFullScreenViewer(options){var defaultOpt=scope.fullScreenImageViewerOptions||{index:0};options=options||{};options=$.extend({},defaultOpt,options);return options;}
function imageWidthfoFullScreenViewer(arguments){var width
switch(deviceType){case'DESKTOP':width=2000;break;case'TABLET':width=1600;break;case'MOBILE':width=1600;break;}
return width;}
function createFullScreenViewer(options,callBacks){scope.fullScreenImageViewerOptions=optionsForFullScreenViewer(options);var onCloseCallBack;var onChangeCallBack;$("sna-full-screen-image-viewer").each(function(index,el){$(this).remove();});onCloseCallBack=bindOnCloseEvent(scope.fullScreenImageViewerOptions,callBacks);onChangeCallBack=bindOnChangeEvent(scope.fullScreenImageViewerOptions,callBacks,scope.fullScreenImageViewerData[0]);var fullScreenImageViewerElem=angular.element('<sna-full-screen-image-viewer image-data=\''+JSON.stringify(scope.fullScreenImageViewerData)+'\' options=\''+JSON.stringify(scope.fullScreenImageViewerOptions)+'\'  on-close-callback=\''+onCloseCallBack+'\'  on-change-callback=\''+onChangeCallBack+'\'></sna-full-screen-image-viewer>');jQuery("body").append(fullScreenImageViewerElem);$compile(fullScreenImageViewerElem)($rootScope);}
function bindOnCloseEvent(options,callBacks){var onCloseCallBack;if((typeof options!='undefined')&&(typeof options.galleryUID!='undefined')&&(typeof callBacks.onClose!='undefined')){onCloseCallBack="onCloseFullScreenImageViewer"+options.galleryUID;$rootScope[onCloseCallBack]=null;$rootScope[onCloseCallBack]=callBacks.onClose;return onCloseCallBack;}else{return null;}}
function bindOnChangeEvent(options,callBacks,firstImageData){var onChangeCallBack;if((typeof options!='undefined')&&(typeof options.galleryUID!='undefined')&&(typeof callBacks.onChange!='undefined')){onChangeCallBack="onChangeFullScreenImageViewer"+options.galleryUID;$rootScope[onChangeCallBack]=null;$rootScope[onChangeCallBack]=callBacks.onChange;callBacks.onChange(onChangeCallBack,options.galleryUID,firstImageData.id,firstImageData.shareHeadline)
return onChangeCallBack;}else{return null;}}}
return{restrict:'E',transclude:true,scope:{content:'=content',isImageGallery:'=imageGallery',index:'=index',link:'=href',headline:'=headline',category:"=category",date:"=date",mode:"=mode",articleModal:'=',mainMediaImageGallery:'=',triggerFullScreenSlideShowOnClick:'@',viewportWidth:'@',bottomImgViewportWidth:'@',imageGalleryOnFullPage:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaImageGallery.html"}}]);'use strict';snaApp.directive("snaVideo",['$rootScope','$interval','$timeout','$http','appConfig','$log','$window','videoPlayer','$filter','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$window,videoPlayer,$filter,$sce){var controller=new ScrollMagic.Controller(),scrollUpScene,scrollDownScene,latestFlyingVideo,scrollUpSceneAutoplay,scrollDownSceneAutoplay,isIE=getIEVersion()>0,index=0,jwIconVolumeOverlay='#jw-icon-volume-overlay';function link(scope,element,attrs){var flyingout=false,player,scrollTop;scope.playerLoaded=false;scope.videoLoaded=false;scope.id=index++;var isNotSNAVideo=false;var nonSNAVideoPlainAbsUrl=false;if(scope.$eval(attrs.showcaption)){scope.showCaption=true;}
if(scope.$eval(attrs.isyoutube)){scope.isYoutube=true;}
if(scope.$eval(attrs.autoplay)&&(getIEVersion()==0||getIEVersion()>8)){$(element).addClass('autoplay');scope._autoplay=true;}
scope.$watch('content',function(newValue){if(!newValue||newValue.noWatch){return;}
if(isIE&&scope.content.videoUrl&&scope.content.videoUrl[0].url.indexOf('https://www.youtube.com/watch?v')==0){scope.flyout=false;}
try{jwplayer('videoPlayerContainer'+scope.id).remove();}catch(error){$log.debug("Error removing jwplayer",error);}
scope.playerLoaded=false;scope.videoLoaded=false;$(element).find('#videoImg').on('load',function(){$(element).find('#defaultImg').css('visibility','hidden');});setVideoThumbnail();if(!scope.postLoad||$rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!='undefined'&&$rootScope.device!='DESKTOP')){scope.postLoad=false;$timeout(scope.playVideo,1000);}else{scope.videoLoaded=true;}});scope.playVideo=function(event){event&&event.preventDefault();event&&event.stopPropagation();$rootScope.trackGAEvent('SNA_VIDEO',scope.content.headline);$(element).find(jwIconVolumeOverlay).hide();if(event&&!scope.videoLoaded){return;}
if(event){if(scope.videoLoaded){scope.playerLoaded=true;}}
if(scope.playerLoaded&&scope.videoLoaded&&!scope.postLoad){if(scope._autoplay){player.playOriginIsUser=true;player.autoplay=false;}
player.play(true);player.setMute(false);return;}
var urls=scope.content.videoUrl;var ua=navigator.userAgent.toLowerCase();var isAndroid=ua.indexOf("android")>-1&&ua.indexOf("iemobile")==-1;var isIe9=ua.indexOf("msie 9.0")>-1;var useJwPlayer=true;if(isAndroid){var match=ua.match(/android\s([0-9\.]*)/i);if(match){if(parseFloat(match[1])<4.1){useJwPlayer=false;}}else{useJwPlayer=true;}}
if(window.jwplayerVersion==8){window.jwplayer.key=appConfig.jwplayerKey8;scope.jwplayer8=true;}else{window.jwplayer.key=appConfig.jwplayerKey7;scope.jwplayer7=true;}
if(useJwPlayer){scope.tracksThumbnails=[];scope.playlistOffMuteControl=false;if(typeof scope.content.thumbnailUrl!=='undefined'){scope.tracksThumbnails=[{file:scope.content.thumbnailUrl,kind:"thumbnails"}];}else if(typeof scope.content.mediaAsset!=='undefined'&&typeof scope.content.mediaAsset.thumbnailUrl!=='undefined'){scope.tracksThumbnails=[{file:scope.content.mediaAsset.thumbnailUrl,kind:"thumbnails"}];}
var viewPortWidthObj;viewPortWidthObj={viewportWidth:null,noSidebar:false,maxWidthOfRoot:null,maxWidthLevel1:null}
viewPortWidthObj.viewportWidth=scope.viewportWidth;viewPortWidthObj.noSidebar=scope.noSidebar;viewPortWidthObj.maxWidthOfRoot=scope.maxWidthOfRoot;viewPortWidthObj.maxWidthLevel1=scope.maxWidthLevel1;player=videoPlayer.jwplayer('videoPlayerContainer'+scope.id,urls,isAndroid,attrs.autoPlay=="true"||scope.postLoad,isNotSNAVideo?nonSNAVideoPlainAbsUrl:scope.imageSrc,attrs.prerollTag,scope.isYoutube,scope.tracksThumbnails,scope.content.relatedVideos,scope.jwPlayerMediaId,scope.content.headline,scope.muted,scope.content.id,scope.content,scope.isVrSupportedPlayer,viewPortWidthObj);player.on('ready',function(){!!scope.playerReady&&scope.playerReady();scope.$applyAsync(function(){scope.videoLoaded=true;});if(scope._autoplay){player.playOriginIsUser=false;player.autoplay=true;createScenesAutoplay(element);}
var ctrlBarMOtarget,ctrlbarMutationobserver;if(scope.showNavArrowOnControlIsOn&&window.isMutationObserverSupported){ctrlBarMOtarget=element[0].querySelector("[id^='videoPlayerContainer']");ctrlbarMutationobserver=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.attributeName=='class'&&mutation.type=='attributes'&&(jQuery(mutation.target).is('.jw-flag-ads-vpaid:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jw-flag-user-inactive.jw-state-playing:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jw-flag-user-inactive.jw-state-buffering:not(.jw-flag-media-audio):not(.jw-flag-audio-player):not(.jw-flag-ads-vpaid-controls):not(.jw-flag-casting) ')||jQuery(mutation.target).is('.jwplayer.jw-flag-overlay-open-related'))){scope.showNavArrowOnControlIsOn({isVisible:false});}else{scope.showNavArrowOnControlIsOn({isVisible:true});}});});var config={attributes:true,childList:false,characterData:false}
ctrlbarMutationobserver.observe(ctrlBarMOtarget,config);}});player.on('mute',function(state){if(typeof state=='undefined'||typeof state.mute=='undefined'||player.getState().toLowerCase()=='paused'){return;}
if(scope._autoplay){if(state.mute&&!player.playOriginIsUser){$(element).find(jwIconVolumeOverlay).show();}else{$(element).find(jwIconVolumeOverlay).hide();}}});player.on('complete',function(){scope.videoComplete();$(element).find(jwIconVolumeOverlay).hide();if(!flyingout){destroyScenes();latestFlyingVideo=null;}});player.on('playlist',function(playList){if(typeof playList.playlist[0].image!='undefined'){scope.$applyAsync(function(){scope.imageSrc=playList.playlist[0].image;});}
$('.jw-nextup-close').on('click',function(){$(this).closest('.jw-nextup-container').addClass('jw-nextup-container-hidden');});});player.on('pause',function(state){if(scope._autoplay){if(typeof state!=='undefined'&&typeof state.pauseReason!=='undefined'&&state.pauseReason=='interaction'&&typeof state.newstate!=='undefined'&&state.newstate=='paused'){player.autoplay=false;$(element).find(jwIconVolumeOverlay).hide();}
if(typeof state!=='undefined'&&typeof state.pauseReason!=='undefined'&&state.pauseReason!='interaction'&&typeof state.newstate!=='undefined'&&state.newstate=='paused'){$(element).find(jwIconVolumeOverlay).hide();}}
scope.videoPause(state);if(!flyingout&&scope.flyout){if(player.autoplay&&!player.playOriginIsUser){return;}
destroyScenes();latestFlyingVideo=null;}});player.on('fullscreen',function(event){if(event.fullscreen){$("body").addClass('fullscreen-video');if($rootScope.device=='DESKTOP'){scrollTop=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;}}else{setTimeout(function(){$("body").removeClass('fullscreen-video');},1000);if(isChrome()){setTimeout(function(){if($rootScope.device=='DESKTOP'&&$rootScope.flyoutVideoPresent){document.body.scrollTop=scrollTop;}},1);}}});player.on('play',function(event){if(scope._autoplay){if(typeof event!=='undefined'&&typeof event.playReason!=='undefined'&&typeof player.playOriginIsUser!=='undefined'){if(player.playOriginIsUser||(event.playReason=='interaction')){$(element).find(jwIconVolumeOverlay).hide();player.setMute(false);player.autoplay=false;}else{$(element).find(jwIconVolumeOverlay).show();player.setMute(true);}}}else{if(player.getConfig().playReason=='autostart'&&!scope.playlistOffMuteControl){player.setMute(false);if(typeof player.getConfig()!=='undefined'&&'playlist'in player.getConfig()){scope.playlistOffMuteControl=true;}}}
if(this.snaPaused){this.snaPaused=false;return;}
scope.$applyAsync(function(){scope.playerLoaded=true;});scope.videoPlay();player.closeFlyout=scope.closeFlyout;if($rootScope.device!='DESKTOP'){scrollTop=parseInt(element.offset().top)-element[0].getBoundingClientRect().height/2;}
if(scope.flyout){if(player.autoplay&&!player.playOriginIsUser){return;}
if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){if(player.autoplay&&!player.playOriginIsUser){return;}
scrollDownLeave(latestFlyingVideo);destroyScenes();}});player.on('playlistItem',function(data){scope.playlistItemChange({data:data});});if(isIe9){scope.videoLoaded=true;scope.playerLoaded=true;}
if(attrs.autoPlay=="true"){if($rootScope.device=='DESKTOP'){scope.playerLoaded=true;}}}else{$.each(urls,function(index,obj){if(obj.platform=="MobileH264"){scope.androidVideoUrl=obj.url;}});scope.nativeAndroid=true;}
return false;};scope.closeFlyout=function(){if(!flyingout){return;}
flyingout=false;destroyScenes();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:'',width:''});video.removeClass('flyout-prepare');element.find('#flyoutButtonsDiv').hide();player.pause(true);if(player.getState().toLowerCase()=='buffering'){player.snaPaused=true;}};function setVideoThumbnail(){scope.imageSrc="";if(scope.content.mediaAsset.imageUrl.indexOf('http://')==0||scope.content.mediaAsset.imageUrl.indexOf('https://')==0){scope.imageSrc=$sce.trustAsResourceUrl(scope.content.mediaAsset.imageUrl);if(typeof $sce.valueOf(scope.imageSrc)=="string"){isNotSNAVideo=true;nonSNAVideoPlainAbsUrl=$sce.valueOf(scope.imageSrc)}}else if(scope.content.mediaAsset.imageUrl.indexOf("/"+$rootScope.webContext+"/images")==0){if(typeof scope.viewportWidth!="undefined"){scope.imageSrc=$filter('imageAdvFilter')(scope.content.mediaAsset.imageUrl,scope.viewportWidth,0.563,scope.noSidebar,scope.maxWidthOfRoot,scope.maxWidthLevel1,true);}else{scope.imageSrc=$filter('imagefilter')(scope.content.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}}else{if(typeof scope.viewportWidth!="undefined"){scope.imageSrc="/"+$rootScope.webContext+"/images"
+$filter('imageAdvFilter')(scope.content.mediaAsset.imageUrl,scope.viewportWidth,0.563,scope.noSidebar,scope.maxWidthOfRoot,scope.maxWidthLevel1,true);}else{scope.imageSrc="/"+$rootScope.webContext+"/images"+$filter('imagefilter')(scope.content.mediaAsset.imageUrl,[1000,$rootScope.deviceWidth,$rootScope.deviceWidth],0.563);}}}
function destroyScenes(){if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}}
function createScenesAutoplay(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
var autoplayDisabled=function(){return(typeof player!=='undefined'&&!player.autoplay)||player.playOriginIsUser;};$('<div id="jw-icon-volume-overlay">').html('<div class="jw-icon-volume-overlay-content"><svg xmlns="http://www.w3.org/2000/svg" class="jw-svg-icon jw-svg-icon-volume-0" '
+'viewBox="0 0 240 240"><path d="M116.4,42.8v154.5c0,2.8-1.7,3.6-3.8,1.7l-54.1-48.1H28.9c-2.8,0-5.2-2.3-5.2-5.2V94.2c0-2.8,2.3-5'
+'.2,5.2-5.2h29.6l54.1-48.1C114.6,39.1,116.4,39.9,116.4,42.8z M212.3,96.4l-14.6-14.6l-23.6,23.6l-23.6-23.6l-14.6,14.6l23.6,23.6l-'
+'23.6,23.6l14.6,14.6l23.6-23.6l23.6,23.6l14.6-14.6L188.7,120L212.3,96.4z"></path></svg></div>').on('click',function(event){event&&event.stopPropagation();if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'){window.activeYtPlayer.pauseVideo();}
if(window.activeJWPlayer&&window.activeJWPlayer.getState().toLowerCase()=='buffering'){window.activeJWPlayer.snaPaused=true;}
if(window.activeJWPlayer&&window.activeJWPlayer.id!=player.id){window.activeJWPlayer.pause(true);}
player.playOriginIsUser=true;player.autoplay=false;player.setMute(false);if(scope.flyout){if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);destroyScenes();}
window.activeJWPlayer=player;}).prependTo($(element).find('#videoWrapper'));scrollDownSceneAutoplay=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:1,}).on('enter',function(){if(autoplayDisabled()){return;}
$timeout(function(){player.setMute(true);player.play(true);scope.$applyAsync(function(){scope.playerLoaded=true;});},100);}).on('leave',function(){if(autoplayDisabled()){return;}
player.play(false);});scrollUpSceneAutoplay=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:0,}).on('enter',function(){if(autoplayDisabled()){return;}
$timeout(function(){player.setMute(true);player.play(false);},100);}).on('leave',function(){if(autoplayDisabled()){return;}
player.play(true);scope.$applyAsync(function(){scope.playerLoaded=true;});});controller.addScene(scrollUpSceneAutoplay);controller.addScene(scrollDownSceneAutoplay);}
function createScenes(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}
scrollDownScene=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,triggerHook:0,}).on('enter',function(){if(player.getFullscreen()){return;}else if(player.getState().toLowerCase()=='idle'||player.getState().toLowerCase()=='paused'){return;}
scrollDownEnter(element);flyingout=true;}).on('leave',function(){if(player.getFullscreen()){return;}
scrollDownLeave(element);flyingout=false;});scrollUpScene=new ScrollMagic.Scene({triggerElement:element[0],offset:element[0].offsetHeight*0.50,duration:0,triggerHook:1,}).on('enter',function(){if(player.getFullscreen()||!flyingout){return;}
scrollUpEnter(element);flyingout=false;}).on('leave',function(){if(player.getFullscreen()){return;}else if(player.getState().toLowerCase()=='idle'||player.getState().toLowerCase()=='paused'){return;}
scrollUpLeave(element);flyingout=true;});controller.addScene(scrollUpScene);controller.addScene(scrollDownScene);}
function scrollDownEnter(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'100px',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0,"onComplete":function(){video.css({top:''});}});}
function scrollDownLeave(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video'),offset=element[0].getBoundingClientRect();if(offset.bottom<0){offset={bottom:$(window).height(),left:offset.left,right:offset.right,top:offset.top};}
video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}
function scrollUpLeave(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0});}
function scrollUpEnter(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video');video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}}
return{restrict:'E',scope:{content:'=content',videoComplete:'&videoComplete',videoPause:'&videoPause',videoPlay:'&videoPlay',flyout:'=flyout',autoplay:'=autoplay',postLoad:'=postload',contentUrl:'=contentUrl',playerReady:"&playerReady",jwPlayerMediaId:"=",playlistItemChange:"&",muted:"=",isVrSupportedPlayer:'@',viewportWidth:'@',noSidebar:'@',maxWidthOfRoot:'@',maxWidthLevel1:'@',showNavArrowOnControlIsOn:'&'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaVideo.html"}}]);loadJWPlayer();snaApp.directive("snaCustomHtml",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){scope.customHtml=$sce.trustAsHtml(scope.content.freeText);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaCustomHtml.html"}}]);snaApp.directive("snaPoll",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){scope.component={title:" ",contents:[scope.content]};scope.hidePollImage=true;if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}else{scope.position='left';}
$(element).closest("p").addClass("inline-poll-parent").addClass(scope.position);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaPoll.html"}}]);snaApp.directive("snaQuote",['$rootScope','$interval','$timeout','$http','appConfig','$log','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$sce){function link(scope,element,attrs){if(attrs.position&&attrs.position!="undefined"){scope.position=attrs.position;}else{scope.position='left';}
$(element).closest("p").addClass("inline-quote-parent").addClass(scope.position);}
return{restrict:'E',scope:{content:'=content'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaQuote.html"}}]);'use strict'
snaApp.controller("pollsController",["$rootScope","$scope",'$element','$sce',function($rootScope,$scope,$element,$sce){$scope.polls=$scope.component.contents;if($scope.polls[0]!=='undefined'&&$scope.polls[0].type!=='undefined'){$scope.pollType=$scope.polls[0].type;}
if($scope.pollType=='POLL_APESTER'){$scope.pollEmbedCode=$sce.trustAsHtml($scope.polls[0].freeText);return;}
var pollWidgetDom=$element;if($scope.polls[0].freeText!=null&&$scope.polls[0].freeText!=''){var poll=$('<iframe name="poll_iframe" class="poll_frame" width="100%" scrolling="no" style="overflow:hidden;border-top: 0;"></iframe>');pollWidgetDom.find('#poll_wrapper').append(poll);var initScript='<script>';initScript+='setTimeout(function() {setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25);';initScript+='setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25);}, 500);window.stop && window.stop();';initScript+='if (navigator.userAgent && navigator.userAgent.match(/Windows Phone/i) || true) {'
initScript+='window.addEventListener("resize", function (event) {';initScript+='setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 25)';initScript+='});}';initScript+='var insertListener = function(event){';initScript+='if (event.animationName == "nodeInserted") {';initScript+='setTimeout(function() { setHeight(document.getElementsByClassName("PDS_Poll")[0].offsetHeight + 50); }, 100);';initScript+='}};';initScript+='document.addEventListener("animationstart", insertListener, false); ';initScript+='document.addEventListener("MSAnimationStart", insertListener, false); ';initScript+='document.addEventListener("webkitAnimationStart", insertListener, false); ';initScript+='</script>';pollWidgetDom.find('#poll_wrapper iframe')[0].contentWindow.document.write('<body id="sna-poll" style="margin: 0;">'
+'<script src="'+$rootScope.appAssetsUrl+'/js/pollTheme/pollAnimation.js"></script>'
+$scope.polls[0].freeText+initScript+"</body>");pollWidgetDom.find('#poll_wrapper iframe')[0].contentWindow.setHeight=function(pollHeight){pollWidgetDom.find('#poll_wrapper iframe')[0].height=pollHeight;if(!(pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollStyle').length>0)){pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append('<style id="pollStyle"></style>');}
if(!(pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollIFrameHeight').length>0)){pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append("<style id='pollIFrameHeight'> @keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }   "
+"@-webkit-keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }  "
+"@-ms-keyframes nodeInserted {from { opacity: 0.99; } to { opacity: 1; } }"
+".PDS_Poll  div.pds-question, .PDS_Poll  div.pds-answer, .PDS_Poll  "
+"div.pds-vote {animation-duration: 0.001s; animation-name: nodeInserted; -webkit-animation-duration: 0.001s; "
+"-webkit-animation-name: nodeInserted; -ms-animation-duration: 0.001s; -webkit-ms-name: nodeInserted;}</style>");}
resetPollStyle();}
window.addEventListener('orientationchange',function(){resetPollStyle();});if(navigator.userAgent&&navigator.userAgent.match(/Windows Phone/i)){$(window).on('resize',function(){resetPollStyle();});}
pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append('<style>body { font-family: HelveticaNeue, Helvetica, Arial, sans-serif;}</style>');var font='<style>\n@font-face {\n'
font+='font-family: "HelveticaNeue";\n';font+='src:    url("'+$rootScope.appAssetsUrl+'/styles/sna-font/HelveticaNeueW23forSKY-Reg_T02.woff2")  format("woff2"),\n';font+='        url("'+$rootScope.appAssetsUrl+'/styles/sna-font/HelveticaNeueW23forSKY-Reg_T02.woff")   format("woff");\n';font+='font-weight: 400;\n';font+='font-style: normal;\n';font+='}\n</style>'
pollWidgetDom.find('#poll_wrapper iframe').contents().find('head').append(font);}
function resetPollStyle(){var h3FontSize=$(".poll-widget .poll-headline").css("font-size");var h4FontSize=$(".poll-widget .poll-answer").css("font-size");var style='.pds-question-top { font-size:'+h3FontSize+' !important;}\n';style+='.pds-input-label { font-size:'+h4FontSize+' !important;}\n';style+='.pds-answer-text { font-size:'+h4FontSize+' !important;}\n';style+='.pds-vote-button { font-size:'+h4FontSize+' !important;}\n';style+='.pds-return-poll { font-size:'+h4FontSize+' !important;}\n';style+='.pds-return-poll {margin-top: 0 !important;}\n';style+='.pds-vote {margin-top: 10px !important;}\n'
pollWidgetDom.find('#poll_wrapper iframe').contents().find('#pollStyle').html(style);}}]);snaApp.controller("blogsListController",["$rootScope","$scope","$http","appConfig","$log","$timeout","$interval","$location",function($rootScope,$scope,$http,appConfig,$log,$timeout,$interval,$location){var offset=0,pageSize=14,evenLoad=true,loadMore=true,stories=[],correctionNeed=false,correctionCount=0,initialPageSize=14;$rootScope.menuLocationUrl=window.location.protocol+"//"+window.location.host+window.location.pathname;function removeSlashAtUrlEnd(url){while(/\/$/.test(url)){url=url.replace(/\/$/,"");}
return url;}
$rootScope.menuLocationUrl=removeSlashAtUrlEnd($rootScope.menuLocationUrl);var groups=[{},{},{}];if($rootScope.deviceType=='TABLET'){pageSize=9;initialPageSize=9;}else if($rootScope.deviceType=='MOBILE'){pageSize=9;initialPageSize=9;}
$http.get(appConfig.apiBaseURL+'/rest/v2/blog-list.json',{cache:false,params:{pageSize:pageSize,offset:offset,deviceType:$rootScope.deviceType}}).then(function(response){var data=response.data;if(data.contentItems){for(var i=0;i<data.contentItems.length;i++){stories.push(data.contentItems[i]);}}
loadInitialData(data);$timeout(function(){$('#blogListDiv').css("visibility","visible");},1000,false)},function(){$log.error("Error Fetching images");});$scope.loadMoreContent=function(){if(!loadMore){return;}
loadMore=false;var pageSizeForLoadMore;if(!!correctionNeed){pageSizeForLoadMore=pageSize*2;}else{pageSizeForLoadMore=pageSize;}
if(!!correctionNeed&&correctionCount){stories.splice((-1*correctionCount),correctionCount);}else if(!!correctionNeed&&!correctionCount){stories.splice(9);evenLoad=false;}
$http.get(appConfig.apiBaseURL+'/rest/v2/blog-list.json',{cache:false,params:{offset:offset,pageSize:pageSizeForLoadMore,deviceType:$rootScope.deviceType}}).then(function(response){var data=response.data;if(data.contentItems){for(var i=0;i<data.contentItems.length;i++){stories.push(data.contentItems[i]);}}else{loadMore=true;return;}
var items;switch($rootScope.deviceType){case'DESKTOP':items=stories.slice(stories.length-data.contentItems.length);if(!correctionNeed){if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":6,items:[items[0]]},{"width":6,"rows":[{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[3]]},{"width":6,items:[items[4]]}]}]}]});}else{groups[2].rows.push({"columns":[{"width":6,"rows":[{"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[3]]}]}]},{"showSummary":true,"width":6,items:[items[4]]}]});}}else{groups[2].rows.pop();if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":6,items:[items[0]]},{"width":6,"rows":[{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[3]]},{"width":6,items:[items[4]]}]}]}]});groups[2].rows.push({"columns":[{"width":6,"rows":[{"columns":[{"width":6,items:[items[5]]},{"width":6,items:[items[7]]}]},{"columns":[{"width":6,items:[items[6]]},{"width":6,items:[items[8]]}]}]},{"showSummary":true,"width":6,items:[items[9]]}]});}else{groups[2].rows.push({"columns":[{"width":6,"rows":[{"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[3]]}]}]},{"showSummary":true,"width":6,items:[items[4]]}]});groups[2].rows.push({"columns":[{"showSummary":true,"width":6,items:[items[5]]},{"width":6,"rows":[{"columns":[{"width":6,items:[items[6]]},{"width":6,items:[items[7]]}]},{"columns":[{"width":6,items:[items[8]]},{"width":6,items:[items[9]]}]}]}]});}
evenLoad=!evenLoad;}
break;case'TABLET':items=stories.slice(stories.length-data.contentItems.length);if(!correctionNeed){if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":8,items:[items[0]]},{"width":4,"rows":[{"columns":[{"width":12,items:[items[1]]},{"width":12,items:[items[2]]}]}]}]});}else{groups[2].rows.push({"columns":[{"width":4,"rows":[{"columns":[{"width":12,items:[items[0]]},{"width":12,items:[items[1]]}]}]},{"showSummary":true,"width":8,items:[items[2]]}]});}}else{groups[2].rows.pop();if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":8,items:[items[0]]},{"width":4,"rows":[{"columns":[{"width":12,items:[items[1]]},{"width":12,items:[items[2]]}]}]}]});groups[2].rows.push({"columns":[{"width":4,"rows":[{"columns":[{"width":12,items:[items[3]]},{"width":12,items:[items[4]]}]}]},{"showSummary":true,"width":8,items:[items[5]]}]});}else{groups[2].rows.push({"columns":[{"width":4,"rows":[{"columns":[{"width":12,items:[items[0]]},{"width":12,items:[items[1]]}]}]},{"showSummary":true,"width":8,items:[items[2]]}]});groups[2].rows.push({"columns":[{"showSummary":true,"width":8,items:[items[3]]},{"width":4,"rows":[{"columns":[{"width":12,items:[items[4]]},{"width":12,items:[items[5]]}]}]}]});}
evenLoad=!evenLoad;}
break;case'MOBILE':items=stories.slice(stories.length-data.contentItems.length);if(!correctionNeed){groups[2].rows.push({"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[1]]}]});groups[2].rows.push({"columns":[{"width":6,items:[items[2]]},{"width":6,items:[items[3]]}]});}else{groups[2].rows.pop();groups[2].rows.pop();groups[2].rows.push({"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[1]]}]});groups[2].rows.push({"columns":[{"width":6,items:[items[2]]},{"width":6,items:[items[3]]}]});groups[2].rows.push({"columns":[{"width":6,items:[items[4]]},{"width":6,items:[items[5]]}]});groups[2].rows.push({"columns":[{"width":6,items:[items[6]]},{"width":6,items:[items[7]]}]});evenLoad=!evenLoad;}
break;}
$timeout(function(){$(document).foundation('equalizer','reflow');},500,false);correctionNeed=false;correctionCount=0;evenLoad=!evenLoad;loadMore=true;offset+=pageSizeForLoadMore;if(!data.hasMore){$scope.maxOffset=true;}else if(items&&items.length<pageSize){$scope.maxOffset=true;}},function(){$log.error("Error Fetching images");});}
function loadInitialData(data,refresh){if(!data||!data.contentItems||data.contentItems.length==0){$scope.groups=[];$scope.maxOffset=true;return;}
offset=0;correctionNeed=false;correctionCount=0;evenLoad=true;loadMore=true;groups[0].rows=[];groups[1].rows=[];groups[2].rows=[];switch($rootScope.deviceType){case'DESKTOP':groups[0].rows[0]={"columns":[{"showSummary":true,"width":6,items:[data.contentItems[0]]},{"width":6,"rows":[{"columns":[{"width":6,items:[data.contentItems[1]]},{"width":6,items:[data.contentItems[2]]}]},{"columns":[{"width":6,items:[data.contentItems[3]]},{"width":6,items:[data.contentItems[4]]}]}]}]};groups[1].rows[0]={"columns":[{"width":3,items:[data.contentItems[5]]},{"width":3,items:[data.contentItems[6]]},{"width":3,items:[data.contentItems[7]]},{"width":3,items:[data.contentItems[8]]}]};groups[2].rows[0]={"columns":[{"width":6,"rows":[{"columns":[{"width":6,items:[data.contentItems[9]]},{"width":6,items:[data.contentItems[11]]}]},{"columns":[{"width":6,items:[data.contentItems[10]]},{"width":6,items:[data.contentItems[12]]}]}]},{"showSummary":true,"width":6,items:[data.contentItems[13]]}]};pageSize=5;break;case'TABLET':groups[0].rows[0]={"columns":[{"showSummary":true,"width":8,items:[data.contentItems[0]]},{"width":4,"rows":[{"columns":[{"width":12,items:[data.contentItems[1]]},{"width":12,items:[data.contentItems[2]]}]}]}]};groups[1].rows[0]={"columns":[{"width":4,items:[data.contentItems[3]]},{"width":4,items:[data.contentItems[4]]},{"width":4,items:[data.contentItems[5]]}]};groups[2].rows[0]={"columns":[{"width":4,"rows":[{"columns":[{"width":12,items:[data.contentItems[6]]},{"width":12,items:[data.contentItems[7]]}]}]},{"showSummary":true,"width":8,items:[data.contentItems[8]]}]};pageSize=3;break;case'MOBILE':groups[0].rows[0]={"columns":[{"showSummary":true,"width":12,items:[data.contentItems[0]]}]};groups[0].rows[1]={"columns":[{"width":6,items:[data.contentItems[1]]},{"width":6,items:[data.contentItems[2]]}]};groups[1].rows[0]={"columns":[{"width":6,items:[data.contentItems[3]]},{"width":6,items:[data.contentItems[4]]}]};groups[2].rows[0]={"columns":[{"width":6,items:[data.contentItems[5]]},{"width":6,items:[data.contentItems[6]]}]};groups[2].rows[1]={"columns":[{"width":6,items:[data.contentItems[7]]},{"width":6,items:[data.contentItems[8]]}]};pageSize=4;break;}
$scope.groups=groups;if(!data.hasMore&&!refresh){$scope.maxOffset=true;}else if(data.contentItems&&data.contentItems.length<pageSize){$scope.maxOffset=true;}
if(data.contentItems.length<initialPageSize){correctionNeed=true;correctionCount=0;offset=9;}else{offset+=initialPageSize;}
if(!refresh){$scope.$applyAsync(function(){$(document).foundation({equalizer:{use_tallest:true,equalize_on_stack:true,check_window_height_width:true,}});registerMenuCloseEvent();});$timeout(function(){$(document).foundation('equalizer','reflow');},500,false);if($rootScope.device=='DESKTOP'){$interval(function(){$(document).foundation('equalizer','reflow');},2000,false);}}}
$rootScope.$watch('deviceType',function(value,oldValue){if(value==oldValue){return;}
initialPageSize=14;if(value=='TABLET'){initialPageSize=9;pageSize=3;}else if(value=='MOBILE'){initialPageSize=9;pageSize=4;}else{initialPageSize=14;pageSize=5;}
loadInitialData({contentItems:stories},true);if(stories.length<=pageSize){return}
if(!!correctionNeed){$timeout(function(){$(document).foundation('equalizer','reflow');},500,false);return;}
for(var i=initialPageSize;i<stories.length;i+=pageSize){var items=stories.slice(i,i+pageSize);switch($rootScope.deviceType){case'DESKTOP':if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":6,items:[items[0]]},{"width":6,"rows":[{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[3]]},{"width":6,items:[items[4]]}]}]}]});}else{groups[2].rows.push({"columns":[{"width":6,"rows":[{"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[2]]}]},{"columns":[{"width":6,items:[items[1]]},{"width":6,items:[items[3]]}]}]},{"showSummary":true,"width":6,items:[items[4]]}]});}
break;case'TABLET':if(evenLoad){groups[2].rows.push({"columns":[{"showSummary":true,"width":8,items:[items[0]]},{"width":4,"rows":[{"columns":[{"width":12,items:[items[1]]},{"width":12,items:[items[2]]}]}]}]});}else{groups[2].rows.push({"columns":[{"width":4,"rows":[{"columns":[{"width":12,items:[items[0]]},{"width":12,items:[items[1]]}]}]},{"showSummary":true,"width":8,items:[items[2]]}]});}
break;case'MOBILE':groups[2].rows.push({"columns":[{"width":6,items:[items[0]]},{"width":6,items:[items[1]]}]});groups[2].rows.push({"columns":[{"width":6,items:[items[2]]},{"width":6,items:[items[3]]}]});break;}
if(items.length<pageSize){correctionNeed=true;correctionCount=items.length;break;}else{offset+=items.length;}
evenLoad=!evenLoad;}
$timeout(function(){$(document).foundation('equalizer','reflow');},1000,false);});}]);snaApp.controller("blogListFlexController",["$rootScope","$scope","$http","appConfig","$log","$timeout","$interval","$location","$window",function($rootScope,$scope,$http,appConfig,$log,$timeout,$interval,$location,$window){var offset=0,pageSize=14,evenLoad=true,loadMore=true,stories=[],correctionNeed=false,correctionCount=0,initialPageSize=14;$rootScope.menuLocationUrl=window.location.protocol+"//"+window.location.host+window.location.pathname;function removeSlashAtUrlEnd(url){while(/\/$/.test(url)){url=url.replace(/\/$/,"");}
return url;}
$rootScope.menuLocationUrl=removeSlashAtUrlEnd($rootScope.menuLocationUrl);var groups=[{},{},{}];if($rootScope.deviceType=='TABLET'){pageSize=9;}else if($rootScope.deviceType=='MOBILE'){pageSize=31;}
$http.get(appConfig.apiBaseURL+'/rest/v2/blog-list.json',{cache:false,params:{pageSize:pageSize,offset:offset,deviceType:$rootScope.deviceType}}).then(function(response){var data=response.data
if(data.contentItems){for(var i=0;i<data.contentItems.length;i++){stories.push(data.contentItems[i]);}}
groupData();$timeout(function(){$('#blogListDiv').css("visibility","visible");},1000,false)
if(!data||!data.contentItems||data.contentItems.length==0||!data.hasMore){$scope.maxOffset=true;}},function(){$log.error("Error Fetching images");});function groupData(isLoadMoreRequest,loadMoreDataLength){var noOfItemsInGroup,sliceStart,sliceEnd,indexTemp;var groupItem,innerGroupItem1,innerGroupItem2,minItemsForCompleteLayout;var groupIndexStart=0,loadMorePageSize,loadMoreData;var isCurrentGroupPerfect=isLoadMoreRequest&&!pageSizeCorrection&&(loadMoreDataLength>0);switch($rootScope.deviceType){case'DESKTOP':loadMorePageSize=5;break;case'TABLET':loadMorePageSize=3;break;case'MOBILE':loadMorePageSize=8;break;}
if($rootScope.deviceType=='MOBILE'){if(isCurrentGroupPerfect){groupIndexStart=stories.length-loadMoreDataLength;loadMoreData=stories.slice(groupIndexStart);$scope.groupData=$scope.groupData.concat(loadMoreData);}else{$scope.groupData=stories.slice();}
pageSizeCorrection=0;if(stories.length%2==0){pageSizeCorrection=1;}
pageSize=loadMorePageSize+pageSizeCorrection;}else if($rootScope.deviceType=='TABLET'){noOfItemsInGroup=3;sliceStart=0,sliceEnd;if(isCurrentGroupPerfect){groupIndexStart=(stories.length-loadMoreDataLength)/noOfItemsInGroup;sliceStart=(stories.length-loadMoreDataLength);}else{$scope.groupData=[];groupIndexStart=0;}
for(var j=groupIndexStart;sliceStart<stories.length;j++){sliceStart=(j)*noOfItemsInGroup;sliceEnd=(j+1)*noOfItemsInGroup;groupItem={};groupItem.complete=true;groupItem.data=[];groupItem.data=stories.slice(sliceStart,sliceEnd);if(j!=1){if(j>1){indexTemp=j-1;}else{indexTemp=j;}
innerGroupItem1=[];innerGroupItem2=[];if(indexTemp%2==0){minItemsForCompleteLayout=(noOfItemsInGroup-1)
innerGroupItem1=groupItem.data.slice(0,1);innerGroupItem2=groupItem.data.slice(1,noOfItemsInGroup);if(innerGroupItem2.length<minItemsForCompleteLayout){groupItem.complete=false;}}else{innerGroupItem1=groupItem.data.slice(0,noOfItemsInGroup-1);innerGroupItem2=groupItem.data.slice(noOfItemsInGroup-1,noOfItemsInGroup);if((innerGroupItem2.length+innerGroupItem1.length)<noOfItemsInGroup){groupItem.complete=false;}}
groupItem.data=[];groupItem.data.push(innerGroupItem1);groupItem.data.push(innerGroupItem2);}
$scope.groupData.push(groupItem);if(sliceEnd>=stories.length){pageSizeCorrection=sliceEnd-stories.length;break;}}
pageSize=loadMorePageSize+pageSizeCorrection;}else if($rootScope.deviceType=='DESKTOP'){noOfItemsInGroup=5;sliceStart=0,sliceEnd;if(isCurrentGroupPerfect){groupIndexStart=Math.ceil((stories.length-loadMoreDataLength)/noOfItemsInGroup);sliceStart=(stories.length-loadMoreDataLength);}else{$scope.groupData=[];groupIndexStart=0;}
for(var j=groupIndexStart;sliceStart<stories.length;j++){if(j==1){sliceStart=(j)*noOfItemsInGroup;sliceEnd=(j+1)*noOfItemsInGroup-1;}else if(j>1){sliceStart=(j)*noOfItemsInGroup-1;sliceEnd=(j+1)*noOfItemsInGroup-1;}else{sliceStart=(j)*noOfItemsInGroup;sliceEnd=(j+1)*noOfItemsInGroup;}
groupItem={};groupItem.complete=true;groupItem.data=[];groupItem.data=stories.slice(sliceStart,sliceEnd);if(j!=1){innerGroupItem1=[];innerGroupItem2=[];if(j==0){indexTemp=j;}else{indexTemp=j-1;}
if(indexTemp%2==0){innerGroupItem1=groupItem.data.slice(0,1);innerGroupItem2=groupItem.data.slice(1,noOfItemsInGroup);if(innerGroupItem2.length<4){groupItem.complete=false;}
if(innerGroupItem2.length==3){groupItem.partialComplete=true;}}else{innerGroupItem1=groupItem.data.slice(0,noOfItemsInGroup-1);innerGroupItem2=groupItem.data.slice(noOfItemsInGroup-1,noOfItemsInGroup);if((innerGroupItem2.length+innerGroupItem1.length)<noOfItemsInGroup){groupItem.complete=false;}}
groupItem.data=[];groupItem.data.push(innerGroupItem1);groupItem.data.push(innerGroupItem2);}
$scope.groupData.push(groupItem);if(sliceEnd>=stories.length){pageSizeCorrection=sliceEnd-stories.length;break;}}
pageSize=loadMorePageSize+pageSizeCorrection;}}
$scope.loadMoreContent=function(){if(!loadMore){return;}
loadMore=false;$http.get(appConfig.apiBaseURL+'/rest/v2/blog-list.json',{cache:false,params:{offset:stories.length,pageSize:pageSize,deviceType:$rootScope.deviceType}}).then(function(response){var currentDataLength=0,data=response.data;if(data.contentItems){currentDataLength=data.contentItems.length;for(var i=0;i<data.contentItems.length;i++){stories.push(data.contentItems[i]);}}else{loadMore=true;return;}
var items;groupData(true,currentDataLength);loadMore=true;if(!data.hasMore){$scope.maxOffset=true;}else if(items&&items.length<pageSize){$scope.maxOffset=true;}},function(){$log.error("Error Fetching images");});}
$rootScope.$watch('deviceType',function(value,oldValue){if(value==oldValue){return;}
groupData();});$scope.clickOnSNADefaultAdBanner=function($event){if(!$($event.currentTarget).hasClass('inside-content-dfp-default-bg')){return;}
$window.location.href="https://www.skynewsarabia.com/web/staticpage/18991";}}]);if('scrollRestoration'in window.history){window.history.scrollRestoration='manual';}
snaApp.config(function($locationProvider){var ua=navigator.userAgent.toLowerCase();if(ua.indexOf("msie 9.0")==-1){$locationProvider.html5Mode({enabled:true,requireBase:false,rewriteLinks:false});}});snaApp.controller("blogController",["$scope","$http","appConfig","$window","$log","$location","$rootScope","$timeout","$sce","$filter",function($scope,$http,appConfig,$window,$log,$location,$rootScope,$timeout,$sce,$filter){var locationUrl=$location.protocol()+"://",contentBlock=$(window),loading=false,currentBlogId;locationUrl+=$location.host();locationUrl+=$location.port()&&$location.port()!=80&&$location.port()!=443?":"+$location.port():'';var ua=navigator.userAgent.toLowerCase();var sharingBaseUrl='http://'+appConfig.sharingHost+'/blog/';var imageBaseUrl='http://'+appConfig.sharingHost+'/'+appConfig.webContext+'/images/';if($rootScope.device=='DESKTOP'){$scope.prerollTag='https://pubads.g.doubleclick.net/gampad/ads?sz=610x343&iu=/13259764/sna_article_pre-roll&ciu_szs=610x343&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]';}
$rootScope.$on('$locationChangeSuccess',function(event,newUrl,oldUrl,newState,oldState){if(ua.indexOf("msie 9.0")==-1){if($scope.history&&(oldState&&oldState.blogId&&newState&&newState.blogId&&oldState.blogId!=newState.blogId)){blogId=newUrl.substring(0,newUrl.lastIndexOf("/"));blogId=blogId.substring(blogId.lastIndexOf("/")+1);loading=true;blockUI(contentBlock);$http.get(appConfig.apiBaseURL+'/rest/v2/blog/'+blogId+'.json?deviceType='+$rootScope.deviceType).then(function(response){unblockUI(contentBlock);loadBlogData(response.data,true,true);loading=false;},function(){unblockUI(contentBlock);loading=false;});}else{$scope.history=true;}}});$rootScope.menuLocationUrl=locationUrl+'/blog';$scope.showNextPrevious=false;$http.get(appConfig.apiBaseURL+'/rest/v2/blog/'+$scope.initData.id+'.json?deviceType='+$rootScope.deviceType).then(function(response){loadBlogData(response.data,undefined,true);},function(){$log.error("Error Fetching topic data");});$scope.nextBlog=function(){if(!$scope.blog.next||loading){return;}
$scope.history=false;loading=true;blockUI(contentBlock);$scope.showNextPrevious=false;$http.get(appConfig.apiBaseURL+'/rest/v2/blog/'+$scope.blog.next.id+'.json?deviceType='+$rootScope.deviceType).then(function(response){var data=response.data;loadBlogData(data,true);sendGAPageView(appConfig.webContext,data.type.toLowerCase(),data.id,data.urlFriendlySuffix,$rootScope.pageTitle);sendFBPixelPageView();unblockUI(contentBlock);loading=false},function(){unblockUI(contentBlock);loading=false});};$scope.loadOtherBlog=function(blogId){if(!blogId||loading){return;}
$scope.history=false;loading=true;blockUI(contentBlock);$scope.showNextPrevious=false;$http.get(appConfig.apiBaseURL+'/rest/v2/blog/'+blogId+'.json?deviceType='+$rootScope.deviceType).then(function(response){var data=response.data;loadBlogData(data,true);sendGAPageView(appConfig.webContext,data.type.toLowerCase(),data.id,data.urlFriendlySuffix,$rootScope.pageTitle);sendFBPixelPageView();unblockUI(contentBlock);loading=false},function(){unblockUI(contentBlock);loading=false});};$scope.previousBlog=function(){if(!$scope.blog.previous||loading){return;}
$scope.history=false;loading=true;blockUI(contentBlock);$scope.showNextPrevious=false;$http.get(appConfig.apiBaseURL+'/rest/v2/blog/'+$scope.blog.previous.id+'.json?deviceType='+$rootScope.deviceType).then(function(response){var data=response.data;loadBlogData(data,true);sendGAPageView(appConfig.webContext,data.type.toLowerCase(),data.id,data.urlFriendlySuffix,$rootScope.pageTitle);sendFBPixelPageView();unblockUI(contentBlock);loading=false},function(){unblockUI(contentBlock);loading=false});};if($rootScope.deviceType=='DESKTOP'){$timeout(function(){var articleMedia=$('.article-media'),articleHead=$('.article-head'),articleStickyHead=$('.article-head-sticky'),headerDiv=$('#headerDiv');$(window).scroll(function(){showStickyHeadline(articleMedia,articleHead,articleStickyHead,headerDiv);});showStickyHeadline(articleMedia,articleHead,articleStickyHead,headerDiv);},1000,true);}
var arrowsFixedPosition=0,scrollCount=0;function updateArrowPosition(keepArrows){if($rootScope.device!='MOBILE'){if(!keepArrows){$('.arrow').hide();$('.arrow').css("visibility","hidden");}
$timeout(function(){var articleTags=$('.article-tags'),arrow;$('.arrow').show();$('.arrow').css('visibility','visible');$scope.fixedArrows=true;$('.arrow.out').each(function(){if((!arrow||arrow.offset().top<=0)&&$(this).is(':visible')&&$(this).offset().top>0){arrow=$(this);}});},1000);}}
function loadBlogData(data,keepArrows,replaceHistory){if($scope.blog){$window.scroll(0,0);if($scope.blog.mediaAsset.imageUrl!=data.mediaAsset.imageUrl){$('.main-image').css("visibility","hidden");}else{$('.main-image').css("visibility","visible");}}
$location.path("/blog/"+data.id+"-"+data.urlFriendlySuffix);if(isHistoryEnabled()){$location.state({"blogId":data.id});}
currentBlogId=data.id;if(replaceHistory){$location.replace()}
$scope.blog=data;$rootScope.Sheadline=data.headline;$rootScope.Surl=encodeURI(sharingBaseUrl+data.id+"-"+data.urlFriendlySuffix);$rootScope.shareEmailUrl=encodeURI(sharingBaseUrl+data.id+"/");$rootScope.shortUrl=!!data.shareUrl&&encodeURI(data.shareUrl);$rootScope.Simage=imageBaseUrl+$filter('imagefilter')(data.mediaAsset.imageUrl,1200,0.525);$rootScope.Ssummary=data.summary;$rootScope.Stype=data.type.toLowerCase();$rootScope.pageDescription=data.summary;$rootScope.shareMainMediaUrl=data.mediaAsset.imageUrl;$rootScope.pageTitle=data.headline;document.title=$rootScope.pageTitle;var currentDate=new Date();var lastBlogEditedDate=new Date($scope.blog.lastEditDate);if((currentDate.getTime()-lastBlogEditedDate.getTime())>82800000){$scope.showBlogEditedDateLabel=false;}else{$scope.showBlogEditedDateLabel=true;}
$scope.$applyAsync(function(){$(document).foundation();registerMenuCloseEvent();if($rootScope.device!='MOBILE'){$timeout(function(){$('.arrow').each(function(){$(this).css({"position":"fixed","top":'50%'})});if(!keepArrows){$('.next-button').css('left',$('.article-content').offset().left+$('.article-content').outerWidth());}
$scope.showNextPrevious=true;$scope.fixedArrows=true;},1500);}});if($scope.blog.mediaAsset.type=='IMAGE_GALLERY'){$scope.imageGalleryContent={images:$scope.blog.mediaAssets};}else if($scope.blog.mediaAsset.type=='VIDEO'){$scope.videoContent={id:new Date().getTime(),mediaAsset:$scope.blog.mediaAsset,videoUrl:$scope.blog.mediaAsset.videoUrl,headline:$scope.blog.mediaAsset.headline};}
$scope.inlineItems=data.inlineItems;}
function showStickyHeadline(articleMedia,articleHead,stickyHead,headerDiv){var pos=articleMedia.offset();if($(this).scrollTop()>pos.top+articleMedia.height()-100&&!$scope.nagging){$scope.nagging=true;stickyHead.css({"width":articleHead.outerWidth()});stickyHead.fadeIn();}else if($(this).scrollTop()<=pos.top&&$scope.nagging){$scope.nagging=false;stickyHead.fadeOut();}}
function stickyArrows(articleTags,arrow){if(!arrow){return;}
var scrollTop=$(window).scrollTop(),pos=articleTags.offset(),arrowPos=arrow.offset().top,fixedArrows=$(".fixed-arrow");if(arrowPos>pos.top-arrow.height()&&$scope.fixedArrows){arrowsFixedPosition=scrollTop;$scope.fixedArrows=false;$('.arrow').each(function(){$(this).css('visibility','hidden');fixedArrows.css('visibility','visible');});}else if(arrowPos<pos.top-arrow.height()&&!$scope.fixedArrows){$('.arrow').show();$('.arrow').css('visibility','visible');$scope.fixedArrows=true;fixedArrows.css('visibility','hidden');$('.arrow').each(function(){$(this).stop();$(this).css({"position":"fixed","top":'50%'})});}}
window.addEventListener('orientationchange',function(event){if($rootScope.device!='MOBILE'){$('.arrow').each(function(){$(this).css({"position":"fixed","top":'50%'})});$('.next-button').css('left',$('.article-content').offset().left+$('.article-content').outerWidth());}});$(window).on('resize',function(){if($rootScope.device!='MOBILE'){$('.arrow').each(function(){$(this).css({"position":"fixed","top":'50%'})});$('.next-button').css('left',$('.article-content').offset().left+$('.article-content').outerWidth());}});function isHistoryEnabled(){if(Modernizr.history){return true;}
return false;}}]);function showImage(){$('.main-image').css("visibility","visible");};'use strict'
snaApp.directive("snaYoutubeVideo",['$rootScope','$interval','$timeout','$http','appConfig','$log','$window','videoPlayer','$filter','$sce',function($rootScope,$interval,$timeout,$http,appConfig,$log,$window,videoPlayer,$filter,$sce){var controller=new ScrollMagic.Controller(),scrollUpScene,scrollDownScene,latestFlyingVideo,fullScreen=false,isIE=getIEVersion()>0,index=0;function link(scope,element,attrs){var playerContElem=element.find('.yt-player-div')[0];var flyingout=false;var ytPlayer;scope.isIE11=getIEVersion()==11?true:false;var autoPlay=scope.autoPlay||false;function onPlayerReady(){if(scope.changeUrl){if(!$("#"+scope.modalContId).is(":visible")){return;}
ytPlayer.cueVideoById(scope.ytVideoId,0,"default");if(autoPlay&&$rootScope.device=='DESKTOP'){ytPlayer.playVideo();}}else{scope.$applyAsync(function(){ytPlayer.playerCustomReady=true;scope.playerCustomReady=ytPlayer.playerCustomReady;});}
scope.$applyAsync(function(){scope.videoLoaded=true;scope.playerLoaded=true;});}
function onStateChange(event){if(event.data==YT.PlayerState.PLAYING){ytPlayer.status='PLAYING';scope.$applyAsync(function(){ytPlayer.playerCustomReady=true;scope.playerCustomReady=ytPlayer.playerCustomReady;});if(scope.flyout){if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);createScenes(element);}else if(!latestFlyingVideo){createScenes(element);}else if(!scrollDownScene){createScenes(element);}
latestFlyingVideo=element;}else if(latestFlyingVideo&&latestFlyingVideo!=element){scrollDownLeave(latestFlyingVideo);destroyScenes();}
if(window.activeJWPlayer){window.activeJWPlayer.pause(true);window.activeJWPlayer.closeFlyout();}
typeof(playRadio)!='undefined'&&playRadio(true);if(window.activeYtPlayer&&typeof window.activeYtPlayer.pauseVideo!='undefined'&&(window.activeYtPlayer!=ytPlayer)){window.activeYtPlayer.pauseVideo();}
window.activeYtPlayer=ytPlayer;ytPlayer.closeFlyout=scope.closeFlyout;}
if(event.data==YT.PlayerState.PAUSED){ytPlayer.status='PAUSED';}
if(event.data==YT.PlayerState.ENDED){ytPlayer.status='ENDED';}
if(event.data==YT.PlayerState.BUFFERING){ytPlayer.status='BUFFERING';}}
function ytPlayerFullScreenChangeEventHandler(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(fullscreenElement){ytPlayer.isFullscreen=true;}else{setTimeout(function(){ytPlayer.isFullscreen=false;},2000);}}
var ytPlayerCode=function(ytVideoId){if(playerContElem){if(scope.changeUrl){ytVideoId='';}else{ytVideoId=scope.ytVideoId||attrs.oneTimeBindYtVideoId;}
ytPlayer=new YT.Player(playerContElem,{width:playerContElem.clientWidth,videoId:ytVideoId,events:{'onReady':onPlayerReady,'onStateChange':onStateChange},playerVars:{rel:0}});ytPlayer.closeFlyout=scope.closeFlyout;$rootScope.activeYtPlayers.push(ytPlayer);ytPlayer.isFullscreen=false;if('onwebkitfullscreenchange'in document.createElement('div')){document.addEventListener("webkitfullscreenchange",ytPlayerFullScreenChangeEventHandler);}else if('onmozfullscreenchange'in document.createElement('div')){document.addEventListener("mozfullscreenchange",ytPlayerFullScreenChangeEventHandler);}else if('onfullscreenchange'in document.createElement('div')){document.addEventListener("fullscreenchange",ytPlayerFullScreenChangeEventHandler);}else{document.addEventListener("MSFullscreenChange",ytPlayerFullScreenChangeEventHandler);}}};var ytChangeVideo=function(ytVideoId){if(playerContElem){if(!ytPlayer){return;}
ytPlayer.loadVideoById(scope.ytVideoId,0,"default");}};var startWatchYtVideoId=function(){var watchForVideoID=scope.$watch('ytVideoId',function(newValue,oldValue){if(typeof newValue==="undefined"||(newValue==oldValue)){return;}
scope.ytVideoId=newValue;});}
if(scope.changeUrl){youtubePlayerInit(ytPlayerCode);startWatchYtVideoId();}else{youtubePlayerInit(ytPlayerCode);}
scope.closeFlyout=function(){if(!flyingout){return;}
flyingout=false;destroyScenes();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:'',width:''});video.removeClass('flyout-prepare');element.find('#flyoutButtonsDiv').hide();ytPlayer.pauseVideo();}
function destroyScenes(){if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}}
function createScenes(element){if($rootScope.deviceType!='DESKTOP'||(typeof $rootScope.device!=undefined&&$rootScope.device!='DESKTOP')){return;}
if(scrollDownScene&&scrollUpScene){scrollDownScene.remove();scrollDownScene=scrollDownScene.destroy();scrollUpScene.remove();scrollUpScene=scrollUpScene.destroy(true);}
scrollDownScene=new ScrollMagic.Scene({triggerElement:element[0],offset:-100,triggerHook:0,}).on('enter',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}else if(ytPlayer.status=='ENDED'||ytPlayer.status=='PAUSED'){return;}
scrollDownEnter(element);flyingout=true;}).on('leave',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}
scrollDownLeave(element);flyingout=false;});scrollUpScene=new ScrollMagic.Scene({triggerElement:element[0],offset:0,duration:0,triggerHook:1,}).on('enter',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||!flyingout||fullscreenElement){return;}
scrollUpEnter(element);scrollUpScene.offset(0);flyingout=false;}).on('leave',function(){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(ytPlayer.isFullscreen||fullscreenElement){return;}else if(ytPlayer.status=='ENDED'||ytPlayer.status=='PAUSED'){return;}
scrollUpLeave(element);scrollUpScene.offset(element.height()+100);flyingout=true;})
controller.addScene(scrollUpScene);controller.addScene(scrollDownScene);}
function scrollDownEnter(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'100px',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0,"onComplete":function(){video.css({top:''});}});}
function scrollDownLeave(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video'),offset=element[0].getBoundingClientRect();if(offset.bottom<0){offset={bottom:$(window).height(),left:offset.left,right:offset.right,top:offset.top};}
video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}
function scrollUpLeave(element){element.find('#flyoutButtonsDiv').show();var video=$(element).find('.inline-video');video.css({left:'',top:'',bottom:'',right:'',height:'',position:''});video.css({bottom:-190,left:$(window).width()-340,width:340,height:190,top:''});video.addClass('flyout-prepare');TweenLite.to(video,0.2,{bottom:0});}
function scrollUpEnter(element){element.find('#flyoutButtonsDiv').hide();var video=$(element).find('.inline-video');video.css({position:'absolute',left:0});video.removeClass('flyout-prepare');video.css({left:'',top:'',bottom:'',position:'',width:'',height:''});}}
return{restrict:'E',scope:{ytVideoId:'=ytVideoId',imageSrc:'=imageSrc',autoPlay:'=autoPlay',changeUrl:'=changeUrl',videoComplete:'&videoComplete',videoPause:'&videoPause',videoPlay:'&videoPlay',flyout:'=flyout',postLoad:'=postload',contentUrl:'=contentUrl',modalContId:'@modalContId',oneTimeBindYtVideoId:'@oneTimeBindYtVideoId'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaYoutubeVideo.html"}}]);'use strict';snaApp.directive("snaFullScreenImageViewer",['$rootScope','$interval','$timeout','$http','appConfig','$log','$location','$compile',function($rootScope,$interval,$timeout,$http,appConfig,$log,$location,$compile){var listenForBrowserHistoryChange;var unBindLocationChangeEvent;var options;function link(scope,element){var pswpElem=element.find(".pswp")[0];var defaultOptions={"closeOnScroll":false,"history":false,"galleryUID":1,"zoomEl":false,"shareEl":true,"preload":[2,1],"errorMsg":'<div class="pswp__error-msg">    <a href="%url%" target="_blank"></a> </div>',"timeToIdle":10000000,"clickToCloseNonZoomable":false,"shareButtons":[{id:'share',shareUrl:'{{shareUrl}}',shareHeadline:'{{shareHeadline}}',shortUrl:'{{shortUrl}}',shareSummary:'{{shareSummary}}',shareMainMediaUrl:'{{shareMainMediaUrl}}'},],"parseShareButtonOut":function(shareButtonData,shareButtonOut,shareObj){var snaShareEl;var newScope;newScope=$rootScope.$new();newScope.shareUrl=shareObj.shareUrl;newScope.shareHeadline=shareObj.shareHeadline;newScope.shortUrl=shareObj.shortUrl;newScope.shareSummary=shareObj.shareSummary;newScope.shareMainMediaUrl=shareObj.shareMainMediaUrl;newScope.hidePrint=true;snaShareEl=angular.element("<div class='pswp__share-tooltip--open-close-btn'><button class='pswp__button pswp__button--share ' title='open/close share'></button></div><sna-share share-url='shareUrl' share-headline='shareHeadline' short-url='shortUrl' share-summary='shareSummary' hide-print='hidePrint' share-main-media-url='{{shareMainMediaUrl}}'></sna-share>");$compile(snaShareEl)(newScope);return snaShareEl;}}
scope.imageData=JSON.parse(scope.imageData);scope.imageData=getImageDataForRTLSwipe(scope.imageData);scope.options=JSON.parse(scope.options);scope.options=$.extend({},defaultOptions,scope.options);scope.options.index=getCorrectIndexForRTL(scope.options.index,scope.imageData.length);options=scope.options;$rootScope.scrollPosBeforeFullScreenImageOpen=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;var gallery=new PhotoSwipe(pswpElem,PhotoSwipeUI_Default,scope.imageData,options);gallery.init();if($rootScope.device=="DESKTOP"){$("body").css("overflow-y","hidden");}
addOpenFullScreenViewerToHistory(scope,gallery);var indexIndicatorDOMElement=document.querySelectorAll('.pswp__counter')[0];gallery.ui.updateIndexIndicator=function(){var counterToShow;var counterInScreen=gallery.getCurrentIndex()+1;var totalItems=gallery.options.getNumItemsFn()
if(counterInScreen==1){counterToShow=counterInScreen;}else{counterToShow=(counterInScreen+((-1*(totalItems-1))+((totalItems-counterInScreen)*2)))+1;}
indexIndicatorDOMElement.innerHTML=(counterToShow)
+gallery.options.indexIndicatorSep
+gallery.options.getNumItemsFn();};gallery.ui.updateIndexIndicator();gallery.listen('close',function(){if($rootScope.device=="DESKTOP"){$("body").css("overflow-y","");}
var index;var totalItems=gallery.options.getNumItemsFn();index=gallery.getCurrentIndex();if(index==0){index=index;}else{index=(totalItems-index);}
if(typeof scope.onCloseCallback!="undefined"&&!!scope.onCloseCallback){$rootScope[scope.onCloseCallback](scope.onCloseCallback,index,JSON.parse(scope.options).galleryUID);}
var updateScrollafterPopstate=function(e){window.scrollTo(0,$rootScope.scrollPosBeforeFullScreenImageOpen);};window.addEventListener('scroll',updateScrollafterPopstate,'',true);if(isBrowserListeningHistory()){window.history.go(-1);stoplistenForBrowserUrlHistoryChange();}
setTimeout(function(){element.remove();},50);setTimeout(function(){window.removeEventListener('scroll',updateScrollafterPopstate);},500);});gallery.listen('afterChange',function(){if(typeof scope.onChangeCallback!="undefined"&&!!scope.onChangeCallback){$rootScope[scope.onChangeCallback](scope.onChangeCallback,JSON.parse(scope.options).galleryUID,gallery.currItem.id,gallery.currItem.shareHeadline);}});}
function getImageDataForRTLSwipe(imageData){if(imageData.length>1){var firstElTempArr;var tempArr;firstElTempArr=imageData.slice(0,1);tempArr=imageData.slice(1,imageData.length);tempArr=tempArr.reverse();imageData=firstElTempArr.concat(tempArr);}
return imageData;}
function getCorrectIndexForRTL(index,totalItems){if(index>0){index=totalItems-index;}
return index;}
function isHistoryEnabled(){if(Modernizr.history){return true;}
return false;}
function addOpenFullScreenViewerToHistory(scope,gallery){if(isHistoryEnabled()){scope.$applyAsync(function(){var path=$location.path();$location.path(path);$location.hash("fullScreenImageViewer"+options.galleryUID);$location.state({"fullScreenImageViewerOpen":true});setTimeout(function(){bindHistoryPopState(scope,gallery);},100)});}}
function bindHistoryPopState(scope,gallery){if(!isHistoryEnabled()){return;}
unBindLocationChangeEvent&&unBindLocationChangeEvent();startlistenForBrowserUrlHistoryChange();unBindLocationChangeEvent=scope.$on('$locationChangeSuccess',function(event,newUrl,oldUrl,newState,oldState){if(isBrowserListeningHistory()){historyPopState(oldState,gallery);}});}
function startlistenForBrowserUrlHistoryChange(){listenForBrowserHistoryChange=true;}
function stoplistenForBrowserUrlHistoryChange(){listenForBrowserHistoryChange=false;}
function isBrowserListeningHistory(){return listenForBrowserHistoryChange;}
function historyPopState(oldState,gallery){if(oldState.fullScreenImageViewerOpen){stoplistenForBrowserUrlHistoryChange();gallery.close();}}
return{restrict:'E',transclude:true,scope:{imageData:'@',galleryId:'@',options:'@',onCloseCallback:'@',onChangeCallback:'@'},link:link,templateUrl:$rootScope.templateBaseUrl+"/html/template/snaFullScreenImageViewer.html"}}]);